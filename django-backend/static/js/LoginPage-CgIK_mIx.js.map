{"version":3,"file":"LoginPage-CgIK_mIx.js","sources":["../../../src/features/auth/hooks/useLogin.ts","../../../src/features/auth/schemas/login.schema.ts","../../../src/features/auth/components/LoginForm.tsx","../../../src/features/auth/pages/login/LoginPage.tsx"],"sourcesContent":["import { useMutation } from \"@tanstack/react-query\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { authApi } from \"../api/authApi\";\r\nimport { setCredentials } from \"../store/authSlice\";\r\nimport { DEFAULT_ROUTES } from \"../../../core/constant/routes\";\r\nimport { toast } from \"sonner\";\r\nimport { LoginResponse } from \"../types/auth.types\";\r\nimport type { LoginCredentials } from \"../api/authApi\"; \r\n\r\n\r\nexport const useLogin = () => {\r\n  const dispatch = useDispatch();\r\n  const navigate = useNavigate();\r\n\r\n  const { mutate, isPending, error } = useMutation<\r\n    LoginResponse,\r\n    Error,\r\n    LoginCredentials\r\n  >({\r\n    mutationFn: authApi.loginUser,\r\n    onSuccess: (data) => {\r\n      // Store user info in Redux\r\n      dispatch(setCredentials({ \r\n        \r\n        role_name : data.role_name,\r\n        user_id : data.user_id,\r\n        first_name : data.first_name,\r\n        last_name: data.last_name,\r\n        email : data.email,\r\n        user_created_date : data.user_created_date,\r\n        access_token : data.access_token,\r\n        refresh_token : data.refresh_token,\r\n        secret_key_verified:data.secret_key_verified,\r\n        \r\n      }));\r\n\r\n      // Redirect user to correct route based on role\r\n      const responseData = data.message;\r\n      if (responseData ==\"Login successful\") {\r\n        if(data.role_name ==\"Admin\"){\r\n           navigate(\"/login\");\r\n          toast.error(\"Invalid user role\");\r\n          // toast.success(\"Login successful\");\r\n          // navigate(\"/admin-dashboard/users/viewall\");\r\n        }\r\n        // else {\r\n        //   navigate(\"/login\");\r\n        //   toast.error(\"Invalid user role\");\r\n        // }\r\n        else if(data.role_name ==\"User\"){\r\n          toast.success(\"Login successful\");\r\n          if(data.secret_key_verified){\r\n            navigate(\"/client/workspaces\")\r\n          }else{\r\n            navigate('/client/secret-key');\r\n          }\r\n        }\r\n          // navigate(\"/admin-dashboard/users/viewall\");\r\n        // }else {\r\n        //   navigate(\"/login\");\r\n        //   toast.error(\"Invalid user role\");\r\n        // }\r\n        // else{\r\n        //   navigate('/secret-key');\r\n        // }\r\n      } else {\r\n        toast.error(\"Invalid user role\");\r\n      }\r\n    },\r\n    onError: (error: Error) => {\r\n      console.log(error)\r\n      if(error.response?.data?.message =='Invalid email or password'){\r\n        toast.error(error.response?.data?.message || 'Invalid email or password');\r\n      }else{\r\n        // toast.error(error.message || \"Login failed\");\r\n        toast.error(error.response?.data?.message || \"Login failed\");\r\n\r\n      }\r\n    },\r\n  });\r\n\r\n  return { mutate, isLoading: isPending, error };\r\n};\r\n","\nimport * as z from \"zod\"\n\nexport const loginSchema = z.object({\n  // email: z.string().email(\"Please enter a valid email address\"),\n  email: z\n  .string()\n  .min(1, \"Email is required\")\n  .email(\"Please enter a valid email\"),\n  password: z.string().min(1, \"Password is required\"),\n})\n\nexport type LoginSchema = z.infer<typeof loginSchema>","import React from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { zodResolver } from \"@hookform/resolvers/zod\";\r\nimport { Eye, EyeOff, Loader2 } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n  Form,\r\n  FormControl,\r\n  FormField,\r\n  FormItem,\r\n  FormLabel,\r\n  FormMessage,\r\n} from \"@/components/ui/form\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { useLogin } from \"../hooks/useLogin\";\r\nimport { loginSchema, LoginSchema } from \"../schemas/login.schema\";\r\nimport { Link } from \"react-router\";\r\n\r\n\r\nconst LoginForm = () => {\r\n  const [showPassword, setShowPassword] = React.useState(false);\r\n  const { mutate, isLoading } = useLogin();\r\n\r\n  const form = useForm<LoginSchema>({\r\n    resolver: zodResolver(loginSchema),\r\n    defaultValues: {\r\n      email: \"\",\r\n      password: \"\",\r\n    },\r\n  });\r\n\r\n  const handleLogin = (values: LoginSchema) => {\r\n    mutate(values);\r\n  };\r\n\r\n\r\n\r\n  return (\r\n    <Form {...form}>\r\n      <div className=\"mb-4\">\r\n        <div className=\"text-2xl font-secondary font-bold text-[#062393]\">Welcome Back!</div>\r\n        <div className=\"text-sm font-secondary  font-normal \">Let's get started</div>\r\n\r\n      </div>\r\n      <form onSubmit={form.handleSubmit(handleLogin)} className=\"space-y-6\">\r\n        <FormField\r\n          control={form.control}\r\n          name=\"email\"\r\n          render={({ field }) => (\r\n            <FormItem>\r\n              {/* <FormLabel>Email</FormLabel> */}\r\n              <FormControl>\r\n                <Input\r\n                  {...field}\r\n                  type=\"email\"\r\n                  placeholder=\"Email Address*\"\r\n                  autoComplete=\"off\"\r\n                  hasError={!!form.formState.errors.email}\r\n                  className=\"rounded-full\"\r\n                />\r\n              </FormControl>\r\n              <FormMessage />\r\n            </FormItem>\r\n          )}\r\n        />\r\n\r\n        <FormField\r\n          control={form.control}\r\n          name=\"password\"\r\n          render={({ field }) => (\r\n            <FormItem>\r\n              {/* <FormLabel>Password</FormLabel> */}\r\n              <FormControl>\r\n                <div className=\"relative\">\r\n                  <Input\r\n                    {...field}\r\n                    type={showPassword ? \"text\" : \"password\"}\r\n                    placeholder=\"Password*\"\r\n                    autoComplete=\"off\"\r\n                    hasError={!!form.formState.errors.password}\r\n\r\n                    className=\"rounded-full\"\r\n                  />\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"absolute inset-y-0 right-0 pr-3 flex items-center hover:text-accent-foreground\"\r\n                    onClick={() => setShowPassword(!showPassword)}\r\n                  >\r\n                    {showPassword ? (\r\n                      <Eye className=\"h-5 w-5 text-muted-foreground\" />\r\n                    ) : (\r\n                      <EyeOff className=\"h-5 w-5 text-muted-foreground\" />\r\n                    )}\r\n                  </button>\r\n                </div>\r\n              </FormControl>\r\n              <FormMessage />\r\n            </FormItem>\r\n          )}\r\n        />\r\n\r\n\r\n        <Button type=\"submit\" disabled={isLoading} className=\"w-full font-secondary rounded-full bg-[#43996A]\">\r\n          {isLoading ? (\r\n            <>\r\n              <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n              Please wait\r\n            </>\r\n          ) : (\r\n            \"Login\"\r\n          )}\r\n        </Button>\r\n\r\n        <div className=\"text-center \">\r\n          <Link\r\n            to=\"/send-password-reset-link\"\r\n            className=\"text-sm font-normal font-secondary text-[#062393] hover:text-primary transition-colors\"\r\n          >\r\n            Forgot Password\r\n          </Link>\r\n          {/* <br />\r\n          <Link\r\n            to=\"/sign-up\"\r\n            className=\"text-sm font-normal font-secondary text-[#062393] hover:text-primary transition-colors\"\r\n          >\r\n            Don't have an Account ? Create One\r\n          </Link> */}\r\n        </div>\r\n      </form>\r\n    </Form>\r\n  );\r\n};\r\n\r\nexport default LoginForm;\r\n","import AuthLayout from \"../../components/AuthLayout\";\nimport LoginForm from \"../../components/LoginForm\";\n\nconst LoginPage = () => {\n  return (\n    <AuthLayout title=\"Login\">\n      <LoginForm />\n    </AuthLayout>\n  );\n};\n\nexport default LoginPage;\n"],"names":["useLogin","dispatch","useDispatch","navigate","useNavigate","mutate","isPending","error","useMutation","authApi","data","setCredentials","toast","loginSchema","z.object","z.string","LoginForm","showPassword","setShowPassword","React","isLoading","form","useForm","zodResolver","handleLogin","values","jsxs","Form","jsx","FormField","field","FormItem","FormControl","Input","FormMessage","Eye","EyeOff","Button","Fragment","Loader2","Link","LoginPage","AuthLayout"],"mappings":"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"}
{"version":3,"file":"AssignCreationTable-CzwSbO5a.js","sources":["../../../src/features/client/pages/assign/assign-table/assign-creation-table-col.tsx","../../../src/features/client/hooks/useGetApi.ts","../../../src/features/client/pages/assign/assign-table/AssignCreationTable.tsx"],"sourcesContent":["import {\n  determinePurposeType,\n  determineTransactionType,\n} from \"@/utils/getTransactionConfigTypes\";\nexport const getAssignCreationColumns = (\n  handleSelectionChange: (rowId: string, checked: boolean) => void\n) => [\n  {\n    key: \"select\",\n    id: \"select\",\n    name: \"Select\",\n    className: \"min-w-0 p-2\",\n    cell: (value: any, row: any) => (\n      <input\n        type=\"checkbox\"\n        checked={value}\n        onChange={(e) =>\n          handleSelectionChange(row.partner_order_id, e.target.checked)\n        }\n        className={`h-5 w-5 cursor-pointer rounded-sm border-2 transition-all duration-300`}\n        style={{\n          accentColor: \"#E53888\", // Consistent color instead of conditional\n          display: \"inline-block\",\n          verticalAlign: \"middle\",\n          position: \"relative\",\n        }}\n      />\n    ),\n  },\n  {\n    key: \"nium_order_id\",\n    id: \"nium_order_id\",\n    name: \"Nium ID\",\n  },\n  {\n    key: \"partner_order_id\",\n    id: \"partner_order_id\",\n    name: \"Partner ID\",\n  },\n  {\n    key: \"createdAt\",\n    id: \"createdAt\",\n    name: \"Order Date\",\n  },\n  {\n    key: \"customer_pan\",\n    id: \"customer_pan\",\n    name: \"Customer PAN\",\n  },\n  {\n    key: \"transaction_type\",\n    id: \"transaction_type\",\n    name: \"Transaction Type\",\n    cell: (_: unknown, rowData: any) => (\n      <span>{rowData.transaction_type.text}</span>\n    ),\n  },\n  {\n    key: \"purpose_type\",\n    id: \"purpose_type\",\n    name: \"Purpose Type\",\n    cell: (_: unknown, rowData: any) => (\n      <span>{rowData.purpose_type.text}</span>\n    ),\n  },\n];\n","import { useState, useEffect, useCallback } from \"react\";\nimport axiosInstance from \"@/core/services/axios/axiosInstance\";\nimport { getEndpoint } from \"@/core/constant/apis\";\nimport { toast } from \"sonner\";\nimport axios from \"axios\";\n\ninterface FetchState<T> {\n  data: T | null;\n  loading: boolean;\n  error: string | null;\n  fetchData: (params?: Record<string, any>) => Promise<void>;\n}\n\nexport const useGetApi = <T>(\n  endpointKey: string,\n  params?: Record<string, any>,\n  autoFetch: boolean = true\n): FetchState<T> => {\n  const [data, setData] = useState<T | null>(null);\n  const [loading, setLoading] = useState<boolean>(autoFetch);\n  const [error, setError] = useState<string | null>(null);\n\n  // Function to fetch data\n  const fetchData = useCallback(async (queryParams?: Record<string, any>) => {\n    setLoading(true);\n    setError(null);\n    try {\n      const url = getEndpoint(endpointKey);\n      const { data } = await axiosInstance.get<T>(url, { \n        params: queryParams || params \n      });\n      setData(data);\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : \"An unknown error occurred\";\n      toast.error(\"Error Fetching Data\", {\n        description: errorMessage,\n      });\n      setError(errorMessage);\n    } finally {\n      setLoading(false);\n    }\n  }, [endpointKey, params]);\n\n  // Auto-fetch on mount if enabled\n  useEffect(() => {\n    if (autoFetch) {\n      fetchData();\n    }\n  }, [fetchData, autoFetch]);\n\n  return { data, loading, error, fetchData };\n};","import { DynamicTable } from \"@/components/common/dynamic-table/DynamicTable\";\nimport { getAssignCreationColumns } from \"./assign-creation-table-col\";\nimport { useState, useEffect } from \"react\";\nimport { useFilterApi } from \"@/components/common/dynamic-table/hooks/useFilterApi\";\nimport { useDynamicPagination } from \"@/components/common/dynamic-table/hooks/useDynamicPagination\";\nimport { Button } from \"@/components/ui/button\";\nimport { toast } from \"sonner\";\nimport { API } from \"@/core/constant/apis\";\nimport { usePageTitle } from \"@/hooks/usePageTitle\";\nimport { useGetApi } from \"@/features/client/hooks/useGetApi\";\nimport axiosInstance from \"@/core/services/axios/axiosInstance\";\nimport { useCurrentUser } from \"@/utils/getUserFromRedux\";\n\nconst AssignCreationTable = () => {\n  const { setTitle } = usePageTitle();\n  const { getUserHashedKey } = useCurrentUser();\n  const currentUserHashedKey = getUserHashedKey();\n\n  useEffect(() => {\n    setTitle(\"Assign\");\n  }, [setTitle]);\n  const {\n    data: assignList,\n    loading,\n    error,\n    fetchData,\n  } = useGetApi<any>(\"CHECKER.ASSIGN.LIST\");\n  const [selectedRows, setSelectedRows] = useState<string[]>([]);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const isTableFilterDynamic = false;\n  const isPaginationDynamic = false;\n\n  // Use the dynamic pagination hook\n  const pagination = useDynamicPagination({\n    endpoint: API.CHECKER.ASSIGN.LIST,\n    initialPageSize: 10,\n    dataPath: \"transactions\",\n    totalRecordsPath: \"totalRecords\",\n  });\n\n  // Using the filter API hook\n  const filterApi = useFilterApi({\n    endpoint: API.CHECKER.ASSIGN.LIST,\n    baseQueryParams: {},\n  });\n\n  const handleSelectionChange = (rowId: string, checked: boolean) => {\n    // Update the selected rows array\n    setSelectedRows((prev) => {\n      if (checked) {\n        return [...prev, rowId];\n      } else {\n        return prev.filter((id) => id !== rowId);\n      }\n    });\n  };\n\n  const handleTakeRequest = async () => {\n    if (selectedRows.length === 0) {\n      toast.error(\"Please select at least one transaction\");\n      return;\n    }\n\n    setIsSubmitting(true);\n    try {\n      const response = await axiosInstance.post(\n        API.CHECKER.ASSIGN.TAKE_REQUEST,\n        {\n          orderIds: selectedRows,\n          clientId: currentUserHashedKey,\n        }\n      );\n\n      // Handle successful response\n      if (response) {\n        toast.success(\n          `Successfully assigned ${selectedRows.length} transaction(s)`\n        );\n        fetchData();\n      }\n\n      setSelectedRows([]);\n    } catch (error) {\n      toast.error(\"Failed to take request. Please try again.\");\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const columns = getAssignCreationColumns(handleSelectionChange);\n\n  //Load initial data when the component mounts\n  useEffect(() => {\n    if (isPaginationDynamic) {\n      pagination.loadInitialData();\n    }\n  }, [fetchData, isPaginationDynamic, pagination]);\n\n  return (\n    <div className=\"flex flex-col\">\n      {/* <div className=\"mb-4 flex items-center\">\n        {(filterApi.loading || pagination.loading || loading) && (\n          <span className=\"text-blue-500\">Loading data...</span>\n        )}\n        {(filterApi.error || pagination.error || error) && (\n          <span className=\"text-red-500\">Error loading data</span>\n        )}\n      </div> */}\n\n      <DynamicTable\n        columns={columns}\n        data={\n          isPaginationDynamic\n            ? pagination.data ?? []\n            : isTableFilterDynamic\n            ? filterApi.data ?? []\n            : assignList ?? []\n        }\n        defaultSortColumn=\"nium_order_id\"\n        defaultSortDirection=\"asc\"\n        loading={\n          filterApi.loading || pagination.loading || isSubmitting || loading\n        }\n        paginationMode={isPaginationDynamic ? \"dynamic\" : \"static\"}\n        onPageChange={\n          isPaginationDynamic\n            ? pagination.handlePageChange\n            : async (_page: number, _pageSize: number) => []\n        }\n        totalRecords={pagination.totalRecords}\n        filter={{\n          filterOption: true,\n          mode: isTableFilterDynamic ? \"dynamic\" : \"static\",\n          rederFilerOptions: {\n            search: true,\n          },\n          // Dynamic callbacks - API functions\n          dynamicCallbacks: isTableFilterDynamic\n            ? {\n                onSearch: filterApi.search,\n              }\n            : undefined,\n        }}\n      />\n\n      <div className=\"w-full  flex flex-col items-center justify-start gap-3\">\n        <div className=\"text-sm text-gray-500\">\n          {selectedRows.length} transaction\n          {selectedRows.length !== 1 ? \"s\" : \"\"} selected\n        </div>\n        <Button\n          onClick={handleTakeRequest}\n          disabled={selectedRows.length === 0 || isSubmitting}\n          className=\"border\"\n        >\n          {isSubmitting\n            ? \"Processing...\"\n            : `Take Request${selectedRows.length !== 1 ? \"s\" : \"\"}`}\n        </Button>\n      </div>\n    </div>\n  );\n};\n\nexport default AssignCreationTable;\n"],"names":["getAssignCreationColumns","handleSelectionChange","value","row","jsx","e","_","rowData","useGetApi","endpointKey","params","autoFetch","data","setData","useState","loading","setLoading","error","setError","fetchData","useCallback","queryParams","url","getEndpoint","axiosInstance","err","errorMessage","toast","useEffect","AssignCreationTable","setTitle","usePageTitle","getUserHashedKey","useCurrentUser","currentUserHashedKey","assignList","selectedRows","setSelectedRows","isSubmitting","setIsSubmitting","isPaginationDynamic","pagination","useDynamicPagination","API","filterApi","useFilterApi","rowId","checked","prev","id","handleTakeRequest","columns","jsxs","DynamicTable","_page","_pageSize","Button"],"mappings":"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"}
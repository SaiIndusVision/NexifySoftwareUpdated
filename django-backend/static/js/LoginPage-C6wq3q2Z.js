import{j as e}from"./mui-BFA6lQrI.js";import{A as w}from"./AuthLayout-itFYPbID.js";import{f as y,b as v,L}from"./react-core-CQlor4TK.js";import{b as N,s as p,d as b}from"./form-tools-D5DSvKKH.js";import{a as k,u as t,s as F,F as E,b as x,c as h,d as g,I as j,e as _,B as P,L as S,t as C}from"./index-DRlwla87.js";import{u as I}from"./data-utils-7BzZlo9U.js";import{i as A}from"./state-management-hQ1z8sur.js";import{a as B,E as D}from"./eye-DF-FSPIn.js";import"./ui-utils-DmSiVVjI.js";import"./radix-DpbSIyq2.js";const q=()=>{const r=A(),n=y(),{mutate:l,isPending:i,error:o}=I({mutationFn:k.loginUser,onSuccess:s=>{r(F({role_name:s.role_name,user_id:s.user_id,first_name:s.first_name,last_name:s.last_name,email:s.email,user_created_date:s.user_created_date,access_token:s.access_token,refresh_token:s.refresh_token,secret_key_verified:s.secret_key_verified})),s.message=="Login successful"?s.role_name=="Admin"?t.error("Invalid Credentials"):(t.success("Login successful"),s.secret_key_verified?n("/client/workspaces"):n("/client/secret-key")):t.error("Invalid user role")},onError:s=>{var a,m,c,d,u,f;console.log(s),((m=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:m.message)=="Invalid email or password"?t.error(((d=(c=s.response)==null?void 0:c.data)==null?void 0:d.message)||"Invalid email or password"):t.error(((f=(u=s==null?void 0:s.response)==null?void 0:u.data)==null?void 0:f.message)||"Login failed")}});return{mutate:l,isLoading:i,error:o}},M=N({email:p().min(1,"Email is required").email("Please enter a valid email"),password:p().min(1,"Password is required")}),R=()=>{const[r,n]=v.useState(!1),{mutate:l,isLoading:i}=q(),o=b({resolver:C(M),defaultValues:{email:"",password:""}}),s=a=>{l(a)};return e.jsxs(E,{...o,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-2xl font-secondary font-bold text-[#062393]",children:"Welcome Back!"}),e.jsx("div",{className:"text-sm font-secondary  font-normal ",children:"Let's get started"})]}),e.jsxs("form",{onSubmit:o.handleSubmit(s),className:"space-y-6",children:[e.jsx(x,{control:o.control,name:"email",render:({field:a})=>e.jsxs(h,{children:[e.jsx(g,{children:e.jsx(j,{...a,type:"email",placeholder:"Email Address*",autoComplete:"off",hasError:!!o.formState.errors.email,className:"rounded-full"})}),e.jsx(_,{})]})}),e.jsx(x,{control:o.control,name:"password",render:({field:a})=>e.jsxs(h,{children:[e.jsx(g,{children:e.jsxs("div",{className:"relative",children:[e.jsx(j,{...a,type:r?"text":"password",placeholder:"Password*",autoComplete:"off",hasError:!!o.formState.errors.password,className:"rounded-full"}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center hover:text-accent-foreground",onClick:()=>n(!r),children:r?e.jsx(B,{className:"h-5 w-5 text-muted-foreground"}):e.jsx(D,{className:"h-5 w-5 text-muted-foreground"})})]})}),e.jsx(_,{})]})}),e.jsx(P,{type:"submit",disabled:i,className:"w-full font-secondary rounded-full bg-[#43996A]",children:i?e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"mr-2 h-4 w-4 animate-spin"}),"Please wait"]}):"Login"}),e.jsx("div",{className:"text-center ",children:e.jsx(L,{to:"/send-password-reset-link",className:"text-sm font-normal font-secondary text-[#062393] hover:text-primary transition-colors",children:"Forgot Password"})})]})]})},Q=()=>e.jsx(w,{title:"Login",children:e.jsx(R,{})});export{Q as default};

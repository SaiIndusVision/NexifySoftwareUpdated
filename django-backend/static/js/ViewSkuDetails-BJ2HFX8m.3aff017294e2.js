import{e as de,j as e}from"./mui-BFA6lQrI.js";import{r as t,f as me,h as ge,i as ne}from"./react-core-CQlor4TK.js";import{p as re}from"./nexify-placeholder-img-DvrgdLBk.js";import{u as he,D as pe}from"./useDynamicPagination-BQkOOE1b.js";import{u as fe}from"./useFilterApi-CeY-s8Rk.js";import{n as ae,j as be,o as je,A as ie,t as Ae,F as ye,b as Ne,c as we,d as ve,I as Se,e as ke,B as Ce,L as Ie,u as y,l as oe}from"./index-DRlwla87.js";import{a as E,u as Ve}from"./data-utils-7BzZlo9U.js";import{b as Ee,n as Be,s as _e,d as Fe}from"./form-tools-D5DSvKKH.js";import"./state-management-hQ1z8sur.js";import"./ui-utils-DmSiVVjI.js";import"./radix-DpbSIyq2.js";const Re="data:image/png;base64,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",Me="data:image/png;base64,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",se=de(e.jsx("path",{d:"M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5z"}),"NorthEast"),Ue=de(e.jsx("path",{d:"M15 19v-2H8.41L20 5.41 18.59 4 7 15.59V9H5v10z"}),"SouthWest"),De="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAAfCAYAAAAfrhY5AAAACXBIWXMAABCcAAAQnAEmzTo0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAIcSURBVHgB7VfbUQIxFD0RR/1cKxA7sAT9xXGQCoQK0AqECqQDoAJGGdA/sALoADqAXx0FzyVZiWEXAssMfnBmstnc7Obc195kgR1C+TzUAIIjIP0JjHPAUGSvHE+BKm8v2SoZ4AFrYiW5IenwNm1eKLGrW7IxW8Bx7RooYA0cwJNYFmc/ZF9i6xlZ+QM4Z9+nUvmWViw5uUNcFqu+55YFRlaScKi5V/pICiFuAwO2aWhNlIz9BccjI8tjG+BitaTEMv8GFDnfkWfYntxnVAy5uPtS4nnCG8f9JVlYaZm4v3Ct8wFNvsM43nLuTubcdTMOX1zMn+VyTAJf4heSpijnXBFa4ZrM04BTDrtRJIdRQmpYaelEChdaSixIGUvDZ/HXk/AmN5mejSMOLbFjrXSxEZzZcn4hY64RRMVXxRDHuhoJ4MZ8wfIJtVbxxGLFJmX0EaYWLCVXulwKsszerpqVdk0szY6zL9o6+9OufCHbJdnY1Ul6kbKSC3OlZhCPNKwwyNieb85zIBaRn1pGJ0xd7t2sDhemcj2W1nt73Dbj8LNbVfVia7soIN/oOm6eGk+kPBNz6a6Wc1y9bRxgh9iT78n35P+X/EufUocsqQOzyNgeT/SPhciSn2YF5gA5wgYID5GufB3L39mCcPPwhdndpHXdOa9/NYE54cifyu8xahXM8Wm21fI4dXXjvOdNbilQhcdebaFL4vJNhMI/3ZTVcKQqeWcAAAAASUVORK5CYII=",te="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAATCAYAAAB2pebxAAAACXBIWXMAABCcAAAQnAEmzTo0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACqSURBVHgB7ZTBCcMwDEUt1b13kAQ6QjJCR+kkHakZoRBy7wi9l8i1DwXF6JuE5JBDPthYQnrIQjY5oG/fN5b/XNdd7iOUwMxPCyIirQkZhyG4FfJpCyF0RNT8z3MSzfhUzZKKdDyjoNQn3avc1vIIohpLlj2JdRvogOwZAuckH//Sc4AQX1VtyS5C0GiXpCGvuK7oHwF6TyAx+TaKPOLlL7PSiT4n5ns6/gCMkEutEIPmAwAAAABJRU5ErkJggg==",Ye=({row:m})=>{const[o,C]=t.useState({labelName:m.name||"",shortcutKey:m.shortcut_key||"",colorCode:m.color_code||"#EEE"}),[F,b]=t.useState(!1),k=async()=>{try{const r={name:o.labelName,shortcut_key:o.shortcutKey.toUpperCase(),color_code:o.colorCode,is_active:!0};b(!0),m.id?(await E.put(`http://localhost:8000/api/label/${m.id}/`,r),alert("Label updated successfully!")):(await E.post("http://localhost:8000/api/label/",r),alert("Label added successfully!"))}catch(r){console.error("Error saving label:",r),alert("Failed to save label")}finally{b(!1)}};return e.jsx(ae,{title:m.id?"Update Label":"Add New Label",description:e.jsxs("form",{onSubmit:r=>r.preventDefault(),children:[e.jsx("input",{type:"text",className:"w-full px-2 py-1 border rounded-full mb-2",placeholder:"Label name",value:o.labelName,onChange:r=>C({...o,labelName:r.target.value})}),e.jsx("input",{type:"text",className:"w-full px-2 py-1 border rounded-full mb-2",placeholder:"Shortcut Key (e.g., G)",value:o.shortcutKey,onChange:r=>C({...o,shortcutKey:r.target.value})}),e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium mb-2",children:["Select color:",e.jsx("input",{type:"color",className:"h-8 w-10 rounded-full border",value:o.colorCode,onChange:r=>C({...o,colorCode:r.target.value})})]})]}),onConfirm:k,isLoading:F,children:e.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white hover:bg-blue-700 rounded-full",children:m.id?"Edit":"Add"})})},Oe=({row:m})=>{const[o,C]=t.useState(!1),F=async()=>{C(!0);try{await E.delete(`http://localhost:8000/api/label/${m.id}/`,{headers:{accept:"application/json"}}),alert("Label deleted successfully!")}catch(b){console.error("Error deleting label:",b),alert("Failed to delete label.")}finally{C(!1)}};return e.jsx(ae,{title:"Delete Label",description:`Are you sure you want to delete the label "${m.name}"?`,onConfirm:F,isLoading:o,children:e.jsxs("button",{className:"px-3 py-1 bg-red-600 text-white flex justify-center items-center gap-4 hover:bg-red-700 rounded-full",children:["Delete ",e.jsx("img",{src:te,alt:"Delete",className:"w-4 h-4"})]})})},Le=(m,o,C,F,b)=>[{key:"color_code",id:"color_code",name:"Color",cell:(k,r)=>{const p=r.color_code,f=p.startsWith("#")?p.slice(1):p,M=f.length===3?f.split("").map(z=>z+z).join(""):f,G=parseInt(M.substring(0,2),16),Q=parseInt(M.substring(2,4),16),K=parseInt(M.substring(4,6),16),T=(G*299+Q*587+K*114)/1e3>150?"text-black":"text-white";return e.jsx("button",{className:`px-3 py-1 rounded-full border ${T}`,style:{backgroundColor:p},children:p})}},{key:"name",id:"name",name:"Label Name"},{key:"shortcut_key",id:"shortcut_key",name:"Key assigned"},{key:"view",id:"view",name:"",cell:(k,r)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ye,{row:r}),e.jsx(Oe,{row:r})]})}],ce=[{partner_id:"62940e36-c368-43f8-b978-4111223a1cac",hashed_key:"befb8eadb0fac508d695b7395ec10543m8ctxoh9",role_id:"cdadd7a8-a04a-40ba-a5b3-2b1bf6d788c8",email:"reach2tayib@gmail.com",first_name:"Mohammed",last_name:"Tayib",api_key:"7b4d9b49-1794-4a91-826a-749cf0d8a87a",is_active:!1,business_type:"large_enterprise",created_by:"4b9517bd-692b-459d-b39f-0c6147a67e31",updated_by:null,products:[{id:"80185a93-7242-4680-8922-297d85dfbd2d",name:"Card"}]},{partner_id:"27644155-4cc2-4541-93ea-babd214d7df3",hashed_key:"4f0440dc0a6d253296aff77f4566d9d8m8ctn5re",role_id:"cdadd7a8-a04a-40ba-a5b3-2b1bf6d788c8",email:"sana@gmail.com",first_name:"Sana",last_name:"G",api_key:"eccc2215-82b7-46be-a418-fb2d997224e6",is_active:!0,business_type:"large_enterprise",created_by:null,updated_by:null,products:[]},{partner_id:"274a5724-5e98-49ff-90fe-0a0fd49f6dff",hashed_key:"bbce159e39b5e7ea1096fc42ebfeff03m85s76dn",role_id:"cdadd7a8-a04a-40ba-a5b3-2b1bf6d788c8",email:"contact2tayib@gmail.com",first_name:"Mohammed",last_name:"Tayibulla",api_key:"41dc8bcf-dff0-4152-a11a-49183559bd31",is_active:!0,business_type:"large_enterprise",created_by:null,updated_by:null,products:[]}],Qe=({skuId:m,refreshKey:o})=>{console.log("first");const{setTitle:C}=be();me(),t.useEffect(()=>{C("")},[C]);const[F,b]=t.useState([]),k=t.useMemo(()=>({sku:m}),[]),{data:r=[],fetchData:p}=je("NUSERS.SKU.LABEL_LIST",k);console.log("usersData 28",r),t.useEffect(()=>{p()},[o,p]),t.useEffect(()=>{const H=Z=>{const $=Z.key.toUpperCase(),P=r==null?void 0:r.find(g=>g.shortcut_key.toUpperCase()===$);P&&alert(`Label: ${P.name} (Shortcut: ${P.shortcut_key})`)};return window.addEventListener("keydown",H),()=>{window.removeEventListener("keydown",H)}},[r]);const f=he({endpoint:ie.NUSERS.USER.LIST,initialPageSize:10,initialData:ce,dataPath:"transactions",totalRecordsPath:"totalRecords"});fe({endpoint:ie.NUSERS.USER.LIST,initialData:ce,baseQueryParams:{}});const[M,G]=t.useState({}),[Q,K]=t.useState({}),W=Le(),T=f.loading,z=f.error,X=f.totalRecords||0;return console.log(r),t.useEffect(()=>{r&&Array.isArray(r==null?void 0:r.results)&&b(r==null?void 0:r.results)},[r]),e.jsx("div",{className:"flex flex-col py-4",children:e.jsx(pe,{columns:W,data:r&&r.length>0?r:F,defaultSortColumn:"niumId",defaultSortDirection:"asc",loading:T,refreshAction:{isRefreshButtonVisible:!1,isLoading:T,hasError:z},paginationMode:"static",onPageChange:async(H,Z)=>[],totalRecords:X})})},ee="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG4AAABWCAYAAAAucqM7AAAACXBIWXMAABCcAAAQnAEmzTo0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMESURBVHgB7d0/TxRBHMbx3wx70WiIdIr/cvYaeQEmyhugtzBIbWODFCYKJYoJdpSeDYkVWphYcRQWdBIruwWNWOnSyMHezrizMscenGiBsM/u80kudzu5S0i+zMxuNSp4sP5YWTspGMJYq2GZHgyl4jRQNKdeM3ZRJtbrUnFa8DBeStXGv1p/8f1RvxTVx29GRho/ZWOr8+dWetmEmXHXzml5M3pKzpxQfqjSMw9qqWS8XXB7HOP9hnhzwngCGs6pejzYcE6V40GHc6oaD+Y57m96PedZk4xJybSDIHTPrqUJ5/SIV0rpP+Qw/FKZ12PZLCl9K5CS8fEevmtJmaxGVj5vmM516cI5Pl6ZTC9tpa/tznWplsoqYThQDAeK4UAxHCiGA8VwoBgOFMOBYjhQDAeK4UAxHCiGA8VwoBgOFMOBYjhQDAeK4UAxHCiGA8VwoBgOFMOBYjhQDAeK4UAxHCiGA8VwoBgOFMOBYjhQDAeK4UAxHCiGA8VwoBgOFMOBYjhQDAeK4UAxHCiGA8VwoBgOFMOBYjhQDAeK4UAxHCiGA8VwoBgOFMOB0mIl8hcbrXIfJoQs30YpFWlREvoBdxoUFVO+jbXJB22NWfIDbz/FQsWzFhl5v5p0roMgCNM9zi74gfmVNpfLAspHS7e2Zmt6MNTtZ5eafp9z0eaWt4WKw822/ClWotWL7G3ncsqPzy3H3OsKxEVz8XaE8ZPBhvuQhYtnzs+mb0332c26O68281+mY+LOjJtfyd13KDXpP3ae4/q0GvNLpos28nKz+0d0ZNzkufe61bVEKmOn/GzLrvM/qI1/GRKrF9PRAT92+3otfQVyo17Kwx0Lxd9juO2q6ybR2kY8c+Fu/rv7ToE9ObFeT9w52iL1/PjlAS1Xz+rsGEs6XGuR3XfLv8s8j59evL93tOfxvVm8xEyma+qo0HHJzjHP7vp7OPDc5VzAm7JnBtL/YdPnNKX0wul4sxHNXon+9L1/PjDb7X/GmLqSviGhQ6V03w9jtlf7k6R5UKy8X8WBPRteZdGpAAAAAElFTkSuQmCC",Te=Ee({name:_e().min(1,"Version name is required").max(100,"Maximum 100 characters allowed"),sku:Be().nullable().optional()}),ze=()=>Ve({mutationFn:async m=>(console.log(m),(await E.post("http://localhost:8000/api/versions/",m)).data)}),Je=({sku:m})=>{const o=parseInt(m,10);console.log(m,typeof m),console.log(o,typeof o);const{mutate:C,isLoading:F}=ze(),b=Fe({resolver:Ae(Te),defaultValues:{name:"",sku:o}}),k=r=>{const p={name:r.name,sku:r.sku};console.log("Submitting payload:",JSON.stringify(p,null,2)),C(p,{onSuccess:()=>{y.success("Version created successfully"),b.reset(),window.location.reload()},onError:f=>{var M,G;console.error("Failed to create version:",f),y.error(`${f instanceof Error?(G=(M=f==null?void 0:f.response)==null?void 0:M.data)==null?void 0:G.message:"Unknown error"}`)}})};return e.jsxs(ye,{...b,children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"text-2xl font-secondary font-bold text-[#062393]",children:"Create a New Version"}),e.jsx("div",{className:"text-sm font-secondary  font-normal ",children:"Fill all the fields"})]}),e.jsxs("form",{onSubmit:b.handleSubmit(k),className:"space-y-6",children:[e.jsx(Ne,{control:b.control,name:"name",render:({field:r})=>e.jsxs(we,{children:[e.jsx(ve,{children:e.jsx(Se,{...r,placeholder:"Name of Version*",className:"rounded-full w-full"})}),e.jsx(ke,{})]})}),e.jsx(Ce,{type:"submit",disabled:F,className:"w-full rounded-full",children:F?e.jsxs(e.Fragment,{children:[e.jsx(Ie,{className:"mr-2 h-4 w-4 animate-spin"}),"Please wait"]}):"Create New Version"})]})]})},ue=({done:m})=>{const o=t.useRef(null);return t.useEffect(()=>{o.current&&(o.current.style.width=`${m}%`,o.current.style.opacity="1")},[m]),e.jsx("div",{className:"w-[80%] h-[30px] bg-gray-300 rounded-full relative my-2",children:e.jsx("div",{ref:o,className:"h-full rounded-full bg-gradient-to-l from-[#163323] to-[#43996A] text-white flex items-center justify-center text-sm font-medium transition-all duration-1000 ease-in-out opacity-0 min-w-[50px]","data-done":m,children:m>0?`${m}%`:"0%"})})},Ge=({skuId:m,version:o,skuVersions:C,selectedVersion:F})=>{const[b,k]=t.useState(!1),[r,p]=t.useState(null),[f,M]=t.useState(0),[G,Q]=t.useState(new Set),[K,W]=t.useState([]),[T,z]=t.useState([]),[X,H]=t.useState([]),[Z,$]=t.useState(null),P=async()=>{var s;try{const u=(s=(await E.get(`http://localhost:8000/api/sku-images-list/?sku_id=${m}&version_id=${o}`)).data.results)==null?void 0:s.map(x=>({id:x.id,name:x.original_filename,url:`http://localhost:8000${x.image}`,label_id:x.label_id||null,label_name:x.label_name||null,label_color_code:x.label_color_code||null}));console.log(u),H(u||[])}catch(n){console.error("Failed to fetch images",n),y.error("Failed to fetch images")}};t.useEffect(()=>{P()},[m,o]);const g=({title:s,onClick:n})=>e.jsx("div",{onClick:n,className:"border rounded-lg shadow-sm p-4 hover:bg-blue-50 cursor-pointer",children:e.jsx("h4",{className:"font-semibold text-lg text-gray-800",children:s})}),I=({label:s,min:n,max:u,step:x=1,value:R,onChange:c})=>e.jsxs("div",{className:"my-4",children:[e.jsxs("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:[s,": ",e.jsx("span",{className:"font-bold text-blue-600",children:R})]}),e.jsx("input",{type:"range",min:n,max:u,step:x,value:R,onChange:h=>c(Number(h.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),a=({isOpen:s,onClose:n,title:u,file:x,parameters:R,onUpdate:c})=>{const[h,_]=t.useState({}),[l,D]=t.useState(null),Y={horizontal_flip:{params:["probability"]},vertical_flip:{params:["probability"]},grayscale:{params:["probability"]},rotate:{params:["angle","probability"],configBuilder:i=>({min_angle:-i.angle,max_angle:i.angle,probability:i.probability})},noise:{params:["noise","probability"],configBuilder:i=>({min_noise:i.noise,max_noise:i.noise,probability:i.probability})},blur:{params:["blur","probability"],configBuilder:i=>({min_blur:i.blur,max_blur:i.blur,probability:i.probability})},brightness:{params:["brightness","probability"],configBuilder:i=>({min_brightness:-i.brightness,max_brightness:i.brightness,probability:i.probability})},hue_saturation_value:{params:["hue","saturation","probability"],configBuilder:i=>({min_hue:-i.hue,max_hue:i.hue,min_saturation:-i.saturation,max_saturation:i.saturation,probability:i.probability})},shear:{params:["x_angle","y_angle","probability"],configBuilder:i=>({x_min_angle:-i.x_angle,x_max_angle:i.x_angle,y_min_angle:-i.y_angle,y_max_angle:i.y_angle,probability:i.probability})}};return t.useEffect(()=>{u.toLowerCase().replace(/ /g,"_");const i=R.reduce((V,A)=>({...V,[A.name]:A.default}),{});_(i)},[R,u]),t.useEffect(()=>{if(!x||!s)return;(async()=>{const V=new FormData;V.append("image",x);const A=u.toLowerCase().replace(/ /g,"_");V.append("augmentation_type",A);const B=Y[A]||{params:Object.keys(h)},L=B.configBuilder?B.configBuilder(h):B.params.reduce((O,q)=>({...O,[q]:h[q]}),{});V.append("parameters",JSON.stringify(L));try{const O=await E.post("http://localhost:8001/api/augmentations/single_transform/",V);D(O.data)}catch(O){console.error("Error fetching preview",O),y.error("Failed to fetch preview")}})()},[x,h,s,u]),t.useEffect(()=>{if(s){const i=u.toLowerCase().replace(/ /g,"_"),V=Y[i]||{params:Object.keys(h)},A=V.configBuilder?V.configBuilder(h):V.params.reduce((L,O)=>({...L,[O]:h[O]}),{});c({augmentation_type:i,parameters:A})}},[h,s,u,c]),s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg w-[90%] max-w-xl relative",children:[e.jsx("button",{className:"absolute top-2 right-2 text-gray-600",onClick:n,children:"✕"}),e.jsx("h2",{className:"text-xl font-semibold mb-4",children:u}),e.jsx("div",{className:"mb-4",children:R.map(i=>e.jsx(I,{label:i.name.replace(/_/g," ").replace(/\b\w/g,V=>V.toUpperCase()),min:0,max:Math.abs(i.range[1]),step:i.step,value:h[i.name]??i.default,onChange:V=>_(A=>({...A,[i.name]:V}))},i.name))}),l&&e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Original"}),e.jsx("img",{src:`data:image/jpeg;base64,${l.original_image}`,className:"w-40 h-28 object-cover rounded",alt:"Original"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Augmented"}),e.jsx("img",{src:`data:image/jpeg;base64,${l.augmented_image}`,className:"w-40 h-28 object-cover rounded",alt:"Augmented"})]})]})]})}):null},N=()=>{var V;const[s,n]=t.useState(null),[u,x]=t.useState(null),[R,c]=t.useState({}),[h,_]=t.useState([]),[l,D]=t.useState(null);console.log(X);const Y=(V=X[0])==null?void 0:V.url;t.useEffect(()=>{(async()=>{if(Y)try{const L=await(await fetch(Y)).blob(),O=new File([L],"first-image.jpg",{type:L.type});n(O)}catch(B){console.error("Failed to fetch image as file",B)}})()},[Y]),t.useEffect(()=>{(async()=>{try{const L=(await E.get("http://localhost:8001/api/augmentations/list_transform/")).data.augmentations,O=Object.entries(L).map(([q,le])=>({key:q,title:q.replace(/_/g," ").replace(/\b\w/g,xe=>xe.toUpperCase()),description:le.description,parameters:JSON.parse(le.parameters)}));_(O)}catch(B){console.error("Failed to fetch augmentation list",B),y.error("Failed to fetch augmentations")}})()},[]);const i=(A,B)=>{c(L=>({...L,[A]:B}))};return e.jsxs("div",{className:"p-4 max-w-4xl mx-auto",children:[e.jsx("div",{className:"grid grid-cols-2 gap-4",children:h.map(({key:A,title:B})=>e.jsx(g,{title:B,onClick:()=>x(A)},A))}),h.map(A=>e.jsx(a,{isOpen:u===A.key,onClose:()=>x(null),title:A.title,file:s,parameters:A.parameters,onUpdate:B=>i(A.key,B)},A.key)),l&&e.jsxs("div",{className:"flex gap-4 mt-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Original"}),e.jsx("img",{src:`data:image/jpeg;base64,${l.original_image}`,className:"w-40 h-28 object-cover rounded",alt:"Original"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Augmented"}),e.jsx("img",{src:`data:image/jpeg;base64,${l.augmented_image}`,className:"w-40 h-28 object-cover rounded",alt:"Augmented"})]})]})]})},w=[{label:"Select versions",component:()=>e.jsx("div",{className:"p-4 bg-gray-100 rounded-lg w-full text-green-600",children:e.jsx("div",{className:"flex flex-col rounded-lg p-4 shadow-md gap-3 mb-2 bg-white max-h-96 overflow-y-scroll",children:!F&&C.map(s=>e.jsxs("div",{className:"bg-white flex justify-center flex-col p-4 m-2 shadow-md rounded-lg text-center cursor-pointer",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex gap-4 items-center justify-center",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-500",checked:T.includes(s.name),onChange:n=>{n.target.checked?(W(u=>[...u,s.id]),z(u=>[...u,s.name])):(W(u=>u.filter(x=>x!==s.id)),z(u=>u.filter(x=>x!==s.name)))}}),e.jsx("img",{src:ee,alt:"",className:"w-4 h-4"}),e.jsx("h4",{className:"text-base font-medium",children:s.name})]}),e.jsxs("div",{className:"text-blue-500 font-semibold",children:[s.total_image_count," images ",e.jsx(se,{className:"w-5 h-5",fontSize:"small"})]})]}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(ue,{done:s.total_image_count>0?Math.round(s.labeled_image_count/s.total_image_count*100):0})}),e.jsxs("div",{className:"flex gap-6 items-center justify-center px-2",children:[e.jsxs("div",{className:"text-blue-500 font-semibold",children:["Annotated : ",s==null?void 0:s.labeled_image_count]}),e.jsxs("div",{className:"text-yellow-500 font-semibold",children:["Unannotated : ",s==null?void 0:s.unlabeled_image_count]}),e.jsxs("div",{className:"text-red-500 font-semibold",children:["Rejected : ",(s==null?void 0:s.rejected)||0]})]})]},s.id))})})},{label:"Select pre-processing methods",component:()=>e.jsx("div",{className:"p-4 bg-gray-100 rounded-lg w-full text-green-600",children:e.jsxs("div",{className:"flex flex-col rounded-lg p-4 shadow-md gap-3 mb-2 bg-white max-h-96 overflow-y-scroll",children:[e.jsx("p",{className:" text-green-600 font-semibold text-xl",children:"Pre-processing Methods"}),e.jsx(N,{})]})})},{label:"Select Augmentaions",component:()=>e.jsx("div",{className:"p-4 bg-gray-100 rounded-lg w-full text-green-600",children:e.jsxs("div",{className:"flex flex-col rounded-lg p-4 shadow-md gap-3 mb-2 bg-white max-h-96 overflow-y-scroll",children:[e.jsx("p",{className:" text-green-600 font-semibold text-xl",children:"Select Augmentaions"}),e.jsx(N,{})]})})},{label:"Select AI model",component:()=>e.jsx("div",{className:"p-4 bg-gray-100 rounded-lg w-full text-green-600",children:[1,2,3].map((s,n)=>e.jsxs("div",{className:"bg-white flex justify-center flex-col p-4 shadow-md border-[1px] rounded-lg text-center cursor-pointer w-full my-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"flex gap-4 items-center",children:e.jsxs("h4",{className:"font-medium",children:["Model ",n]})}),e.jsx("div",{className:"bg-blue-500 text-white rounded-full px-4 py-2font-semibold",children:"recommended"})]}),e.jsx("div",{className:"flex text-gray-400",children:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Nesciunt illum natus optio esse vero corrupti."})]},n))})},{label:"Start training",component:()=>e.jsxs("div",{className:"flex flex-col gap-4 items-center justify-center",children:[e.jsx("div",{className:"text-blue-600 flex text-5xl font-bold",children:"Train"}),e.jsx("div",{className:"flex items-center text-center text-green-600 text-lg font-semibold",children:"ML model training"})]})}],S=[{label:"Upload test data",component:()=>e.jsx("div",{className:"p-4 bg-gray-100 rounded-lg w-full text-blue-600",children:e.jsx("p",{children:"Testing: Upload Test Data"})})},{label:"Select model version",component:()=>e.jsx("div",{className:"p-4 bg-gray-100 rounded-lg w-full text-blue-600",children:e.jsx("p",{children:"Testing: Select Model Version"})})},{label:"Run tests and evaluate",component:()=>e.jsx("div",{className:"p-4 bg-gray-100 rounded-lg w-full text-blue-600",children:e.jsx("p",{children:"Testing: Run & Evaluate"})})}],d=r==="training"?w:r==="testing"?S:[],U=()=>{k(!0),p(null),M(0),Q(new Set)},J=()=>{k(!1),p(null),M(0),Q(new Set)},v=()=>{f<d.length-1&&M(s=>s+1)};return e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:U,className:"bg-primary hover:bg-green-600 text-white py-2 px-4 rounded-full flex items-center gap-2",children:"New Performance Evaluation"})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex flex-col rounded-lg p-4 shadow-md gap-3 my-4 bg-white min-h-[540px]",children:[e.jsxs("div",{className:"flex justify-between items-center px-4",children:[e.jsx("h1",{className:"text-blue-500 font-semibold text-md",children:"Recent Executions"}),e.jsx("button",{className:"px-4 py-1 bg-blue-600 text-white hover:bg-blue-500 rounded-full",children:"See all reports"})]}),[1,2,3].map((s,n)=>e.jsx("div",{className:"bg-white flex justify-center flex-col p-4 shadow-md border-[1px] rounded-lg text-center cursor-pointer w-full",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"flex gap-4 items-center",children:e.jsx("h4",{className:"font-medium",children:"PE-21 MAY 2025, 12:02:44PM"})}),e.jsx("div",{className:"font-semibold",children:"Execution time : 17 mins 38 secs"}),e.jsxs("div",{className:"text-blue-500 font-semibold",children:["View full report ",e.jsx(se,{className:"text-green-600",fontSize:"small"})]})]})},n))]})}),b&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:J}),e.jsxs("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[600px] bg-white shadow-lg rounded-lg p-6 z-50",children:[e.jsx("button",{onClick:J,className:"absolute top-4 right-4 text-green-600 hover:text-green-800",children:"✕"}),r?e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsx("div",{className:"absolute top-5 left-[6.5%] right-[6.5%] h-1 bg-gray-300 z-0 w-[84%]"}),e.jsx("div",{className:"absolute top-5 left-[6.5%] h-1 bg-green-600 z-10 transition-all duration-300",style:{width:`${Math.min(f/(d.length-1)*90,90)}%`}}),e.jsx("div",{className:"flex justify-between items-start relative z-10",children:d.map((s,n)=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center border-2 text-sm font-medium 
                            ${n<=f?"bg-green-600 border-green-600 text-white":"bg-white border-gray-300 text-gray-500"}`,children:n+1}),e.jsx("span",{className:"text-xs mt-2 text-center max-w-[140px]",children:s.label})]},n))})]}),f<d.length&&e.jsx("div",{className:"mt-4 w-full",children:d[f].component()}),e.jsx("div",{className:"flex flex-col pt-4",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col gap-2 items-center justify-center",children:[f<d.length-1&&e.jsx("button",{onClick:v,className:"w-48 m-2 py-2 px-4 rounded-full gap-2 text-white bg-primary hover:bg-green-600",children:f===d.length-1?"Start":"Next"}),f===d.length-1?e.jsx(e.Fragment,{}):e.jsxs("div",{className:"text-sm text-center",children:[e.jsx("span",{className:"font-semibold",children:"Disclaimer: "}),e.jsx("span",{className:"",children:"Proceeding to the next step may finalize your current choices. Please review your inputs carefully. Changes might not be possible later."})]})]})})})]}):e.jsxs("div",{className:"flex flex-col gap-4 items-center p-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 items-center justify-center",children:[e.jsx("div",{className:"text-blue-600 flex text-5xl font-bold",children:"Train"}),e.jsx("div",{className:"flex items-center text-center",children:"Got fresh data? Let’s teach your model how to make smart decisions. Select your annotations and start training!"}),e.jsx("button",{onClick:()=>p("training"),className:"bg-primary hover:bg-green-600 text-white py-2 px-4 rounded-full flex items-center gap-2",children:"Start Training"})]}),e.jsx("div",{className:"bg-black h-[1px] my-4 w-full"}),e.jsxs("div",{className:"flex flex-col gap-4 items-center justify-center",children:[e.jsx("div",{className:"text-blue-600 flex text-5xl font-bold",children:"Test"}),e.jsx("div",{className:"flex items-center text-center",children:"Already have a model? Let’s see how well it performs. Run it on test data and check the results."}),e.jsx("button",{onClick:()=>p("testing"),className:"bg-primary hover:bg-green-600 text-white py-2 px-4 rounded-full flex items-center gap-2",children:"Start Testing"})]})]})]})]})]})},as=()=>{const{workspaceId:m,skuId:o}=ge(),[C,F]=ne(),b=C.get("version"),k=C.get("tab")||"Versions",r=me(),[p,f]=t.useState([]),[M,G]=t.useState([]),[Q,K]=t.useState(b),W=async()=>{try{const g=await E.get(`http://localhost:8000/api/sku/${o}/`);G(g.data.results||[])}catch(g){console.error("Error fetching versions:",g)}},T=async()=>{try{const g=await E.get(`http://localhost:8000/api/versions/?sku=${o}`);f(g.data.results||[])}catch(g){console.error("Error fetching versions:",g)}};t.useEffect(()=>{W(),T()},[o]),t.useEffect(()=>{K(b)},[b]);const z=t.memo(({sku:g})=>{const[I,a]=t.useState(!1),[N,w]=t.useState(!1),S=async()=>{a(!0);try{y.success("SKU created successfully")}catch{y.error("Failed to create SKU")}finally{a(!1),w(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>w(!0),className:"text-white px-4 py-2 bg-blue-600 hover:bg-blue-500 text-sm rounded-full transition",children:"Create Version"}),e.jsx(oe,{title:"",description:e.jsx(Je,{sku:g}),onConfirm:S,isLoading:I,open:N,onOpenChange:w})]})}),X=({skuId:g})=>{const[I,a]=t.useState(null),[N,w]=ne(),[S,j]=t.useState(!1),[d,U]=t.useState([]),[J,v]=t.useState(!1),[s,n]=t.useState({source_version_id:null,target_version_id:null,overwrite:!1,skip_duplicates:!0,delete_source:!1}),u=l=>{U(D=>D.includes(l)?D.filter(Y=>Y!==l):[...D,l])},x=()=>{if(d.length<2){alert("Please select at least two versions to merge.");return}v(!0)},R=async()=>{if(d.length===0){alert("Please select at least one version to delete.");return}try{for(const l of d)await E.delete(`http://localhost:8000/api/versions/${l}/`,{headers:{accept:"application/json"}});console.log("Deleted versions:",d),U([]),T(),y.success("deleted version"),j(!1)}catch(l){console.error("Delete failed:",l),alert("Failed to delete one or more versions.")}},c=()=>{j(!1),U([])},h=async()=>{if(!s.source_version_id||!s.target_version_id){alert("Please select source and target versions.");return}try{const l=await E.post("http://localhost:8000/api/sku-images/merge-versions/",{source_version_id:parseInt(s.source_version_id),target_version_id:parseInt(s.target_version_id),sku_id:parseInt(g),overwrite:s.overwrite,skip_duplicates:s.skip_duplicates,delete_source:s.delete_source},{headers:{accept:"application/json","Content-Type":"application/json"}});console.log("Merge successful:",l.data),v(!1),U([]),j(!1)}catch(l){console.error("Merge failed:",l),alert("Failed to merge versions.")}},_=()=>{v(!1)};return e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"flex gap-16 justify-end items-end mb-2",children:e.jsx(z,{sku:g})}),e.jsxs("div",{className:"flex items-center p-2 justify-between bg-gray-200 rounded-full mb-2",children:[J&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg w-[90%] max-w-md relative",children:[e.jsx("button",{className:"absolute top-2 right-2 text-gray-600",onClick:_,children:"✕"}),e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Merge Versions"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Source Version"}),e.jsxs("select",{className:"w-full p-2 border rounded",value:s.source_version_id||"",onChange:l=>n({...s,source_version_id:l.target.value}),children:[e.jsx("option",{value:"",disabled:!0,children:"Select Source Version"}),d.map(l=>{const D=p.find(Y=>Y.id===l);return e.jsx("option",{value:l,children:D.name},l)})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Target Version"}),e.jsxs("select",{className:"w-full p-2 border rounded",value:s.target_version_id||"",onChange:l=>n({...s,target_version_id:l.target.value}),children:[e.jsx("option",{value:"",disabled:!0,children:"Select Target Version"}),d.map(l=>{const D=p.find(Y=>Y.id===l);return e.jsx("option",{value:l,children:D.name},l)})]})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s.overwrite,onChange:l=>n({...s,overwrite:l.target.checked})}),"Overwrite"]})}),e.jsx("div",{className:"mb-4",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s.skip_duplicates,onChange:l=>n({...s,skip_duplicates:l.target.checked})}),"Skip Duplicates"]})}),e.jsx("div",{className:"mb-4",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s.delete_source,onChange:l=>n({...s,delete_source:l.target.checked})}),"Delete Source"]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white hover:bg-blue-700 rounded-full",onClick:h,children:"Confirm Merge"}),e.jsx("button",{className:"px-3 py-1 bg-gray-600 text-white hover:bg-gray-700 rounded-full",onClick:_,children:"Cancel"})]})]})}),e.jsxs("div",{className:"px-4 font-semibold",children:["Total Versions : ",p.length," "]}),S?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white hover:bg-blue-700 rounded-full",onClick:x,children:"Merge Version"}),e.jsx("button",{className:"px-3 py-1 bg-red-600 text-white hover:bg-red-700 rounded-full",onClick:R,children:"Delete Version"}),e.jsx("button",{className:"px-3 py-1 bg-gray-600 text-white hover:bg-gray-700 rounded-full",onClick:c,children:"Back"})]}):e.jsxs("button",{className:"px-3 py-1 bg-red-600 text-white flex justify-center items-center gap-4 hover:bg-red-700 rounded-full",onClick:()=>j(!0),children:["Bulk Version Edit ",e.jsx("img",{src:te,alt:"Delete",className:"w-4 h-4"})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:p.map(l=>e.jsxs("div",{onClick:()=>!S&&(a(l.id),w({tab:"SKU data",version:l.id})),className:`flex items-center justify-center flex-col gap-2 p-3 text-center rounded-lg shadow hover:bg-gray-100 cursor-pointer relative ${d.includes(l.id)?"bg-blue-100 border-2 border-blue-600":""} ${S?"cursor-default":""}`,children:[S&&e.jsx("input",{type:"checkbox",checked:d.includes(l.id),onChange:()=>u(l.id),className:"absolute top-2 left-2",onClick:D=>D.stopPropagation()}),e.jsx("img",{src:ee,alt:"",className:"w-8 h-8"}),e.jsx("h4",{className:"text-base font-medium",children:l.name})]},l.id))}),I&&k==="SKU data"&&e.jsx("div",{className:"p-4 border rounded-lg shadow bg-gray-100",children:e.jsx(Z,{skuId:g,version:I})})]})},H=({skuId:g})=>{console.log("skuId",g);const I=async a=>{var N;try{const S=(N=(await E.get(`http://localhost:8000/api/sku-images-list/?sku_id=${g}&version_id=${a}`)).data.results)==null?void 0:N.map(j=>({id:j.id,name:j.original_filename,url:`http://localhost:8000${j.image}`}));if(S&&S.length>0){K(a);const j=S[0].id;r(`/client/workspaces/${m}/sku/${g}/image/${j}?tab=Annotate&version=${a}`)}else K(""),y.error("No images to display for this version")}catch(w){console.error("Failed to fetch images",w),y.error("Failed to fetch images")}};return e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"flex flex-col rounded-lg p-4 shadow-md gap-3 mb-2 bg-white",children:[e.jsx("h1",{className:"text-[#43996A] font-bold text-center justify-center items-center text-xl",children:"Versions"}),!Q&&p.map(a=>e.jsxs("div",{onClick:()=>{I(a.id)},className:"bg-white flex justify-center flex-col p-4 m-2 shadow-md hover:bg-slate-100 rounded-lg text-center cursor-pointer",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex gap-4 items-center justify-center",children:[e.jsx("img",{src:ee,alt:"",className:"w-4 h-4"}),e.jsx("h4",{className:"text-base font-medium",children:a.name})]}),e.jsxs("div",{className:"text-blue-500 font-semibold",children:[a.total_image_count," images ",e.jsx(se,{className:"w-5 h-5",fontSize:"small"})]})]}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(ue,{done:a.total_image_count>0?Math.round(a.labeled_image_count/a.total_image_count*100):0})}),e.jsxs("div",{className:"flex flex-col gap-1 items-start justify-start px-12",children:[e.jsxs("div",{className:"text-blue-500 font-semibold",children:["Annotated : ",a==null?void 0:a.labeled_image_count]}),e.jsxs("div",{className:"text-yellow-500 font-semibold",children:["Unannotated : ",a==null?void 0:a.unlabeled_image_count]}),e.jsxs("div",{className:"text-red-500 font-semibold",children:["Rejected : ",(a==null?void 0:a.rejected)||0]})]})]},a.id))]}),e.jsxs("div",{className:"flex flex-col rounded-lg p-4 shadow-md gap-3 mb-2 bg-white",children:[e.jsx("h1",{className:"text-[#43996A] font-bold text-center justify-center items-center text-xl",children:"Datasets"}),!Q&&p.map(a=>e.jsx("div",{className:"bg-white flex justify-center flex-col gap-2 p-4 m-2 shadow-md hover:bg-slate-100 rounded-lg text-center cursor-pointer",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex gap-4 items-center justify-center",children:[e.jsx("img",{src:ee,alt:"",className:"w-4 h-4"}),e.jsx("h4",{className:"text-base font-medium",children:a.name})]}),e.jsx("div",{className:"text-[#43996A] font-semibold",children:e.jsx(Ue,{className:"w-5 h-5",fontSize:"small"})})]})},a.id))]})]})})},Z=({skuId:g,version:I})=>{const[a,N]=t.useState([]),[w,S]=t.useState([]),[j,d]=t.useState(null),U=async()=>{var c;try{const _=(c=(await E.get(`http://localhost:8000/api/sku-images-list/?sku_id=${g}&version_id=${I}`)).data.results)==null?void 0:c.map(l=>({id:l.id,name:l.original_filename,url:`http://localhost:8000${l.image}`}));N(_||[])}catch(h){console.error("Failed to fetch images",h)}};t.useEffect(()=>{U()},[g,I]);const J=c=>{S(h=>h.includes(c)?h.filter(_=>_!==c):[...h,c])},v=async c=>{if(window.confirm("Are you sure you want to delete this image?"))try{await E.delete("http://localhost:8000/api/sku-images/",{data:{image_ids:[c]}}),y.success("Image deleted successfully"),U()}catch{y.error("Failed to delete image")}},s=async()=>{if(w.length===0){y.error("Please select images to delete.");return}if(window.confirm(`Are you sure you want to delete ${w.length} image(s)?`))try{await E.delete("http://localhost:8000/api/sku-images/",{data:{image_ids:w}}),y.success("Images deleted successfully"),U(),S([])}catch{y.error("Failed to delete images")}},n=t.memo(({id:c,src:h,alt:_})=>e.jsx(oe,{title:"",description:e.jsxs(e.Fragment,{children:[e.jsx("img",{src:h,alt:_,className:"w-full h-auto max-h-[80vh] object-contain rounded"}),e.jsx("h1",{children:_})]}),children:e.jsx("button",{className:"bg-green-500 text-white text-xs px-3 py-1 rounded shadow",children:"Preview"})})),u=()=>{d(c=>(c+1)%a.length)},x=()=>{d(c=>(c-1+a.length)%a.length)},R=()=>{d(null)};return e.jsxs(e.Fragment,{children:[j!==null&&a.length>0&&e.jsxs("div",{className:"relative bg-gray-900 p-4 rounded-lg mb-4 flex items-center justify-center",children:[e.jsx("button",{onClick:R,className:"absolute top-2 right-2 text-white text-lg font-bold",children:"×"}),e.jsx("button",{onClick:x,className:"absolute left-4 text-white text-2xl font-bold",disabled:a.length<=1,children:"←"}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("img",{src:a[j].url,alt:a[j].name,className:"max-w-full max-h-[60vh] object-contain rounded"}),e.jsx("h1",{className:"text-white text-lg mt-2",children:a[j].name})]}),e.jsx("button",{onClick:u,className:"absolute right-4 text-white text-2xl font-bold",disabled:a.length<=1,children:"→"})]}),e.jsx("div",{className:"flex gap-16 justify-end items-end mb-2",children:e.jsx("button",{onClick:()=>F({tab:"upload",version:I}),className:"text-white text-md font-semibold bg-blue-600 rounded-full py-1 px-3 min-w-36",children:"Upload Files"})}),e.jsxs("div",{className:"flex items-center p-2 justify-between bg-gray-200 rounded-full",children:[e.jsxs("div",{className:"px-4 font-semibold",children:["Uploaded files: ",a.length]}),e.jsxs("button",{onClick:s,className:"px-3 py-1 bg-red-600 text-white flex justify-center items-center gap-4 hover:bg-red-700 rounded-full",children:["Bulk Delete ",e.jsx("img",{src:te,alt:"Delete",className:"w-4 h-4"})]})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4 p-4",children:a.map(c=>e.jsxs("div",{className:"border rounded group p-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:c.url,alt:c.name,className:"w-full h-28 object-fill rounded mb-2"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(n,{id:c.id,src:c.url,alt:c.name}),e.jsx("button",{onClick:()=>v(c.id),className:"bg-red-500 text-white text-xs px-3 py-1 rounded shadow",children:"Delete"})]})})]}),e.jsxs("div",{className:"flex items-center justify-between px-2 py-1 text-xs bg-white",children:[e.jsx("input",{type:"checkbox",checked:w.includes(c.id),onChange:()=>J(c.id)}),e.jsx("span",{onClick:()=>navigator.clipboard.writeText(c.name).then(()=>y.success(`Copied: ${c.name}`)),className:"cursor-pointer text-blue-600 hover:underline truncate w-28",title:c.name,children:c.name})]})]},c.id))})]})},$=({skuId:g,version:I,tags:a})=>{const[N,w]=t.useState([]),[S,j]=t.useState(re),d=v=>{if(!v)return;const s=Array.from(v).filter(n=>["image/jpeg","image/jpg","image/png","image/bmp"].includes(n.type)).map(n=>({file:n,name:n.name,preview:URL.createObjectURL(n)}));w(n=>[...n,...s])},U=v=>{w(s=>s.filter((n,u)=>u!==v)),j(re)},J=async(v=!1,s=!1)=>{var u;if(N.length===0){y.error("No images to upload");return}const n=new FormData;N.forEach(({file:x})=>n.append("images",x)),n.append("sku_id",g),n.append("tags",a),n.append("version_name",I),n.append("version_id",I),n.append("allow_duplicates",v.toString()),n.append("overwrite",s.toString());try{const x=await E.post("http://localhost:8000/api/sku-images/",n);((u=x.data.skipped)==null?void 0:u.length)>0&&x.data.skipped.some(R=>R.reason.includes("Duplicate"))?window.confirm(`${x.data.skipped.length} image(s) were skipped due to duplication.
Would you like to re-upload with overwrite?`)?await J(!0,!0):y.error("Upload skipped for duplicate images."):(y.success("Upload successful!"),F({tab:"SKU data",version:I}))}catch{y.error("Upload failed.")}};return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Upload SKU Data"}),e.jsx("button",{onClick:J,className:"bg-blue-600 rounded-full text-white px-6 py-2",children:"Save"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"border-2 rounded-md border-dashed border-green-400 p-6 flex flex-col items-center justify-center",children:[e.jsx("img",{src:Re,alt:"Camera Icon",className:"w-16 h-16 mb-2"}),e.jsx("button",{className:"bg-green-200 px-4 py-2 rounded",children:"Load from Indus Vision camera"})]}),e.jsxs("div",{className:"border-2 border-dashed rounded-md border-blue-400 p-6 text-center flex items-center justify-center",children:[e.jsx("input",{type:"file",accept:".jpg,.jpeg,.png,.bmp",multiple:!0,className:"hidden",id:"fileInput",onChange:v=>d(v.target.files)}),e.jsxs("label",{htmlFor:"fileInput",className:"cursor-pointer flex flex-col justify-center items-center",children:[e.jsx("img",{src:Me,alt:"Upload Icon",className:"mb-4 w-24 h-24"}),e.jsx("div",{className:"text-white text-lg font-semibold bg-blue-600 rounded-full p-2",children:"Click to upload files from device"}),e.jsx("div",{className:"text-md text-gray-500 mt-1",children:"or drag and drop files here"}),e.jsxs("div",{className:"text-md mt-1",children:[e.jsx("span",{className:"text-red-400",children:"*"})," Files supported: .jpeg .jpg .png .bmp"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Uploaded Files"}),N.length===0?e.jsx("div",{className:"text-gray-500 flex justify-center items-center text-lg border p-4 rounded h-64",children:"No files have been uploaded."}):e.jsx("div",{className:"grid gap-4 max-h-96 overflow-y-auto",children:N.map((v,s)=>e.jsxs("div",{className:"px-4 py-2 border rounded shadow-sm flex justify-between items-center bg-gray-100",children:[e.jsx("img",{src:v.preview,alt:`preview-${s}`,className:"w-16 h-16 object-fill rounded cursor-pointer",onClick:()=>j(v.preview)}),e.jsx("div",{children:v.name}),e.jsx("button",{onClick:()=>U(s),title:"Delete",className:"ml-2",children:e.jsx("img",{src:De,alt:"Delete"})})]},s))})]}),e.jsx("div",{className:"mt-6 flex",children:e.jsx("img",{src:S,alt:"Selected Preview",className:"w-full h-96 object-fill rounded"})})]})]})},P=({skuId:g,version:I})=>{const[a,N]=t.useState({labelName:"",shortcutKey:"",colorCode:"#EEE"}),[w,S]=t.useState(0),j=async()=>{try{await E.post("http://localhost:8000/api/label/",{name:a.labelName,sku_id:g,shortcut_key:a.shortcutKey.toUpperCase(),color_code:a.colorCode,is_active:!0}),y.success("Label added successfully!"),N({labelName:"",shortcutKey:"",colorCode:"#EEE"}),S(d=>d+1)}catch{y.error("Failed to add label")}};return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(ae,{title:"Add New Labels",description:e.jsxs("div",{children:[e.jsx("p",{className:"mb-2",children:"Add New Labels"}),e.jsxs("form",{onSubmit:d=>d.preventDefault(),children:[e.jsx("input",{type:"text",className:"w-full px-2 py-1 border rounded-full mb-2",placeholder:"Label name",value:a.labelName,onChange:d=>N({...a,labelName:d.target.value})}),e.jsx("input",{type:"text",className:"w-full px-2 py-1 border rounded-full mb-2",placeholder:"Keyboard Shortcut key (e.g., G)",value:a.shortcutKey,onChange:d=>N({...a,shortcutKey:d.target.value})}),e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium mb-2",children:["Select color:",e.jsx("input",{type:"color",className:"h-8 w-10 rounded-full border",value:a.colorCode,onChange:d=>N({...a,colorCode:d.target.value})})]})]})]}),onConfirm:j,children:e.jsx("div",{className:"flex items-end justify-end",children:e.jsx("button",{className:"w-32 px-3 py-1 bg-blue-600 text-white flex justify-center items-center gap-4 hover:bg-blue-500 rounded-full",children:"Add Labels"})})}),e.jsx(Qe,{skuId:g,refreshKey:w})]})};return e.jsxs("div",{className:"p-4",children:[k==="Versions"&&e.jsx(X,{skuId:o}),k==="SKU data"&&e.jsx(Z,{skuId:o,version:b}),k==="upload"&&e.jsx($,{skuId:o,version:b,tags:"AnamolyDetection"}),k==="Label"&&e.jsx(P,{skuId:o,version:b}),k==="Annotate"&&e.jsx(H,{skuId:o}),k==="Indus Vision AI"&&e.jsx(Ge,{skuId:o,version:b,skuVersions:p,selectedVersion:Q})]})};export{as as default};

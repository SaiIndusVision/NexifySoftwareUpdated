import{j as e}from"./mui-B_PChry4.js";import{h as $,f as E,r as a}from"./react-core-CQlor4TK.js";import{n as R,o as I,u as o}from"./index-Bv_2KTqU.js";import{a as d}from"./data-utils-DaMdQHZx.js";import{p as D}from"./nexify-placeholder-img-DvrgdLBk.js";import"./state-management-BfQTD3Fv.js";import"./ui-utils-DC4QuFVe.js";import"./radix-B0DvzVia.js";import"./form-tools-DBwiXJwN.js";const m="http://localhost:8000/api",T=()=>{const{workspaceId:c}=$(),w=E(),[l,x]=a.useState([]),[n,y]=a.useState([]),[g,f]=a.useState(null),[p,b]=a.useState(null),[u,j]=a.useState(""),[S,h]=a.useState(!1),N=async()=>{try{const t=await d.get(`${m}/sku/?workspace_id=${c}`);x(t.data.results)}catch{o.error("Error fetching SKUs",{position:"top-center",duration:4e3})}},v=async()=>{try{const t=await d.get(`${m}/workspace/${c}/`);y(t.data.results)}catch{o.error("Error fetching workspace data",{position:"top-center",duration:4e3})}};console.log(n),a.useEffect(()=>{N(),v()},[c]);const C=t=>{f(g===t?null:t)},k=async t=>{try{await d.delete(`${m}/sku/${t}/`),x(r=>r.filter(s=>s.id!==t)),o.success("SKU deleted",{position:"top-center",duration:4e3})}catch{o.error("Failed to delete SKU",{position:"top-center",duration:4e3})}},_=t=>{b(t),j(t.name),h(!0),f(null)},U=async()=>{try{const t={...p,name:u,updated_date_time:new Date().toISOString()},r=await d.put(`${m}/sku/${p.id}/`,t,{headers:{"Content-Type":"application/json"}});x(s=>s.map(i=>i.id===p.id?{...i,name:u}:i)),o.success("SKU renamed",{position:"top-center",duration:4e3}),h(!1)}catch{o.error("Rename failed",{position:"top-center",duration:4e3})}},K=a.memo(()=>{const[t,r]=a.useState(!1),s=async()=>{r(!0);try{o.success("SKU created successfully",{position:"top-center",duration:4e3}),await N()}catch{o.error("Failed to create SKU",{position:"top-center",duration:4e3})}finally{r(!1)}};return e.jsx(R,{title:"",description:e.jsx(I,{}),onConfirm:s,isLoading:t,children:e.jsxs("p",{className:"text-md text-center font-semibold",children:[e.jsxs("div",{className:"flex justify-center items-center gap-2 ",children:[e.jsxs("span",{className:"text-green-600 px-1  rounded-md border-green-600  border text-center ",children:["+"," "]}),e.jsx("span",{className:"text-green-600",children:"Click to add more SKUs "}),e.jsx("br",{})]}),e.jsxs("span",{className:"text-green-600",children:[" ",n.sku_total_count-l.length,"/",n.sku_total_count," left to create"]})]})})});return e.jsxs("div",{className:"px-4",children:[l.length===0?e.jsxs("div",{className:"flex flex-col gap-3 text-2xl font-semibold text-[#BEBEBE] items-center justify-center min-h-[560px]",children:[e.jsx("div",{className:"flex",children:"No SKUs to show"}),e.jsx("div",{className:"flex",children:"Click on Create SKUs button to create one"}),e.jsxs("div",{className:"flex",children:[l.length,"/",n.sku_total_count," left to create"]})]}):e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[l.map((t,r)=>e.jsx("div",{className:"w-full",children:e.jsxs("div",{onClick:()=>w(`/client/workspaces/${c}/sku/${t.id}?tab=Versions`),className:"relative bg-gray-200 p-4 rounded-lg shadow-sm flex gap-6 cursor-pointer mb-2",children:[e.jsx("div",{className:"w-32 h-32 min-w-[8rem] min-h-[8rem] rounded-2xl overflow-hidden flex items-center justify-center bg-white",children:e.jsx("img",{src:t.first_image?`http://localhost:8000${t.first_image}`:D,alt:"SKU",className:"object-cover w-full h-full"})}),e.jsxs("div",{className:"w-[50%] flex flex-col justify-center",children:[e.jsx("h3",{className:"text-xl font-semibold break-words",children:t.name}),e.jsx("p",{className:"text-sm text-gray-500 break-words",children:t.tag_name}),e.jsxs("p",{className:"text-sm text-gray-500 break-words",children:["Total images : ",t.image_count]}),e.jsxs("p",{className:"text-sm text-gray-500 break-words",children:["Versions : ",t.version_count]}),e.jsxs("p",{className:"text-sm text-gray-500 break-words",children:["Created at : ",new Date(t.created_date_time).toLocaleDateString()]}),e.jsxs("p",{className:"text-sm text-gray-500 break-words",children:["Updated at : ",new Date(t.updated_date_time).toLocaleDateString()]})]}),e.jsxs("div",{className:"absolute top-2 right-2",children:[e.jsx("button",{onClick:s=>{s.stopPropagation(),C(r)},className:"text-gray-500",children:e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"12",cy:"5",r:"1.5",fill:"currentColor"}),e.jsx("circle",{cx:"12",cy:"12",r:"1.5",fill:"currentColor"}),e.jsx("circle",{cx:"12",cy:"19",r:"1.5",fill:"currentColor"})]})}),g===r&&e.jsx("div",{className:"absolute right-0 mt-2 w-32 bg-white rounded-lg shadow-sm z-10",children:e.jsxs("ul",{className:"py-1",children:[e.jsx("li",{className:"px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer",onClick:s=>{s.stopPropagation(),_(t)},children:"Rename"}),e.jsx("li",{className:"px-4 py-2 text-sm text-gray-400 cursor-not-allowed",children:"Merge"}),e.jsx("li",{className:"px-4 py-2 text-sm text-red-600 hover:bg-gray-100 cursor-pointer",onClick:s=>{s.stopPropagation(),k(t.id)},children:"Delete"})]})})]})]})},t.id)),l.length<(n==null?void 0:n.sku_total_count)?e.jsx("div",{className:"p-4 rounded-lg flex flex-col items-center justify-center border-dotted border-2 border-green-500 cursor-pointer",children:e.jsx(K,{})}):e.jsx("div",{className:"p-4 rounded-lg flex flex-col items-center justify-center border border-dashed",children:e.jsxs("p",{className:"text-center font-semibold text-md text-gray-400",children:["Contact Indus Vision team to add more SKUs.",e.jsx("br",{})]})})]}),S&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg w-full max-w-sm shadow-lg space-y-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Rename SKU"}),e.jsx("input",{type:"text",className:"w-full border px-3 py-2 rounded-md",value:u,onChange:t=>j(t.target.value)}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>h(!1),className:"bg-red-500 text-white px-4 py-1 rounded-full hover:bg-red-600",children:"Cancel"}),e.jsx("button",{onClick:U,className:"bg-green-500 text-white px-4 py-1 rounded-full hover:bg-green-600",children:"Save"})]})]})})]})};export{T as default};

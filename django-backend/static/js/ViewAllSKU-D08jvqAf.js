import{j as e}from"./mui-Bss3QQll.js";import{r,h as P,u as Y,f as D}from"./react-core-spor8t4e.js";import{t as Q,F as H,b as X,c as T,d as q,I as J,e as Z,B as $,L as _,u,j as ee,w as V,x as se}from"./index-CNItTNil.js";import{b as te,n as re,s as ae,d as oe}from"./form-tools-C_3viVMX.js";import{u as ne,a as h}from"./data-utils-CsUIpaiA.js";import{a as le}from"./mockData-DYbdjJ3i.js";import"./state-management-7spMuoR3.js";import"./ui-utils-D3kZWK2d.js";import"./radix-B4zV8Utj.js";const ce=te({name:ae().min(1,"Version name is required").max(100,"Maximum 100 characters allowed"),sku:re().nullable().optional()}),ie=()=>ne({mutationFn:async l=>(await h.post("https://ac4ee0054010e6ee7a052c425e401a13.serveo.net/api/versions/",l)).data}),de=({sku:l})=>{const{mutate:c,isLoading:i}=ie(),x=oe({resolver:Q(ce),defaultValues:{name:"",sku:l}}),d=m=>{const f={name:m.name,sku:m.sku};console.log(f),c(f,{onSuccess:()=>{u.success("Version created successfully"),x.reset(),window.location.reload()},onError:()=>{u.error("Failed to create Version")}})};return e.jsxs(H,{...x,children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"text-2xl font-secondary font-bold text-[#062393]",children:"Create a New Version"}),e.jsxs("div",{className:"text-sm font-secondary  font-normal ",children:["Fill all the fields ",l]})]}),e.jsxs("form",{onSubmit:x.handleSubmit(d),className:"space-y-6",children:[e.jsx(X,{control:x.control,name:"name",render:({field:m})=>e.jsxs(T,{children:[e.jsx(q,{children:e.jsx(J,{...m,placeholder:"Name of Version*",className:"rounded-full w-full"})}),e.jsx(Z,{})]})}),e.jsx($,{type:"submit",disabled:i,className:"w-full rounded-full",children:i?e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"mr-2 h-4 w-4 animate-spin"}),"Please wait"]}):"Create New Version"})]})]})},me="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG4AAABWCAYAAAAucqM7AAAACXBIWXMAABCcAAAQnAEmzTo0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMESURBVHgB7d0/TxRBHMbx3wx70WiIdIr/cvYaeQEmyhugtzBIbWODFCYKJYoJdpSeDYkVWphYcRQWdBIruwWNWOnSyMHezrizMscenGiBsM/u80kudzu5S0i+zMxuNSp4sP5YWTspGMJYq2GZHgyl4jRQNKdeM3ZRJtbrUnFa8DBeStXGv1p/8f1RvxTVx29GRho/ZWOr8+dWetmEmXHXzml5M3pKzpxQfqjSMw9qqWS8XXB7HOP9hnhzwngCGs6pejzYcE6V40GHc6oaD+Y57m96PedZk4xJybSDIHTPrqUJ5/SIV0rpP+Qw/FKZ12PZLCl9K5CS8fEevmtJmaxGVj5vmM516cI5Pl6ZTC9tpa/tznWplsoqYThQDAeK4UAxHCiGA8VwoBgOFMOBYjhQDAeK4UAxHCiGA8VwoBgOFMOBYjhQDAeK4UAxHCiGA8VwoBgOFMOBYjhQDAeK4UAxHCiGA8VwoBgOFMOBYjhQDAeK4UAxHCiGA8VwoBgOFMOBYjhQDAeK4UAxHCiGA8VwoBgOFMOBYjhQDAeK4UAxHCiGA8VwoBgOFMOB0mIl8hcbrXIfJoQs30YpFWlREvoBdxoUFVO+jbXJB22NWfIDbz/FQsWzFhl5v5p0roMgCNM9zi74gfmVNpfLAspHS7e2Zmt6MNTtZ5eafp9z0eaWt4WKw822/ClWotWL7G3ncsqPzy3H3OsKxEVz8XaE8ZPBhvuQhYtnzs+mb0332c26O68281+mY+LOjJtfyd13KDXpP3ae4/q0GvNLpos28nKz+0d0ZNzkufe61bVEKmOn/GzLrvM/qI1/GRKrF9PRAT92+3otfQVyo17Kwx0Lxd9juO2q6ybR2kY8c+Fu/rv7ToE9ObFeT9w52iL1/PjlAS1Xz+rsGEs6XGuR3XfLv8s8j59evL93tOfxvVm8xEyma+qo0HHJzjHP7vp7OPDc5VzAm7JnBtL/YdPnNKX0wul4sxHNXon+9L1/PjDb7X/GmLqSviGhQ6V03w9jtlf7k6R5UKy8X8WBPRteZdGpAAAAAElFTkSuQmCC",ue=()=>{const[l,c]=r.useState(window.innerWidth);return r.useEffect(()=>{const i=()=>c(window.innerWidth);return window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]),l},Se=()=>{var N;const l="https://ac4ee0054010e6ee7a052c425e401a13.serveo.net/api",[c,i]=r.useState(null);ue();const{id:x,workspaceId:d,skuId:m}=P();console.log(d),console.log(m),ee(),(N=Y().state)!=null&&N.selectedRow;const k=D(),F=r.memo(({icon:s})=>{const[t,a]=r.useState(!1),o=async()=>{a(!0);try{u.success("SKU created successfully")}catch{u.error("Failed to create SKU")}finally{a(!1)}};return e.jsx(V,{title:"",description:e.jsx(e.Fragment,{children:e.jsx(se,{})}),onConfirm:o,isLoading:t,children:e.jsxs("p",{className:`text-md text-center ${n.length<5?"text-green-600":"text-gray-500"}`,children:[n.length<5?"Click to add more SKUs":"Contact Indus Vision to add more SKUs",e.jsx("br",{}),n.length,"/5 left to create"]})})}),B=r.memo(({row:s,sku:t,icon:a,open:o})=>{const[j,A]=r.useState(o??!1),[R,C]=r.useState(!1);r.useEffect(()=>{o&&A(!0)},[o]);const L=async()=>{C(!0);try{u.success("SKU created successfully")}catch{u.error("Failed to create SKU")}finally{C(!1),A(!1)}};return e.jsx(V,{title:"",description:e.jsx(de,{sku:t}),onConfirm:L,isLoading:R,open:o,onOpenChange:A})}),[w,b]=r.useState([]),K=async()=>{var s;try{const t=await h.get(`https://ac4ee0054010e6ee7a052c425e401a13.serveo.net/api/workspace/${d}/`,{headers:{Accept:"application/json"}});(s=t.data)!=null&&s.results?b(t.data.results):b([])}catch(t){console.log(t)}};r.useEffect(()=>{K()},[]),r.useEffect(()=>{console.log("Workspace data updated:",w)},[w]);const[n,I]=r.useState([]),y={};n.map(async s=>{var a;const t=(a=le)==null?void 0:a.results.filter(o=>o.sku_id===s.id);y[s.id]=t}),console.log("versionsMap",y);const[M,O]=r.useState({}),U=async()=>{try{const t=(await h.get(`${l}/sku/?workspace_id=${d}`)).data.results;I(t);const a={};await Promise.all(t.map(async o=>{const j=await h.get(`${l}/versions/?sku=${o.id}`);a[o.id]=j.data.results})),O(a)}catch(s){console.error("Error fetching SKU data:",s)}};r.useEffect(()=>{U()},[d]);const z="https://fibregridstorage.blr1.digitaloceanspaces.com/Fibregrid_projects/FY_25-26/Agriculture%20Projects/1_AGR_25-26_02_[Ekfrazo]/stage%204/Images/nexify-placeholder-img.png",E=s=>{i(c===s?null:s)},[S,v]=r.useState(null),[W,G]=r.useState(!1),[g,p]=r.useState(null);return console.log(g),e.jsx(e.Fragment,{children:e.jsx("div",{className:"px-4",children:S?n.filter(s=>s.id===S).map(s=>e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"w-full flex gap-8 items-center",children:[e.jsx("button",{onClick:()=>{v(null),p(null)},className:"mb-4 px-4 py-2 bg-gray-200 hover:bg-gray-300 text-sm rounded-lg transition",children:"â† Back"}),e.jsxs("button",{onClick:()=>G(!0),className:"mb-4 text-white px-4 py-2 bg-blue-600 hover:bg-blue-500 text-sm rounded-lg transition",children:[e.jsx(B,{open:W,sku:s.id}),"Create Version"]})]}),!g&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:(M[s.id]||[]).map(t=>e.jsxs("div",{onClick:()=>{p(t.id),k(`/client/workspaces/${d}/sku/${s.id}?version=${t.id}&tab=SKU+data`)},className:"flex items-center justify-center flex-col gap-2 p-3 text-center rounded-lg shadow hover:bg-gray-100 cursor-pointer",children:[e.jsx("img",{src:me,alt:""}),e.jsx("h4",{className:"text-base font-medium",children:t.name})]},t.id))}),g&&e.jsxs("div",{className:"p-4 border rounded-lg shadow bg-gray-100",children:[e.jsxs("p",{className:"text-sm mb-2",children:["Selected Version ID: ",g]}),e.jsx("button",{onClick:()=>p(null),className:"px-4 py-1 bg-red-500 text-white rounded hover:bg-red-600 text-sm",children:"Clear Selection"})]})]},s.id)):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-4",children:[n.map((s,t)=>e.jsx("div",{className:"w-full",children:e.jsxs("div",{onClick:()=>{v(s.id),p(null)},className:"relative bg-gray-200 p-4 rounded-lg shadow-sm flex h-38 gap-4 cursor-pointer mb-2",children:[e.jsx("div",{className:"w-48 h-full rounded-2xl",children:e.jsx("img",{src:z,alt:"SKU Image",className:"w-full h-full rounded-2xl"})}),e.jsxs("div",{className:"w-[90%]",children:[e.jsx("h3",{className:"text-lg font-semibold",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.tag_name})]}),e.jsxs("div",{className:"absolute top-2 right-2",children:[e.jsx("button",{onClick:a=>{a.stopPropagation(),E(t)},className:"text-gray-500",children:e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("circle",{cx:"12",cy:"5",r:"1.5",fill:"currentColor"}),e.jsx("circle",{cx:"12",cy:"12",r:"1.5",fill:"currentColor"}),e.jsx("circle",{cx:"12",cy:"19",r:"1.5",fill:"currentColor"})]})}),c===t&&e.jsx("div",{className:"absolute right-0 mt-2 w-32 bg-white rounded-lg shadow-sm z-10",children:e.jsxs("ul",{className:"py-1",children:[e.jsx("li",{className:"px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer",children:"Rename"}),e.jsx("li",{className:"px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer",children:"Merge"}),e.jsx("li",{className:"px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer",children:"Delete"})]})})]})]})},s.id)),e.jsx("div",{className:`p-4 rounded-lg flex flex-col items-center justify-center border-dotted border-2 ${n.length<5?"border-green-500 cursor-pointer":"border-gray-300"}`,children:n.length<5?e.jsx(F,{}):e.jsx("p",{className:`text-md text-center ${n.length<5?"text-green-600":"text-gray-500"}`,children:n.length<5?"Click to add more SKUs":"Contact Indus Vision to add more SKUs"})})]})})})})};export{Se as default};
//# sourceMappingURL=ViewAllSKU-D08jvqAf.js.map

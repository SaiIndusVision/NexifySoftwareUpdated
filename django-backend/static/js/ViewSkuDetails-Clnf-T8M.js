import{e as ue,j as e}from"./mui-BFA6lQrI.js";import{r as t,f as xe,h as pe,i as ie}from"./react-core-CQlor4TK.js";import{p as oe}from"./nexify-placeholder-img-DvrgdLBk.js";import{u as fe,D as be}from"./useDynamicPagination-Bgt9l9mQ.js";import{u as je}from"./useFilterApi-CeY-s8Rk.js";import{C as ae,j as Ae,o as ye,A as ce,t as Ne,F as we,b as ve,c as Ce,d as ke,I as Se,e as Ie,B as Ve,L as Ee,u as v,m as de}from"./index-uJeo5NJI.js";import{a as V,u as Be}from"./data-utils-7BzZlo9U.js";import{b as _e,n as Fe,s as Re,d as De}from"./form-tools-DBwiXJwN.js";import"./state-management-hQ1z8sur.js";import"./ui-utils-DmSiVVjI.js";import"./radix-BHg8RD76.js";const Me="data:image/png;base64,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",Oe="data:image/png;base64,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",se=ue(e.jsx("path",{d:"M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5z"}),"NorthEast"),Ue=ue(e.jsx("path",{d:"M15 19v-2H8.41L20 5.41 18.59 4 7 15.59V9H5v10z"}),"SouthWest"),Te="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAAfCAYAAAAfrhY5AAAACXBIWXMAABCcAAAQnAEmzTo0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAIcSURBVHgB7VfbUQIxFD0RR/1cKxA7sAT9xXGQCoQK0AqECqQDoAJGGdA/sALoADqAXx0FzyVZiWEXAssMfnBmstnc7Obc195kgR1C+TzUAIIjIP0JjHPAUGSvHE+BKm8v2SoZ4AFrYiW5IenwNm1eKLGrW7IxW8Bx7RooYA0cwJNYFmc/ZF9i6xlZ+QM4Z9+nUvmWViw5uUNcFqu+55YFRlaScKi5V/pICiFuAwO2aWhNlIz9BccjI8tjG+BitaTEMv8GFDnfkWfYntxnVAy5uPtS4nnCG8f9JVlYaZm4v3Ct8wFNvsM43nLuTubcdTMOX1zMn+VyTAJf4heSpijnXBFa4ZrM04BTDrtRJIdRQmpYaelEChdaSixIGUvDZ/HXk/AmN5mejSMOLbFjrXSxEZzZcn4hY64RRMVXxRDHuhoJ4MZ8wfIJtVbxxGLFJmX0EaYWLCVXulwKsszerpqVdk0szY6zL9o6+9OufCHbJdnY1Ul6kbKSC3OlZhCPNKwwyNieb85zIBaRn1pGJ0xd7t2sDhemcj2W1nt73Dbj8LNbVfVia7soIN/oOm6eGk+kPBNz6a6Wc1y9bRxgh9iT78n35P+X/EufUocsqQOzyNgeT/SPhciSn2YF5gA5wgYID5GufB3L39mCcPPwhdndpHXdOa9/NYE54cifyu8xahXM8Wm21fI4dXXjvOdNbilQhcdebaFL4vJNhMI/3ZTVcKQqeWcAAAAASUVORK5CYII=",te="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAATCAYAAAB2pebxAAAACXBIWXMAABCcAAAQnAEmzTo0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACqSURBVHgB7ZTBCcMwDEUt1b13kAQ6QjJCR+kkHakZoRBy7wi9l8i1DwXF6JuE5JBDPthYQnrIQjY5oG/fN5b/XNdd7iOUwMxPCyIirQkZhyG4FfJpCyF0RNT8z3MSzfhUzZKKdDyjoNQn3avc1vIIohpLlj2JdRvogOwZAuckH//Sc4AQX1VtyS5C0GiXpCGvuK7oHwF6TyAx+TaKPOLlL7PSiT4n5ns6/gCMkEutEIPmAwAAAABJRU5ErkJggg==",Ye=({row:c})=>{const[o,y]=t.useState({labelName:c.name||"",shortcutKey:c.shortcut_key||"",colorCode:c.color_code||"#EEE"}),[D,f]=t.useState(!1),C=async()=>{try{const r={name:o.labelName,shortcut_key:o.shortcutKey.toUpperCase(),color_code:o.colorCode,is_active:!0};f(!0),c.id?(await V.put(`http://localhost:8000/api/label/${c.id}/`,r),alert("Label updated successfully!")):(await V.post("http://localhost:8000/api/label/",r),alert("Label added successfully!"))}catch(r){console.error("Error saving label:",r),alert("Failed to save label")}finally{f(!1)}};return e.jsx(ae,{title:c.id?"Update Label":"Add New Label",description:e.jsxs("form",{onSubmit:r=>r.preventDefault(),children:[e.jsx("input",{type:"text",className:"w-full px-2 py-1 border rounded-full mb-2",placeholder:"Label name",value:o.labelName,onChange:r=>y({...o,labelName:r.target.value})}),e.jsx("input",{type:"text",className:"w-full px-2 py-1 border rounded-full mb-2",placeholder:"Shortcut Key (e.g., G)",value:o.shortcutKey,onChange:r=>y({...o,shortcutKey:r.target.value})}),e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium mb-2",children:["Select color:",e.jsx("input",{type:"color",className:"h-8 w-10 rounded-full border",value:o.colorCode,onChange:r=>y({...o,colorCode:r.target.value})})]})]}),onConfirm:C,isLoading:D,children:e.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white hover:bg-blue-700 rounded-full",children:c.id?"Edit":"Add"})})},Le=({row:c})=>{const[o,y]=t.useState(!1),D=async()=>{y(!0);try{await V.delete(`http://localhost:8000/api/label/${c.id}/`,{headers:{accept:"application/json"}}),alert("Label deleted successfully!")}catch(f){console.error("Error deleting label:",f),alert("Failed to delete label.")}finally{y(!1)}};return e.jsx(ae,{title:"Delete Label",description:`Are you sure you want to delete the label "${c.name}"?`,onConfirm:D,isLoading:o,children:e.jsxs("button",{className:"px-3 py-1 bg-red-600 text-white flex justify-center items-center gap-4 hover:bg-red-700 rounded-full",children:["Delete ",e.jsx("img",{src:te,alt:"Delete",className:"w-4 h-4"})]})})},Qe=(c,o,y,D,f)=>[{key:"color_code",id:"color_code",name:"Color",cell:(C,r)=>{const b=r.color_code,j=b.startsWith("#")?b.slice(1):b,Q=j.length===3?j.split("").map(P=>P+P).join(""):j,z=parseInt(Q.substring(0,2),16),T=parseInt(Q.substring(2,4),16),J=parseInt(Q.substring(4,6),16),G=(z*299+T*587+J*114)/1e3>150?"text-black":"text-white";return e.jsx("button",{className:`px-3 py-1 rounded-full border ${G}`,style:{backgroundColor:b},children:b})}},{key:"name",id:"name",name:"Label Name"},{key:"shortcut_key",id:"shortcut_key",name:"Key assigned"},{key:"view",id:"view",name:"",cell:(C,r)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ye,{row:r}),e.jsx(Le,{row:r})]})}],me=[{partner_id:"62940e36-c368-43f8-b978-4111223a1cac",hashed_key:"befb8eadb0fac508d695b7395ec10543m8ctxoh9",role_id:"cdadd7a8-a04a-40ba-a5b3-2b1bf6d788c8",email:"reach2tayib@gmail.com",first_name:"Mohammed",last_name:"Tayib",api_key:"7b4d9b49-1794-4a91-826a-749cf0d8a87a",is_active:!1,business_type:"large_enterprise",created_by:"4b9517bd-692b-459d-b39f-0c6147a67e31",updated_by:null,products:[{id:"80185a93-7242-4680-8922-297d85dfbd2d",name:"Card"}]},{partner_id:"27644155-4cc2-4541-93ea-babd214d7df3",hashed_key:"4f0440dc0a6d253296aff77f4566d9d8m8ctn5re",role_id:"cdadd7a8-a04a-40ba-a5b3-2b1bf6d788c8",email:"sana@gmail.com",first_name:"Sana",last_name:"G",api_key:"eccc2215-82b7-46be-a418-fb2d997224e6",is_active:!0,business_type:"large_enterprise",created_by:null,updated_by:null,products:[]},{partner_id:"274a5724-5e98-49ff-90fe-0a0fd49f6dff",hashed_key:"bbce159e39b5e7ea1096fc42ebfeff03m85s76dn",role_id:"cdadd7a8-a04a-40ba-a5b3-2b1bf6d788c8",email:"contact2tayib@gmail.com",first_name:"Mohammed",last_name:"Tayibulla",api_key:"41dc8bcf-dff0-4152-a11a-49183559bd31",is_active:!0,business_type:"large_enterprise",created_by:null,updated_by:null,products:[]}],ze=({skuId:c,refreshKey:o})=>{const{setTitle:y}=Ae();xe(),t.useEffect(()=>{y("")},[y]);const[D,f]=t.useState([]),C=t.useMemo(()=>({sku:c}),[]),{data:r=[],fetchData:b}=ye("NUSERS.SKU.LABEL_LIST",C);console.log("usersData 28",r),t.useEffect(()=>{b()},[o,b]),t.useEffect(()=>{},[r]);const j=fe({endpoint:ce.NUSERS.USER.LIST,initialPageSize:10,initialData:me,dataPath:"transactions",totalRecordsPath:"totalRecords"});je({endpoint:ce.NUSERS.USER.LIST,initialData:me,baseQueryParams:{}});const[Q,z]=t.useState({}),[T,J]=t.useState({}),W=Qe(),G=j.loading,P=j.error,K=j.totalRecords||0;return console.log(r),t.useEffect(()=>{r&&Array.isArray(r==null?void 0:r.results)&&f(r==null?void 0:r.results)},[r]),e.jsx("div",{className:"flex flex-col py-4",children:e.jsx(be,{columns:W,data:r&&r.length>0?r:D,defaultSortColumn:"niumId",defaultSortDirection:"asc",loading:G,refreshAction:{isRefreshButtonVisible:!1,isLoading:G,hasError:P},paginationMode:"static",onPageChange:async(X,Z)=>[],totalRecords:K})})},q="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG4AAABWCAYAAAAucqM7AAAACXBIWXMAABCcAAAQnAEmzTo0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMESURBVHgB7d0/TxRBHMbx3wx70WiIdIr/cvYaeQEmyhugtzBIbWODFCYKJYoJdpSeDYkVWphYcRQWdBIruwWNWOnSyMHezrizMscenGiBsM/u80kudzu5S0i+zMxuNSp4sP5YWTspGMJYq2GZHgyl4jRQNKdeM3ZRJtbrUnFa8DBeStXGv1p/8f1RvxTVx29GRho/ZWOr8+dWetmEmXHXzml5M3pKzpxQfqjSMw9qqWS8XXB7HOP9hnhzwngCGs6pejzYcE6V40GHc6oaD+Y57m96PedZk4xJybSDIHTPrqUJ5/SIV0rpP+Qw/FKZ12PZLCl9K5CS8fEevmtJmaxGVj5vmM516cI5Pl6ZTC9tpa/tznWplsoqYThQDAeK4UAxHCiGA8VwoBgOFMOBYjhQDAeK4UAxHCiGA8VwoBgOFMOBYjhQDAeK4UAxHCiGA8VwoBgOFMOBYjhQDAeK4UAxHCiGA8VwoBgOFMOBYjhQDAeK4UAxHCiGA8VwoBgOFMOBYjhQDAeK4UAxHCiGA8VwoBgOFMOBYjhQDAeK4UAxHCiGA8VwoBgOFMOB0mIl8hcbrXIfJoQs30YpFWlREvoBdxoUFVO+jbXJB22NWfIDbz/FQsWzFhl5v5p0roMgCNM9zi74gfmVNpfLAspHS7e2Zmt6MNTtZ5eafp9z0eaWt4WKw822/ClWotWL7G3ncsqPzy3H3OsKxEVz8XaE8ZPBhvuQhYtnzs+mb0332c26O68281+mY+LOjJtfyd13KDXpP3ae4/q0GvNLpos28nKz+0d0ZNzkufe61bVEKmOn/GzLrvM/qI1/GRKrF9PRAT92+3otfQVyo17Kwx0Lxd9juO2q6ybR2kY8c+Fu/rv7ToE9ObFeT9w52iL1/PjlAS1Xz+rsGEs6XGuR3XfLv8s8j59evL93tOfxvVm8xEyma+qo0HHJzjHP7vp7OPDc5VzAm7JnBtL/YdPnNKX0wul4sxHNXon+9L1/PjDb7X/GmLqSviGhQ6V03w9jtlf7k6R5UKy8X8WBPRteZdGpAAAAAElFTkSuQmCC",Je=_e({name:Re().min(1,"Version name is required").max(100,"Maximum 100 characters allowed"),sku:Fe().nullable().optional()}),Ge=()=>Be({mutationFn:async c=>(console.log(c),(await V.post("http://localhost:8000/api/versions/",c)).data)}),Pe=({sku:c,onSuccess:o,onCancel:y})=>{const D=parseInt(c,10),{mutate:f,isLoading:C}=Ge(),r=De({resolver:Ne(Je),defaultValues:{name:"",sku:D}}),b=j=>{const Q={name:j.name,sku:j.sku};f(Q,{onSuccess:()=>{v.success("Version created successfully"),r.reset(),o==null||o()},onError:z=>{var T,J;console.error("Failed to create version:",z),v.error(`${z instanceof Error?(J=(T=z==null?void 0:z.response)==null?void 0:T.data)==null?void 0:J.message:"Unknown error"}`)}})};return e.jsxs(we,{...r,children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"text-2xl font-secondary font-bold text-[#062393]",children:"Create a New Version"}),e.jsx("div",{className:"text-sm font-secondary font-normal",children:"Fill all the fields"})]}),e.jsxs("form",{onSubmit:r.handleSubmit(b),className:"space-y-6",children:[e.jsx(ve,{control:r.control,name:"name",render:({field:j})=>e.jsxs(Ce,{children:[e.jsx(ke,{children:e.jsx(Se,{...j,placeholder:"Name of Version*",className:"rounded-full w-full"})}),e.jsx(Ie,{})]})}),e.jsx("div",{className:"flex gap-2",children:e.jsx(Ve,{type:"submit",disabled:C,className:"w-full rounded-full",children:C?e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"mr-2 h-4 w-4 animate-spin"}),"Please wait"]}):"Create New Version"})})]})]})},ge=({done:c})=>{const o=t.useRef(null);return t.useEffect(()=>{o.current&&(o.current.style.width=`${c}%`,o.current.style.opacity="1")},[c]),e.jsx("div",{className:"w-[80%] h-[30px] bg-gray-300 rounded-full relative my-2",children:e.jsx("div",{ref:o,className:"h-full rounded-full bg-gradient-to-l from-[#163323] to-[#43996A] text-white flex items-center justify-center text-sm font-medium transition-all duration-1000 ease-in-out opacity-0 min-w-[50px]","data-done":c,children:c>0?`${c}%`:"0%"})})},We=({skuId:c,version:o,skuVersions:y,selectedVersion:D})=>{const[f,C]=t.useState(!1),[r,b]=t.useState(null),[j,Q]=t.useState(0),[z,T]=t.useState(new Set),[J,W]=t.useState([]),[G,P]=t.useState([]),[K,X]=t.useState([]),[Z,le]=t.useState(null),ee=async()=>{var s;try{const m=(s=(await V.get(`http://localhost:8000/api/sku-images-list/?sku_id=${c}&version_id=${o}`)).data.results)==null?void 0:s.map(u=>({id:u.id,name:u.original_filename,url:`http://localhost:8000${u.image}`,label_id:u.label_id||null,label_name:u.label_name||null,label_color_code:u.label_color_code||null}));console.log(m),X(m||[])}catch(l){console.error("Failed to fetch images",l),v.error("Failed to fetch images")}};t.useEffect(()=>{ee()},[c,o]);const x=({title:s,imageUrl:l,onClick:m})=>e.jsxs("div",{onClick:m,className:"border rounded-lg shadow-sm p-4 hover:bg-blue-50 cursor-pointer flex flex-col items-center",children:[e.jsx("img",{src:l,alt:s,className:"w-24 h-24 object-cover rounded mb-2"}),e.jsx("h4",{className:"font-semibold text-lg text-gray-800 text-center",children:s})]}),E=({label:s,min:l,max:m,step:u=1,value:F,onChange:d})=>e.jsxs("div",{className:"my-4",children:[e.jsxs("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:[s,": ",e.jsx("span",{className:"font-bold text-blue-600",children:F})]}),e.jsx("input",{type:"range",min:l,max:m,step:u,value:F,onChange:g=>d(Number(g.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),a=({isOpen:s,onClose:l,title:m,file:u,parameters:F,onUpdate:d})=>{const[g,M]=t.useState({}),[n,U]=t.useState(null),Y={horizontal_flip:{params:["probability"]},vertical_flip:{params:["probability"]},grayscale:{params:["probability"]},rotate:{params:["angle","probability"],configBuilder:i=>({min_angle:-i.angle,max_angle:i.angle,probability:i.probability})},noise:{params:["noise","probability"],configBuilder:i=>({min_noise:i.noise,max_noise:i.noise,probability:i.probability})},blur:{params:["blur","probability"],configBuilder:i=>({min_blur:i.blur,max_blur:i.blur,probability:i.probability})},brightness:{params:["brightness","probability"],configBuilder:i=>({min_brightness:-i.brightness,max_brightness:i.brightness,probability:i.probability})},hue_saturation_value:{params:["hue","saturation","probability"],configBuilder:i=>({min_hue:-i.hue,max_hue:i.hue,min_saturation:-i.saturation,max_saturation:i.saturation,probability:i.probability})},shear:{params:["x_angle","y_angle","probability"],configBuilder:i=>({x_min_angle:-i.x_angle,x_max_angle:i.x_angle,y_min_angle:-i.y_angle,y_max_angle:i.y_angle,probability:i.probability})}};return t.useEffect(()=>{m.toLowerCase().replace(/ /g,"_");const i=F.reduce((R,L)=>({...R,[L.name]:L.default}),{});M(i)},[F,m]),t.useEffect(()=>{if(!u||!s)return;(async()=>{const R=new FormData;R.append("image",u);const L=m.toLowerCase().replace(/ /g,"_");R.append("augmentation_type",L);const N=Y[L]||{params:Object.keys(g)},B=N.configBuilder?N.configBuilder(g):N.params.reduce((w,H)=>({...w,[H]:g[H]}),{});R.append("parameters",JSON.stringify(B));try{const w=await V.post("http://localhost:8001/api/augmentations/single_transform/",R);U(w.data)}catch(w){console.error("Error fetching preview",w),v.error("Failed to fetch preview")}})()},[u,g,s,m]),t.useEffect(()=>{if(s){const i=m.toLowerCase().replace(/ /g,"_"),R=Y[i]||{params:Object.keys(g)},L=R.configBuilder?R.configBuilder(g):R.params.reduce((B,w)=>({...B,[w]:g[w]}),{});d({augmentation_type:i,parameters:L})}},[g,s,m,d]),s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg w-[90%] max-w-xl relative",children:[e.jsx("button",{className:"absolute top-2 right-2 text-gray-600",onClick:l,children:"✕"}),e.jsx("h2",{className:"text-xl font-semibold mb-4",children:m}),e.jsx("div",{className:"mb-4",children:F.map(i=>e.jsx(E,{label:i.name.replace(/_/g," ").replace(/\b\w/g,R=>R.toUpperCase()),min:0,max:Math.abs(i.range[1]),step:i.step,value:g[i.name]??i.default,onChange:R=>M(L=>({...L,[i.name]:R}))},i.name))}),n&&e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Original"}),e.jsx("img",{src:`data:image/jpeg;base64,${n.original_image}`,className:"w-40 h-28 object-cover rounded",alt:"Original"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Augmented"}),e.jsx("img",{src:`data:image/jpeg;base64,${n.augmented_image}`,className:"w-40 h-28 object-cover rounded",alt:"Augmented"})]})]})]})}):null},S=()=>{var L;const[s,l]=t.useState(null),[m,u]=t.useState(null),[F,d]=t.useState({}),[g,M]=t.useState([]),[n,U]=t.useState(null);console.log(K);const Y=(L=K[0])==null?void 0:L.url;t.useEffect(()=>{(async()=>{if(Y)try{const w=await(await fetch(Y)).blob(),H=new File([w],"first-image.jpg",{type:w.type});l(H)}catch(B){console.error("Failed to fetch image as file",B)}})()},[Y]),t.useEffect(()=>{(async()=>{try{const w=(await V.get("http://localhost:8001/api/augmentations/list_transform/")).data.augmentations,H=Object.entries(w).map(([ne,re])=>({key:ne,title:ne.replace(/_/g," ").replace(/\b\w/g,he=>he.toUpperCase()),description:re.description,parameters:JSON.parse(re.parameters)}));M(H)}catch(B){console.error("Failed to fetch augmentation list",B),v.error("Failed to fetch augmentations")}})()},[]);const i=(N,B)=>{d(w=>({...w,[N]:B}))},R=async()=>{if(!s){v.error("Please select an image");return}const N=new FormData;N.append("image",s);const B=Object.values(F).filter(Boolean).map(w=>({augmentation_type:w.augmentation_type,parameters:w.parameters}));N.append("augmentation_config",JSON.stringify(B));try{const w=await V.post("http://localhost:8001/api/augmentations/pipeline_transform/",N);U(w.data),v.success("Augmentations applied successfully")}catch(w){console.error("Error applying augmentations",w),v.error("Failed to apply augmentations")}};return e.jsxs("div",{className:"p-4 max-w-4xl mx-auto",children:[e.jsx("button",{onClick:R,className:"bg-blue-500 text-white py-2 px-4 rounded mb-4",disabled:!s||Object.keys(F).length===0,children:"Apply All Augmentations"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:g.map(({key:N,title:B})=>e.jsx(x,{title:B,imageUrl:`/media/${N}.png`,onClick:()=>u(N)},N))}),g.map(N=>e.jsx(a,{isOpen:m===N.key,onClose:()=>u(null),title:N.title,file:s,parameters:N.parameters,onUpdate:B=>i(N.key,B)},N.key)),n&&e.jsxs("div",{className:"flex gap-4 mt-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Original"}),e.jsx("img",{src:`data:image/jpeg;base64,${n.original_image}`,className:"w-40 h-28 object-cover rounded",alt:"Original"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Augmented"}),e.jsx("img",{src:`data:image/jpeg;base64,${n.augmented_image}`,className:"w-40 h-28 object-cover rounded",alt:"Augmented"})]})]})]})},_=[{label:"Select versions",component:()=>e.jsx("div",{className:"p-4 bg-gray-100 rounded-lg w-full text-green-600",children:e.jsx("div",{className:"flex flex-col rounded-lg p-4 shadow-md gap-3 mb-2 bg-white max-h-96 overflow-y-scroll",children:!D&&y.map(s=>e.jsxs("div",{className:"bg-white flex justify-center flex-col p-4 m-2 shadow-md rounded-lg text-center cursor-pointer",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex gap-4 items-center justify-center",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-500",checked:G.includes(s.name),onChange:l=>{l.target.checked?(W(m=>[...m,s.id]),P(m=>[...m,s.name])):(W(m=>m.filter(u=>u!==s.id)),P(m=>m.filter(u=>u!==s.name)))}}),e.jsx("img",{src:q,alt:"",className:"w-4 h-4"}),e.jsx("h4",{className:"text-base font-medium",children:s.name})]}),e.jsxs("div",{className:"text-blue-500 font-semibold",children:[s.total_image_count," images ",e.jsx(se,{className:"w-5 h-5",fontSize:"small"})]})]}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(ge,{done:s.total_image_count>0?Math.round(s.labeled_image_count/s.total_image_count*100):0})}),e.jsxs("div",{className:"flex gap-6 items-center justify-center px-2",children:[e.jsxs("div",{className:"text-blue-500 font-semibold",children:["Annotated : ",s==null?void 0:s.labeled_image_count]}),e.jsxs("div",{className:"text-yellow-500 font-semibold",children:["Unannotated : ",s==null?void 0:s.unlabeled_image_count]}),e.jsxs("div",{className:"text-red-500 font-semibold",children:["Rejected : ",(s==null?void 0:s.rejected)||0]})]})]},s.id))})})},{label:"Select pre-processing methods",component:()=>e.jsx("div",{className:"p-4 bg-gray-100 rounded-lg w-full text-green-600",children:e.jsxs("div",{className:"flex flex-col rounded-lg p-4 shadow-md gap-3 mb-2 bg-white max-h-96 overflow-y-scroll",children:[e.jsx("p",{className:" text-green-600 font-semibold text-xl",children:"Pre-processing Methods"}),e.jsx(S,{})]})})},{label:"Select Augmentaions",component:()=>e.jsx("div",{className:"p-4 bg-gray-100 rounded-lg w-full text-green-600",children:e.jsxs("div",{className:"flex flex-col rounded-lg p-4 shadow-md gap-3 mb-2 bg-white max-h-96 overflow-y-scroll",children:[e.jsx("p",{className:" text-green-600 font-semibold text-xl",children:"Select Augmentaions"}),e.jsx(S,{})]})})},{label:"Select AI model",component:()=>e.jsx("div",{className:"p-4 bg-gray-100 rounded-lg w-full text-green-600",children:[1,2,3].map((s,l)=>e.jsxs("div",{className:"bg-white flex justify-center flex-col p-4 shadow-md border-[1px] rounded-lg text-center cursor-pointer w-full my-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"flex gap-4 items-center",children:e.jsxs("h4",{className:"font-medium",children:["Model ",l]})}),e.jsx("div",{className:"bg-blue-500 text-white rounded-full px-4 py-2font-semibold",children:"recommended"})]}),e.jsx("div",{className:"flex text-gray-400",children:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Nesciunt illum natus optio esse vero corrupti."})]},l))})},{label:"Start training",component:()=>e.jsxs("div",{className:"flex flex-col gap-4 items-center justify-center",children:[e.jsx("div",{className:"text-blue-600 flex text-5xl font-bold",children:"Train"}),e.jsx("div",{className:"flex items-center text-center text-green-600 text-lg font-semibold",children:"ML model training"})]})}],I=[{label:"Upload test data",component:()=>e.jsx("div",{className:"p-4 bg-gray-100 rounded-lg w-full text-blue-600",children:e.jsx("p",{children:"Testing: Upload Test Data"})})},{label:"Select model version",component:()=>e.jsx("div",{className:"p-4 bg-gray-100 rounded-lg w-full text-blue-600",children:e.jsx("p",{children:"Testing: Select Model Version"})})},{label:"Run tests and evaluate",component:()=>e.jsx("div",{className:"p-4 bg-gray-100 rounded-lg w-full text-blue-600",children:e.jsx("p",{children:"Testing: Run & Evaluate"})})}],h=r==="training"?_:r==="testing"?I:[],O=()=>{C(!0),b(null),Q(0),T(new Set)},k=()=>{C(!1),b(null),Q(0),T(new Set)},p=()=>{j<h.length-1&&Q(s=>s+1)};return e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:O,className:"bg-primary hover:bg-green-600 text-white py-2 px-4 rounded-full flex items-center gap-2",children:"New Performance Evaluation"})}),e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex flex-col rounded-lg p-4 shadow-md gap-3 my-4 bg-white min-h-[540px]",children:[e.jsxs("div",{className:"flex justify-between items-center px-4",children:[e.jsx("h1",{className:"text-blue-500 font-semibold text-md",children:"Recent Executions"}),e.jsx("button",{className:"px-4 py-1 bg-blue-600 text-white hover:bg-blue-500 rounded-full",children:"See all reports"})]}),[1,2,3].map((s,l)=>e.jsx("div",{className:"bg-white flex justify-center flex-col p-4 shadow-md border-[1px] rounded-lg text-center cursor-pointer w-full",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"flex gap-4 items-center",children:e.jsx("h4",{className:"font-medium",children:"PE-21 MAY 2025, 12:02:44PM"})}),e.jsx("div",{className:"font-semibold",children:"Execution time : 17 mins 38 secs"}),e.jsxs("div",{className:"text-blue-500 font-semibold",children:["View full report ",e.jsx(se,{className:"text-green-600",fontSize:"small"})]})]})},l))]})}),f&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:k}),e.jsxs("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[600px] bg-white shadow-lg rounded-lg p-6 z-50",children:[e.jsx("button",{onClick:k,className:"absolute top-4 right-4 text-green-600 hover:text-green-800",children:"✕"}),r?e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsx("div",{className:"absolute top-5 left-[6.5%] right-[6.5%] h-1 bg-gray-300 z-0 w-[84%]"}),e.jsx("div",{className:"absolute top-5 left-[6.5%] h-1 bg-green-600 z-10 transition-all duration-300",style:{width:`${Math.min(j/(h.length-1)*90,90)}%`}}),e.jsx("div",{className:"flex justify-between items-start relative z-10",children:h.map((s,l)=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center border-2 text-sm font-medium 
                            ${l<=j?"bg-green-600 border-green-600 text-white":"bg-white border-gray-300 text-gray-500"}`,children:l+1}),e.jsx("span",{className:"text-xs mt-2 text-center max-w-[140px]",children:s.label})]},l))})]}),j<h.length&&e.jsx("div",{className:"mt-4 w-full",children:h[j].component()}),e.jsx("div",{className:"flex flex-col pt-4",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col gap-2 items-center justify-center",children:[j<h.length-1&&e.jsx("button",{onClick:p,className:"w-48 m-2 py-2 px-4 rounded-full gap-2 text-white bg-primary hover:bg-green-600",children:j===h.length-1?"Start":"Next"}),j===h.length-1?e.jsx(e.Fragment,{}):e.jsxs("div",{className:"text-sm text-center",children:[e.jsx("span",{className:"font-semibold",children:"Disclaimer: "}),e.jsx("span",{className:"",children:"Proceeding to the next step may finalize your current choices. Please review your inputs carefully. Changes might not be possible later."})]})]})})})]}):e.jsxs("div",{className:"flex flex-col gap-4 items-center p-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 items-center justify-center",children:[e.jsx("div",{className:"text-blue-600 flex text-5xl font-bold",children:"Train"}),e.jsx("div",{className:"flex items-center text-center",children:"Got fresh data? Let’s teach your model how to make smart decisions. Select your annotations and start training!"}),e.jsx("button",{onClick:()=>b("training"),className:"bg-primary hover:bg-green-600 text-white py-2 px-4 rounded-full flex items-center gap-2",children:"Start Training"})]}),e.jsx("div",{className:"bg-black h-[1px] my-4 w-full"}),e.jsxs("div",{className:"flex flex-col gap-4 items-center justify-center",children:[e.jsx("div",{className:"text-blue-600 flex text-5xl font-bold",children:"Test"}),e.jsx("div",{className:"flex items-center text-center",children:"Already have a model? Let’s see how well it performs. Run it on test data and check the results."}),e.jsx("button",{onClick:()=>b("testing"),className:"bg-primary hover:bg-green-600 text-white py-2 px-4 rounded-full flex items-center gap-2",children:"Start Testing"})]})]})]})]})]})},$=window.electronAPI||null,Ke=async(c,o)=>{if(!$)return console.error("Electron API not available"),{success:!1,error:"Electron not available"};try{return await $.openTerminal({title:c,command:o})}catch(y){return console.error("IPC error:",y),{success:!1,error:y.message}}},He=async()=>{if(!$)return console.error("Electron API not available"),{success:!1,error:"Electron not available"};try{return await $.closeTerminal()}catch(c){return console.error("IPC error:",c),{success:!1,error:c.message}}},Xe=()=>{const[c,o]=t.useState(!1),y=async()=>{const r=await Ke("Nexify Command Terminal","python --version & echo Done");r.success?(o(!0),console.log("Terminal opened, PID:",r.pid)):console.error("Failed to open terminal:",r.error)},D=async()=>{const f=await He();f.success?(o(!1),console.log("Terminal closed")):console.error("Failed to close terminal:",f.error)};return e.jsxs("div",{children:[e.jsx("h2",{children:"Terminal Control"}),e.jsx("button",{onClick:y,disabled:c,children:"Open Terminal"}),e.jsx("button",{onClick:D,disabled:!c,style:{marginLeft:"10px"},children:"Close Terminal"})]})},os=()=>{const{workspaceId:c,skuId:o}=pe(),[y,D]=ie(),f=y.get("version"),C=y.get("tab")||"Versions",r=xe(),[b,j]=t.useState([]),[Q,z]=t.useState([]),[T,J]=t.useState(f),W=async()=>{try{const x=await V.get(`http://localhost:8000/api/sku/${o}/`);z(x.data.results||[])}catch(x){console.error("Error fetching versions:",x)}},G=async()=>{try{const x=await V.get(`http://localhost:8000/api/versions/?sku=${o}`);j(x.data.results||[])}catch(x){console.error("Error fetching versions:",x)}};t.useEffect(()=>{W(),G()},[o]),t.useEffect(()=>{J(f)},[f]);const P=t.memo(({sku:x})=>{const[E,a]=t.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>a(!0),className:"text-white px-4 py-2 bg-blue-600 hover:bg-blue-500 text-sm rounded-full transition",children:"Create Version"}),e.jsx(de,{title:"",description:e.jsx(Pe,{sku:x,onSuccess:()=>{G(),a(!1)},onCancel:()=>a(!1)}),hideFooter:!0,open:E,onOpenChange:a})]})}),K=({skuId:x})=>{const[E,a]=t.useState(null),[S,_]=ie(),[I,A]=t.useState(!1),[h,O]=t.useState([]),[k,p]=t.useState(!1),[s,l]=t.useState({source_version_id:null,target_version_id:null,overwrite:!1,skip_duplicates:!0,delete_source:!1}),m=n=>{O(U=>U.includes(n)?U.filter(Y=>Y!==n):[...U,n])},u=()=>{if(h.length<2){alert("Please select at least two versions to merge.");return}p(!0)},F=async()=>{if(h.length===0){alert("Please select at least one version to delete.");return}try{for(const n of h)await V.delete(`http://localhost:8000/api/versions/${n}/`,{headers:{accept:"application/json"}});console.log("Deleted versions:",h),O([]),G(),v.success("deleted version"),A(!1)}catch(n){console.error("Delete failed:",n),alert("Failed to delete one or more versions.")}},d=()=>{A(!1),O([])},g=async()=>{if(!s.source_version_id||!s.target_version_id){alert("Please select source and target versions.");return}try{const n=await V.post("http://localhost:8000/api/sku-images/merge-versions/",{source_version_id:parseInt(s.source_version_id),target_version_id:parseInt(s.target_version_id),sku_id:parseInt(x),overwrite:s.overwrite,skip_duplicates:s.skip_duplicates,delete_source:s.delete_source},{headers:{accept:"application/json","Content-Type":"application/json"}});console.log("Merge successful:",n.data),p(!1),O([]),A(!1)}catch(n){console.error("Merge failed:",n),alert("Failed to merge versions.")}},M=()=>{p(!1)};return e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"flex gap-16 justify-end items-end mb-2",children:e.jsx(P,{sku:x})}),e.jsxs("div",{className:"flex items-center p-2 justify-between bg-gray-200 rounded-full mb-2",children:[k&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg w-[90%] max-w-md relative",children:[e.jsx("button",{className:"absolute top-2 right-2 text-gray-600",onClick:M,children:"✕"}),e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Merge Versions"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Source Version"}),e.jsxs("select",{className:"w-full p-2 border rounded",value:s.source_version_id||"",onChange:n=>l({...s,source_version_id:n.target.value}),children:[e.jsx("option",{value:"",disabled:!0,children:"Select Source Version"}),h.map(n=>{const U=b.find(Y=>Y.id===n);return e.jsx("option",{value:n,children:U.name},n)})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Target Version"}),e.jsxs("select",{className:"w-full p-2 border rounded",value:s.target_version_id||"",onChange:n=>l({...s,target_version_id:n.target.value}),children:[e.jsx("option",{value:"",disabled:!0,children:"Select Target Version"}),h.map(n=>{const U=b.find(Y=>Y.id===n);return e.jsx("option",{value:n,children:U.name},n)})]})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s.overwrite,onChange:n=>l({...s,overwrite:n.target.checked})}),"Overwrite"]})}),e.jsx("div",{className:"mb-4",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s.skip_duplicates,onChange:n=>l({...s,skip_duplicates:n.target.checked})}),"Skip Duplicates"]})}),e.jsx("div",{className:"mb-4",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s.delete_source,onChange:n=>l({...s,delete_source:n.target.checked})}),"Delete Source"]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white hover:bg-blue-700 rounded-full",onClick:g,children:"Confirm Merge"}),e.jsx("button",{className:"px-3 py-1 bg-gray-600 text-white hover:bg-gray-700 rounded-full",onClick:M,children:"Cancel"})]})]})}),e.jsxs("div",{className:"px-4 font-semibold",children:["Total Versions : ",b.length," "]}),I?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white hover:bg-blue-700 rounded-full",onClick:u,children:"Merge Version"}),e.jsx("button",{className:"px-3 py-1 bg-red-600 text-white hover:bg-red-700 rounded-full",onClick:F,children:"Delete Version"}),e.jsx("button",{className:"px-3 py-1 bg-gray-600 text-white hover:bg-gray-700 rounded-full",onClick:d,children:"Back"})]}):e.jsxs("button",{className:"px-3 py-1 bg-red-600 text-white flex justify-center items-center gap-4 hover:bg-red-700 rounded-full",onClick:()=>A(!0),children:["Bulk Version Edit ",e.jsx("img",{src:te,alt:"Delete",className:"w-4 h-4"})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:b.map(n=>e.jsxs("div",{onClick:()=>!I&&(a(n.id),_({tab:"SKU data",version:n.id})),className:`flex items-center justify-center flex-col gap-2 p-3 text-center rounded-lg shadow hover:bg-gray-100 cursor-pointer relative ${h.includes(n.id)?"bg-blue-100 border-2 border-blue-600":""} ${I?"cursor-default":""}`,children:[I&&e.jsx("input",{type:"checkbox",checked:h.includes(n.id),onChange:()=>m(n.id),className:"absolute top-2 left-2",onClick:U=>U.stopPropagation()}),e.jsx("img",{src:q,alt:"",className:"w-8 h-8"}),e.jsx("h4",{className:"text-base font-medium",children:n.name})]},n.id))}),E&&C==="SKU data"&&e.jsx("div",{className:"p-4 border rounded-lg shadow bg-gray-100",children:e.jsx(Z,{skuId:x,version:E})})]})},X=({skuId:x})=>{console.log("skuId",x);const E=async a=>{var S;try{const I=(S=(await V.get(`http://localhost:8000/api/sku-images-list/?sku_id=${x}&version_id=${a}`)).data.results)==null?void 0:S.map(A=>({id:A.id,name:A.original_filename,url:`http://localhost:8000${A.image}`}));if(I&&I.length>0){J(a);const A=I[0].id;r(`/client/workspaces/${c}/sku/${x}/image/${A}?tab=Annotate&version=${a}`)}else J(""),v.error("No images to display for this version")}catch(_){console.error("Failed to fetch images",_),v.error("Failed to fetch images")}};return e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"flex flex-col rounded-lg p-4 shadow-md gap-3 mb-2 bg-white",children:[e.jsx("h1",{className:"text-[#43996A] font-bold text-center justify-center items-center text-xl",children:"Versions"}),!T&&b.map(a=>e.jsxs("div",{onClick:()=>{E(a.id)},className:"bg-white flex justify-center flex-col p-4 m-2 shadow-md hover:bg-slate-100 rounded-lg text-center cursor-pointer",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex gap-4 items-center justify-center",children:[e.jsx("img",{src:q,alt:"",className:"w-4 h-4"}),e.jsx("h4",{className:"text-base font-medium",children:a.name})]}),e.jsxs("div",{className:"text-blue-500 font-semibold",children:[a.total_image_count," images ",e.jsx(se,{className:"w-5 h-5",fontSize:"small"})]})]}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(ge,{done:a.total_image_count>0?Math.round(a.labeled_image_count/a.total_image_count*100):0})}),e.jsxs("div",{className:"flex flex-col gap-1 items-start justify-start px-12",children:[e.jsxs("div",{className:"text-blue-500 font-semibold",children:["Annotated : ",a==null?void 0:a.labeled_image_count]}),e.jsxs("div",{className:"text-yellow-500 font-semibold",children:["Unannotated : ",a==null?void 0:a.unlabeled_image_count]}),e.jsxs("div",{className:"text-red-500 font-semibold",children:["Rejected : ",(a==null?void 0:a.rejected)||0]})]})]},a.id))]}),e.jsxs("div",{className:"flex flex-col rounded-lg p-4 shadow-md gap-3 mb-2 bg-white",children:[e.jsx("h1",{className:"text-[#43996A] font-bold text-center justify-center items-center text-xl",children:"Datasets"}),!T&&b.map(a=>e.jsx("div",{className:"bg-white flex justify-center flex-col gap-2 p-4 m-2 shadow-md hover:bg-slate-100 rounded-lg text-center cursor-pointer",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex gap-4 items-center justify-center",children:[e.jsx("img",{src:q,alt:"",className:"w-4 h-4"}),e.jsx("h4",{className:"text-base font-medium",children:a.name})]}),e.jsx("div",{className:"text-[#43996A] font-semibold",children:e.jsx(Ue,{className:"w-5 h-5",fontSize:"small"})})]})},a.id))]})]})})},Z=({skuId:x,version:E})=>{const[a,S]=t.useState([]),[_,I]=t.useState([]),[A,h]=t.useState(null),O=async()=>{var d;try{const M=(d=(await V.get(`http://localhost:8000/api/sku-images-list/?sku_id=${x}&version_id=${E}`)).data.results)==null?void 0:d.map(n=>({id:n.id,name:n.original_filename,url:`http://localhost:8000${n.image}`}));S(M||[])}catch(g){console.error("Failed to fetch images",g)}};t.useEffect(()=>{O()},[x,E]);const k=d=>{I(g=>g.includes(d)?g.filter(M=>M!==d):[...g,d])},p=async d=>{if(window.confirm("Are you sure you want to delete this image?"))try{await V.delete("http://localhost:8000/api/sku-images/",{data:{image_ids:[d]}}),v.success("Image deleted successfully"),O()}catch{v.error("Failed to delete image")}},s=async()=>{if(_.length===0){v.error("Please select images to delete.");return}if(window.confirm(`Are you sure you want to delete ${_.length} image(s)?`))try{await V.delete("http://localhost:8000/api/sku-images/",{data:{image_ids:_}}),v.success("Images deleted successfully"),O(),I([])}catch{v.error("Failed to delete images")}},l=t.memo(({id:d,src:g,alt:M})=>e.jsx(de,{title:"",description:e.jsxs(e.Fragment,{children:[e.jsx("img",{src:g,alt:M,className:"w-full h-auto max-h-[80vh] object-contain rounded"}),e.jsx("h1",{children:M})]}),children:e.jsx("button",{className:"bg-green-500 text-white text-xs px-3 py-1 rounded shadow",children:"Preview"})})),m=()=>{h(d=>(d+1)%a.length)},u=()=>{h(d=>(d-1+a.length)%a.length)},F=()=>{h(null)};return e.jsxs(e.Fragment,{children:[A!==null&&a.length>0&&e.jsxs("div",{className:"relative bg-gray-900 p-4 rounded-lg mb-4 flex items-center justify-center",children:[e.jsx("button",{onClick:F,className:"absolute top-2 right-2 text-white text-lg font-bold",children:"×"}),e.jsx("button",{onClick:u,className:"absolute left-4 text-white text-2xl font-bold",disabled:a.length<=1,children:"←"}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("img",{src:a[A].url,alt:a[A].name,className:"max-w-full max-h-[60vh] object-contain rounded"}),e.jsx("h1",{className:"text-white text-lg mt-2",children:a[A].name})]}),e.jsx("button",{onClick:m,className:"absolute right-4 text-white text-2xl font-bold",disabled:a.length<=1,children:"→"})]}),e.jsx("div",{className:"flex gap-16 justify-end items-end mb-2",children:e.jsx("button",{onClick:()=>D({tab:"upload",version:E}),className:"text-white text-md font-semibold bg-blue-600 rounded-full py-1 px-3 min-w-36",children:"Upload Files"})}),e.jsxs("div",{className:"flex items-center p-2 justify-between bg-gray-200 rounded-full",children:[e.jsxs("div",{className:"px-4 font-semibold",children:["Uploaded files: ",a.length]}),e.jsxs("button",{onClick:s,className:"px-3 py-1 bg-red-600 text-white flex justify-center items-center gap-4 hover:bg-red-700 rounded-full",children:["Bulk Delete ",e.jsx("img",{src:te,alt:"Delete",className:"w-4 h-4"})]})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4 p-4",children:a.map(d=>e.jsxs("div",{className:"border rounded group p-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:d.url,alt:d.name,className:"w-full h-28 object-fill rounded mb-2"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(l,{id:d.id,src:d.url,alt:d.name}),e.jsx("button",{onClick:()=>p(d.id),className:"bg-red-500 text-white text-xs px-3 py-1 rounded shadow",children:"Delete"})]})})]}),e.jsxs("div",{className:"flex gap-6 px-2 py-1 text-xs bg-white",children:[e.jsx("input",{type:"checkbox",checked:_.includes(d.id),onChange:()=>k(d.id)}),e.jsx("span",{className:"cursor-pointer text-black truncate w-28",title:d.name,children:d.name})]})]},d.id))})]})},le=({skuId:x,version:E,tags:a})=>{const[S,_]=t.useState([]),[I,A]=t.useState(oe),h=p=>{if(!p)return;const s=Array.from(p).filter(l=>["image/jpeg","image/jpg","image/png","image/bmp"].includes(l.type)).map(l=>({file:l,name:l.name,preview:URL.createObjectURL(l)}));_(l=>[...l,...s])},O=p=>{_(s=>{const l=s.filter((m,u)=>u!==p);return s[p].preview===I&&A(oe),l})},k=async(p=!1,s=!1)=>{var m;if(S.length===0){v.error("No images to upload");return}const l=new FormData;S.forEach(({file:u})=>l.append("images",u)),l.append("sku_id",x),l.append("tags",a),l.append("version_name",E),l.append("version_id",E),l.append("allow_duplicates",p.toString()),l.append("overwrite",s.toString());try{const u=await V.post("http://localhost:8000/api/sku-images/",l);((m=u.data.skipped)==null?void 0:m.length)>0&&u.data.skipped.some(F=>F.reason.includes("Duplicate"))?window.confirm(`${u.data.skipped.length} image(s) were skipped due to duplication.
Would you like to re-upload with overwrite?`)?await k(!0,!0):v.error("Upload skipped for duplicate images."):(v.success("Upload successful!"),D({tab:"SKU data",version:E}))}catch{v.error("Upload failed.")}};return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Upload SKU Data"}),e.jsx("button",{onClick:k,className:"bg-blue-600 rounded-full text-white px-6 py-2",children:"Save"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"border-2 rounded-md border-dashed border-green-400 p-6 flex flex-col items-center justify-center",children:[e.jsx("img",{src:Me,alt:"Camera Icon",className:"w-16 h-16 mb-2"}),e.jsx("button",{className:"bg-green-200 px-4 py-2 rounded",children:"Load from Indus Vision camera"}),e.jsx(Xe,{})]}),e.jsxs("div",{className:"border-2 border-dashed rounded-md border-blue-400 p-6 text-center flex items-center justify-center",children:[e.jsx("input",{type:"file",accept:".jpg,.jpeg,.png,.bmp",multiple:!0,className:"hidden",id:"fileInput",onChange:p=>h(p.target.files)}),e.jsxs("label",{htmlFor:"fileInput",className:"cursor-pointer flex flex-col justify-center items-center",children:[e.jsx("img",{src:Oe,alt:"Upload Icon",className:"mb-4 w-24 h-24"}),e.jsx("div",{className:"text-white text-lg font-semibold bg-blue-600 rounded-full p-2",children:"Click to upload files from device"}),e.jsx("div",{className:"text-md text-gray-500 mt-1",children:"or drag and drop files here"}),e.jsxs("div",{className:"text-md mt-1",children:[e.jsx("span",{className:"text-red-400",children:"*"})," Files supported: .jpeg .jpg .png .bmp"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Uploaded Files"}),S.length===0?e.jsx("div",{className:"text-gray-500 flex justify-center items-center text-lg border p-4 rounded h-64",children:"No files have been uploaded."}):e.jsx("div",{className:"grid gap-4 max-h-96 overflow-y-auto",children:S.map((p,s)=>e.jsxs("div",{className:"px-4 py-2 border rounded shadow-sm flex justify-between items-center bg-gray-100",children:[e.jsx("img",{src:p.preview,alt:`preview-${s}`,className:"w-16 h-16 object-fill rounded cursor-pointer",onClick:()=>A(p.preview)}),e.jsx("div",{children:p.name}),e.jsx("button",{onClick:()=>O(s),title:"Delete",className:"ml-2",children:e.jsx("img",{src:Te,alt:"Delete"})})]},s))})]}),e.jsx("div",{className:"mt-6 flex",children:e.jsx("img",{src:I,alt:"Selected Preview",className:"w-full h-96 object-fill rounded"})})]})]})},ee=({skuId:x,version:E})=>{const[a,S]=t.useState({labelName:"",shortcutKey:"",colorCode:"#EEE"}),[_,I]=t.useState(0),[A,h]=t.useState(!1);t.useEffect(()=>{A||S({labelName:"",shortcutKey:"",colorCode:"#EEE"})},[A]);const O=async()=>{var k,p;try{await V.post("http://localhost:8000/api/label/",{name:a.labelName,sku_id:x,shortcut_key:a.shortcutKey.toUpperCase(),color_code:a.colorCode,is_active:!0}),v.success("Label added successfully!"),S({labelName:"",shortcutKey:"",colorCode:"#EEE"}),I(s=>s+1),h(!1)}catch(s){const l=(p=(k=s==null?void 0:s.response)==null?void 0:k.data)==null?void 0:p.message;console.log(l),v.error(l||"Failed to add label")}};return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(ae,{title:"Add New Labels",description:e.jsx("div",{children:e.jsxs("form",{onSubmit:k=>k.preventDefault(),children:[e.jsx("input",{type:"text",className:"w-full px-2 py-1 border rounded-full my-2",placeholder:"Label name",value:a.labelName,onChange:k=>S({...a,labelName:k.target.value})}),e.jsx("input",{type:"text",className:"w-full px-2 py-1 border rounded-full mb-2",placeholder:"Keyboard Shortcut key (e.g., G)",value:a.shortcutKey,onChange:k=>S({...a,shortcutKey:k.target.value})}),e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium mb-2",children:["Select color:",e.jsx("input",{type:"color",className:"h-8 w-10 rounded-full border",value:a.colorCode,onChange:k=>S({...a,colorCode:k.target.value})})]})]})}),onConfirm:O,open:A,onOpenChange:h,children:e.jsx("div",{className:"flex items-end justify-end",children:e.jsx("button",{className:"w-32 px-3 py-1 bg-blue-600 text-white flex justify-center items-center gap-4 hover:bg-blue-500 rounded-full",children:"Add Labels"})})}),e.jsx(ze,{skuId:x,refreshKey:_})]})};return e.jsxs("div",{className:"p-4",children:[C==="Versions"&&e.jsx(K,{skuId:o}),C==="SKU data"&&e.jsx(Z,{skuId:o,version:f}),C==="upload"&&e.jsx(le,{skuId:o,version:f,tags:"AnamolyDetection"}),C==="Label"&&e.jsx(ee,{skuId:o,version:f}),C==="Annotate"&&e.jsx(X,{skuId:o}),C==="Indus Vision AI"&&e.jsx(We,{skuId:o,version:f,skuVersions:b,selectedVersion:T})]})};export{os as default};

{"version":3,"file":"SecretKeyPage-BNr7_p0l.js","sources":["../../../src/features/auth/hooks/useSecretKey.ts","../../../src/features/auth/schemas/secretkey.schema.ts","../../../src/features/auth/components/SecretKeyForm.tsx","../../../src/features/auth/pages/secret-key/SecretKeyPage.tsx"],"sourcesContent":["import { useMemo } from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\n\r\nimport { UserRole } from \"@/features/auth/types/auth.types\";\r\nimport { RootState } from \"@/store\";\r\nimport { useMutation } from \"@tanstack/react-query\";\r\nimport { useDispatch, } from \"react-redux\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { authApi } from \"../api/authApi\";\r\nimport { setCredentials } from \"../store/authSlice\";\r\nimport { DEFAULT_ROUTES } from \"../../../core/constant/routes\";\r\nimport { toast } from \"sonner\";\r\nimport { SecretKeyResponse } from \"../types/auth.types\";\r\nimport type { SecretKeyCredentials } from \"../api/authApi\"; \r\n\r\n\r\nexport const useSecretKey = () => {\r\n  const selectUser = useMemo(\r\n    () => (state: RootState) => state.auth.role_name,\r\n    []\r\n  );\r\n  const user = useSelector(selectUser);\r\n  console.log(user)\r\n  const dispatch = useDispatch();\r\n  const navigate = useNavigate();\r\n\r\n  const { mutate, isPending, error } = useMutation<\r\n  SecretKeyResponse,\r\n    Error,\r\n    SecretKeyCredentials\r\n  >({\r\n    mutationFn: authApi.SecretKeyUser,\r\n    onSuccess: (data) => {\r\n      console.log(data)\r\n      // Store user info in Redux\r\n    //   dispatch(setCredentials({ \r\n    //     user: data.user, \r\n    //     accessToken: data.access_token,\r\n    //     refreshToken: data.refresh_token \r\n    //   }));\r\n\r\n      // Redirect user to correct route based on role\r\n    \r\n    const defaultRoute = data;\r\n    console.log(data)\r\n    // {valid: false, message: 'Invalid secret key', status: 200}\r\n    if (defaultRoute.valid) {\r\n      toast.success(\"Secret key is valid\");\r\n      if(user == \"User\"){\r\n        navigate('/client/workspaces');\r\n      }else if(user == \"Admin\"){\r\n        navigate('/admin-dashboard/users/viewall');\r\n      }else{\r\n        navigate('/login');\r\n      }\r\n    } else {\r\n      toast.error(\"Invalid Secret key\");\r\n    }\r\n    },\r\n    onError: (error: Error) => {\r\n      // else {\r\n        toast.error(\"Invalid Secret key\");\r\n      // }\r\n      // toast.error(error.message || \"Login failed\");\r\n    },\r\n  });\r\n\r\n  return { mutate, isLoading: isPending, error };\r\n};\r\n","import * as z from \"zod\";\r\n\r\nexport const secretKeySchema = z.object({\r\n  user_id: z.number().int({ message: \"User ID must be an integer\" }),\r\n  secret_key: z.string().min(1, \"Secret Key is required\"),\r\n});\r\n\r\nexport type SecretKeySchema = z.infer<typeof secretKeySchema>;\r\n","// import React from \"react\";\r\n// import { useForm } from \"react-hook-form\";\r\n// import { zodResolver } from \"@hookform/resolvers/zod\";\r\n// import { Eye, EyeOff, Loader2 } from \"lucide-react\";\r\n// import { useSelector } from 'react-redux';\r\n// import { RootState } from '@/store';\r\n// import { Button } from \"@/components/ui/button\";\r\n// import {\r\n//   Form,\r\n//   FormControl,\r\n//   FormField,\r\n//   FormItem,\r\n//   FormLabel,\r\n//   FormMessage,\r\n// } from \"@/components/ui/form\";\r\n// import { Input } from \"@/components/ui/input\";\r\n// import { useSecretKey } from \"../hooks/useSecretKey\";\r\n// import { secretKeySchema, SecretKeySchema } from \"../schemas/secretkey.schema\";\r\n// import { Link } from \"react-router\";\r\n\r\n\r\n// const SecretKeyForm = () => {\r\n//   const { mutate, isLoading } = useSecretKey();\r\n//   const auth = useSelector((state: RootState) => state.auth);\r\n//   console.log(auth)\r\n\r\n//   const form = useForm<SecretKeySchema>({\r\n//     resolver: zodResolver(secretKeySchema),\r\n//     defaultValues: {\r\n//       user_id: auth?.user_id,\r\n//       secret_key: \"\",\r\n//     },\r\n//   });\r\n\r\n//   const handleSecretKey = (values: SecretKeySchema) => {\r\n//     mutate(values);\r\n//   };\r\n\r\n\r\n\r\n//   return (\r\n//       <Form {...form}>\r\n//         <form onSubmit={form.handleSubmit(handleSecretKey)} className=\"space-y-6\">\r\n         \r\n\r\n//           <FormField\r\n//             control={form.control}\r\n//             name=\"secret_key\"\r\n//             render={({ field }) => (\r\n//               <FormItem>\r\n//                 <FormLabel>Secret Key</FormLabel>\r\n//                 <FormControl>\r\n//                   <div className=\"relative\">\r\n//                     <Input\r\n//                       {...field}\r\n//                       type=\"text\"\r\n//                       placeholder=\"Enter your secret key\"\r\n//                       autoComplete=\"off\"\r\n//                     />\r\n//                   </div>\r\n//                 </FormControl>\r\n//                 <FormMessage />\r\n//               </FormItem>\r\n//             )}\r\n//           />\r\n\r\n//           <Button type=\"submit\" disabled={isLoading} className=\"w-full\">\r\n//             {isLoading ? (\r\n//               <>\r\n//                 <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n//                 Please wait\r\n//               </>\r\n//             ) : (\r\n//               \"Validate Secret Key\"\r\n//             )}\r\n//           </Button>\r\n\r\n//           <div className=\"text-center\">\r\n//                       <Link\r\n//                         to=\"/login\"\r\n//                         className=\"text-sm text-muted-foreground hover:text-primary transition-colors\"\r\n//                       >\r\n//                         Back to login\r\n//                       </Link>\r\n//                     </div>\r\n//         </form>\r\n//       </Form>\r\n//   );\r\n// };\r\n\r\n// export default SecretKeyForm;\r\nimport React from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { zodResolver } from \"@hookform/resolvers/zod\";\r\nimport { Eye, EyeOff, Loader2 } from \"lucide-react\";\r\nimport { useSelector } from 'react-redux';\r\nimport { RootState } from '@/store';\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n  Form,\r\n  FormControl,\r\n  FormField,\r\n  FormItem,\r\n  FormLabel,\r\n  FormMessage,\r\n} from \"@/components/ui/form\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { useSecretKey } from \"../hooks/useSecretKey\";\r\nimport { secretKeySchema, SecretKeySchema } from \"../schemas/secretkey.schema\";\r\nimport { Link } from \"react-router\";\r\n\r\n\r\nconst SecretKeyForm = () => {\r\n  const { mutate, isLoading } = useSecretKey();\r\n  const auth = useSelector((state: RootState) => state.auth);\r\n  console.log(auth)\r\n\r\n  const form = useForm<SecretKeySchema>({\r\n    resolver: zodResolver(secretKeySchema),\r\n    defaultValues: {\r\n      user_id: auth?.user_id,\r\n      secret_key: \"\",\r\n    },\r\n  });\r\n\r\n  const handleSecretKey = (values: SecretKeySchema) => {\r\n    mutate(values);\r\n  };\r\n\r\n\r\n\r\n  return (\r\n      <Form {...form}>\r\n        <form onSubmit={form.handleSubmit(handleSecretKey)} className=\"space-y-6\">\r\n         \r\n\r\n          <FormField\r\n            control={form.control}\r\n            name=\"secret_key\"\r\n            render={({ field }) => (\r\n              <FormItem>\r\n                {/* <FormLabel>Secret Key</FormLabel> */}\r\n                <FormControl>\r\n                  <div className=\"relative\">\r\n                    <Input\r\n                      {...field}\r\n                      type=\"text\"\r\n                      placeholder=\"Secret Key*\"\r\n                      autoComplete=\"off\"\r\n                      \r\n                    className=\"rounded-full\"\r\n                    />\r\n                  </div>\r\n                </FormControl>\r\n                <FormMessage />\r\n              </FormItem>\r\n            )}\r\n          />\r\n\r\n          <Button type=\"submit\" disabled={isLoading} className=\"w-full  rounded-full bg-[#43996A]\">\r\n            {isLoading ? (\r\n              <>\r\n                <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\r\n                Please wait\r\n              </>\r\n            ) : (\r\n              \"Validate Secret Key\"\r\n            )}\r\n          </Button>\r\n\r\n          <div className=\"text-center\">\r\n                      <Link\r\n                        to=\"/login\"\r\n                        className=\"text-sm font-normal font-secondary text-[#062393] hover:text-primary transition-colors\"\r\n       \r\n                        // className=\"text-sm text-muted-foreground hover:text-primary transition-colors\"\r\n                      >\r\n                        Back to login\r\n                      </Link>\r\n                    </div>\r\n        </form>\r\n      </Form>\r\n  );\r\n};\r\n\r\nexport default SecretKeyForm;\r\n","import AuthLayout from \"../../components/AuthLayout\";\r\nimport SecretKeyForm from \"../../components/SecretKeyForm\";\r\n\r\nconst SecretKeyPage = () => {\r\n  return (\r\n    <AuthLayout title=\"SecretKey\">\r\n      <SecretKeyForm />\r\n    </AuthLayout>\r\n  );\r\n};\r\n\r\nexport default SecretKeyPage;\r\n"],"names":["useSecretKey","selectUser","useMemo","state","user","useSelector","useDispatch","navigate","useNavigate","mutate","isPending","error","useMutation","authApi","data","defaultRoute","toast","secretKeySchema","z.object","z.number","z.string","SecretKeyForm","isLoading","auth","form","useForm","zodResolver","handleSecretKey","values","jsx","Form","jsxs","FormField","field","FormItem","FormControl","Input","FormMessage","Button","Fragment","Loader2","Link","SecretKeyPage","AuthLayout"],"mappings":"geAgBO,MAAMA,EAAe,IAAM,CAChC,MAAMC,EAAaC,EAAA,QACjB,IAAOC,GAAqBA,EAAM,KAAK,UACvC,CAAA,CACF,EACMC,EAAOC,EAAYJ,CAAU,EACnC,QAAQ,IAAIG,CAAI,EACCE,EAAY,EAC7B,MAAMC,EAAWC,EAAY,EAEvB,CAAE,OAAAC,EAAQ,UAAAC,EAAW,MAAAC,CAAA,EAAUC,EAInC,CACA,WAAYC,EAAQ,cACpB,UAAYC,GAAS,CACnB,QAAQ,IAAIA,CAAI,EAUlB,MAAMC,EAAeD,EACrB,QAAQ,IAAIA,CAAI,EAEZC,EAAa,OACfC,EAAM,QAAQ,qBAAqB,EAChCZ,GAAQ,OACTG,EAAS,oBAAoB,EACtBH,GAAQ,QACfG,EAAS,gCAAgC,EAEzCA,EAAS,QAAQ,GAGnBS,EAAM,MAAM,oBAAoB,CAElC,EACA,QAAUL,GAAiB,CAEvBK,EAAM,MAAM,oBAAoB,CAAA,CAGpC,CACD,EAED,MAAO,CAAE,OAAAP,EAAQ,UAAWC,EAAW,MAAAC,CAAM,CAC/C,EClEaM,EAAkBC,EAAS,CACtC,QAASC,EAAS,EAAE,IAAI,CAAE,QAAS,6BAA8B,EACjE,WAAYC,EAAE,EAAS,IAAI,EAAG,wBAAwB,CACxD,CAAC,EC2GKC,EAAgB,IAAM,CAC1B,KAAM,CAAE,OAAAZ,EAAQ,UAAAa,CAAU,EAAItB,EAAa,EACrCuB,EAAOlB,EAAaF,GAAqBA,EAAM,IAAI,EACzD,QAAQ,IAAIoB,CAAI,EAEhB,MAAMC,EAAOC,EAAyB,CACpC,SAAUC,EAAYT,CAAe,EACrC,cAAe,CACb,QAASM,GAAA,YAAAA,EAAM,QACf,WAAY,EAAA,CACd,CACD,EAEKI,EAAmBC,GAA4B,CACnDnB,EAAOmB,CAAM,CACf,EAIA,OACKC,EAAAA,IAAAC,EAAA,CAAM,GAAGN,EACR,SAACO,EAAAA,KAAA,OAAA,CAAK,SAAUP,EAAK,aAAaG,CAAe,EAAG,UAAU,YAG5D,SAAA,CAAAE,EAAA,IAACG,EAAA,CACC,QAASR,EAAK,QACd,KAAK,aACL,OAAQ,CAAC,CAAE,MAAAS,CAAM,WACdC,EAEC,CAAA,SAAA,CAAAL,MAACM,EACC,CAAA,SAAAN,EAAA,IAAC,MAAI,CAAA,UAAU,WACb,SAAAA,EAAA,IAACO,EAAA,CACE,GAAGH,EACJ,KAAK,OACL,YAAY,cACZ,aAAa,MAEf,UAAU,cAAA,GAEZ,CACF,CAAA,QACCI,EAAY,CAAA,CAAA,CAAA,CACf,CAAA,CAAA,CAEJ,EAEAR,EAAAA,IAACS,GAAO,KAAK,SAAS,SAAUhB,EAAW,UAAU,oCAClD,SAAAA,EAEGS,EAAA,KAAAQ,EAAA,SAAA,CAAA,SAAA,CAACV,EAAAA,IAAAW,EAAA,CAAQ,UAAU,2BAA4B,CAAA,EAAE,aAAA,CAEnD,CAAA,EAEA,sBAEJ,EAEAX,EAAAA,IAAC,MAAI,CAAA,UAAU,cACH,SAAAA,EAAA,IAACY,EAAA,CACC,GAAG,SACH,UAAU,yFAGX,SAAA,eAAA,CAAA,CAGH,CAAA,CAAA,CAAA,CACZ,CACF,CAAA,CAEN,ECpLMC,EAAgB,UAEjBC,EAAW,CAAA,MAAM,YAChB,SAAAd,MAACR,GAAc,CAAA,EACjB"}
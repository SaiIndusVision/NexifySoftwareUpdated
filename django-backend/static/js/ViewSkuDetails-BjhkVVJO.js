import{e as Ue,j as e}from"./mui-B_PChry4.js";import{r as s,f as Ee,b as Me,h as Le,i as Ce}from"./react-core-CQlor4TK.js";import{p as ke}from"./nexify-placeholder-img-DvrgdLBk.js";import{u as Ye,D as Qe}from"./useDynamicPagination-CUeX1GsM.js";import{u as Je}from"./useFilterApi-BEpbauvg.js";import{C as De,j as Ge,p as Ke,A as Oe,t as We,F as Xe,b as He,c as Ze,d as qe,I as $e,e as et,B as tt,L as st,u as m,X as at,n as Ve}from"./index-Bv_2KTqU.js";import{a as w,u as nt}from"./data-utils-DaMdQHZx.js";import{b as lt,n as ot,s as rt,d as it}from"./form-tools-DBwiXJwN.js";import"./state-management-BfQTD3Fv.js";import"./ui-utils-DC4QuFVe.js";import"./radix-B0DvzVia.js";const ct="data:image/png;base64,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",dt="data:image/png;base64,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",we=Ue(e.jsx("path",{d:"M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5z"}),"NorthEast"),mt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB8AAAAfCAYAAAAfrhY5AAAACXBIWXMAABCcAAAQnAEmzTo0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAIcSURBVHgB7VfbUQIxFD0RR/1cKxA7sAT9xXGQCoQK0AqECqQDoAJGGdA/sALoADqAXx0FzyVZiWEXAssMfnBmstnc7Obc195kgR1C+TzUAIIjIP0JjHPAUGSvHE+BKm8v2SoZ4AFrYiW5IenwNm1eKLGrW7IxW8Bx7RooYA0cwJNYFmc/ZF9i6xlZ+QM4Z9+nUvmWViw5uUNcFqu+55YFRlaScKi5V/pICiFuAwO2aWhNlIz9BccjI8tjG+BitaTEMv8GFDnfkWfYntxnVAy5uPtS4nnCG8f9JVlYaZm4v3Ct8wFNvsM43nLuTubcdTMOX1zMn+VyTAJf4heSpijnXBFa4ZrM04BTDrtRJIdRQmpYaelEChdaSixIGUvDZ/HXk/AmN5mejSMOLbFjrXSxEZzZcn4hY64RRMVXxRDHuhoJ4MZ8wfIJtVbxxGLFJmX0EaYWLCVXulwKsszerpqVdk0szY6zL9o6+9OufCHbJdnY1Ul6kbKSC3OlZhCPNKwwyNieb85zIBaRn1pGJ0xd7t2sDhemcj2W1nt73Dbj8LNbVfVia7soIN/oOm6eGk+kPBNz6a6Wc1y9bRxgh9iT78n35P+X/EufUocsqQOzyNgeT/SPhciSn2YF5gA5wgYID5GufB3L39mCcPPwhdndpHXdOa9/NYE54cifyu8xahXM8Wm21fI4dXXjvOdNbilQhcdebaFL4vJNhMI/3ZTVcKQqeWcAAAAASUVORK5CYII=",Re="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAATCAYAAAB2pebxAAAACXBIWXMAABCcAAAQnAEmzTo0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACqSURBVHgB7ZTBCcMwDEUt1b13kAQ6QjJCR+kkHakZoRBy7wi9l8i1DwXF6JuE5JBDPthYQnrIQjY5oG/fN5b/XNdd7iOUwMxPCyIirQkZhyG4FfJpCyF0RNT8z3MSzfhUzZKKdDyjoNQn3avc1vIIohpLlj2JdRvogOwZAuckH//Sc4AQX1VtyS5C0GiXpCGvuK7oHwF6TyAx+TaKPOLlL7PSiT4n5ns6/gCMkEutEIPmAwAAAABJRU5ErkJggg==",ut=({row:i})=>{const[p,D]=s.useState({labelName:i.name||"",shortcutKey:i.shortcut_key||"",colorCode:i.color_code||"#EEE"}),[T,A]=s.useState(!1),g=async()=>{try{const f={name:p.labelName,shortcut_key:p.shortcutKey.toUpperCase(),color_code:p.colorCode,is_active:!0};A(!0),i.id?(await w.put(`http://localhost:8000/api/label/${i.id}/`,f),alert("Label updated successfully!")):(await w.post("http://localhost:8000/api/label/",f),alert("Label added successfully!"))}catch(f){console.error("Error saving label:",f),alert("Failed to save label")}finally{A(!1)}};return e.jsx(De,{title:i.id?"Update Label":"Add New Label",description:e.jsxs("form",{onSubmit:f=>f.preventDefault(),children:[e.jsx("input",{type:"text",className:"w-full px-2 py-1 border rounded-full mb-2",placeholder:"Label name",value:p.labelName,onChange:f=>D({...p,labelName:f.target.value})}),e.jsx("input",{type:"text",className:"w-full px-2 py-1 border rounded-full mb-2",placeholder:"Shortcut Key (e.g., G)",value:p.shortcutKey,onChange:f=>D({...p,shortcutKey:f.target.value})}),e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium mb-2",children:["Select color:",e.jsx("input",{type:"color",className:"h-8 w-10 rounded-full border",value:p.colorCode,onChange:f=>D({...p,colorCode:f.target.value})})]})]}),onConfirm:g,isLoading:T,children:e.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white hover:bg-blue-700 rounded-full",children:i.id?"Edit":"Add"})})},pt=({row:i})=>{const[p,D]=s.useState(!1),T=async()=>{D(!0);try{await w.delete(`http://localhost:8000/api/label/${i.id}/`,{headers:{accept:"application/json"}}),alert("Label deleted successfully!")}catch(A){console.error("Error deleting label:",A),alert("Failed to delete label.")}finally{D(!1)}};return e.jsx(De,{title:"Delete Label",description:`Are you sure you want to delete the label "${i.name}"?`,onConfirm:T,isLoading:p,children:e.jsxs("button",{className:"px-3 py-1 bg-red-600 text-white flex justify-center items-center gap-4 hover:bg-red-700 rounded-full",children:["Delete ",e.jsx("img",{src:Re,alt:"Delete",className:"w-4 h-4"})]})})},gt=(i,p,D,T,A,g)=>{const f=[{key:"color_code",id:"color_code",name:"Color",cell:(x,k)=>{const c=k.color_code,z=c.startsWith("#")?c.slice(1):c,E=z.length===3?z.split("").map(ae=>ae+ae).join(""):z,F=parseInt(E.substring(0,2),16),q=parseInt(E.substring(2,4),16),se=parseInt(E.substring(4,6),16),W=(F*299+q*587+se*114)/1e3>150?"text-black":"text-white";return e.jsx("button",{className:`px-3 py-1 rounded-full border ${W}`,style:{backgroundColor:c},children:c})}},{key:"name",id:"name",name:"Label Name"},{key:"shortcut_key",id:"shortcut_key",name:"Key assigned"}];return i!=="AnamolyDetection"&&f.push({key:"view",id:"view",name:"",cell:(x,k)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ut,{row:k}),e.jsx(pt,{row:k})]})}),f},Te=[{partner_id:"62940e36-c368-43f8-b978-4111223a1cac",hashed_key:"befb8eadb0fac508d695b7395ec10543m8ctxoh9",role_id:"cdadd7a8-a04a-40ba-a5b3-2b1bf6d788c8",email:"reach2tayib@gmail.com",first_name:"Mohammed",last_name:"Tayib",api_key:"7b4d9b49-1794-4a91-826a-749cf0d8a87a",is_active:!1,business_type:"large_enterprise",created_by:"4b9517bd-692b-459d-b39f-0c6147a67e31",updated_by:null,products:[{id:"80185a93-7242-4680-8922-297d85dfbd2d",name:"Card"}]},{partner_id:"27644155-4cc2-4541-93ea-babd214d7df3",hashed_key:"4f0440dc0a6d253296aff77f4566d9d8m8ctn5re",role_id:"cdadd7a8-a04a-40ba-a5b3-2b1bf6d788c8",email:"sana@gmail.com",first_name:"Sana",last_name:"G",api_key:"eccc2215-82b7-46be-a418-fb2d997224e6",is_active:!0,business_type:"large_enterprise",created_by:null,updated_by:null,products:[]},{partner_id:"274a5724-5e98-49ff-90fe-0a0fd49f6dff",hashed_key:"bbce159e39b5e7ea1096fc42ebfeff03m85s76dn",role_id:"cdadd7a8-a04a-40ba-a5b3-2b1bf6d788c8",email:"contact2tayib@gmail.com",first_name:"Mohammed",last_name:"Tayibulla",api_key:"41dc8bcf-dff0-4152-a11a-49183559bd31",is_active:!0,business_type:"large_enterprise",created_by:null,updated_by:null,products:[]}],ht=({skuId:i,refreshKey:p,tags:D})=>{const{setTitle:T}=Ge();Ee(),s.useEffect(()=>{T("")},[T]);const[A,g]=s.useState([]),f=s.useMemo(()=>D==="AnamolyDetection"?{label:null}:i?{sku:i}:{},[D,i]);console.log(f);const{data:x=[],fetchData:k}=Ke("NUSERS.SKU.LABEL_LIST",f);console.log("usersData 28",x),s.useEffect(()=>{k()},[p,k]);const c=Ye({endpoint:Oe.NUSERS.USER.LIST,initialPageSize:10,initialData:Te,dataPath:"transactions",totalRecordsPath:"totalRecords"});Je({endpoint:Oe.NUSERS.USER.LIST,initialData:Te,baseQueryParams:{}});const[z,E]=s.useState({}),[F,q]=s.useState({}),se=gt(D),ue=c.loading,W=c.error,ae=c.totalRecords||0;return console.log(x),s.useEffect(()=>{x&&Array.isArray(x==null?void 0:x.results)&&g(x==null?void 0:x.results)},[x]),e.jsx("div",{className:"flex flex-col py-4",children:e.jsx(Qe,{columns:se,data:x&&x.length>0?x:A,defaultSortColumn:"niumId",defaultSortDirection:"asc",loading:ue,refreshAction:{isRefreshButtonVisible:!1,isLoading:ue,hasError:W},paginationMode:"static",onPageChange:async(ne,de)=>[],totalRecords:ae})})},ve="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG4AAABWCAYAAAAucqM7AAAACXBIWXMAABCcAAAQnAEmzTo0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMESURBVHgB7d0/TxRBHMbx3wx70WiIdIr/cvYaeQEmyhugtzBIbWODFCYKJYoJdpSeDYkVWphYcRQWdBIruwWNWOnSyMHezrizMscenGiBsM/u80kudzu5S0i+zMxuNSp4sP5YWTspGMJYq2GZHgyl4jRQNKdeM3ZRJtbrUnFa8DBeStXGv1p/8f1RvxTVx29GRho/ZWOr8+dWetmEmXHXzml5M3pKzpxQfqjSMw9qqWS8XXB7HOP9hnhzwngCGs6pejzYcE6V40GHc6oaD+Y57m96PedZk4xJybSDIHTPrqUJ5/SIV0rpP+Qw/FKZ12PZLCl9K5CS8fEevmtJmaxGVj5vmM516cI5Pl6ZTC9tpa/tznWplsoqYThQDAeK4UAxHCiGA8VwoBgOFMOBYjhQDAeK4UAxHCiGA8VwoBgOFMOBYjhQDAeK4UAxHCiGA8VwoBgOFMOBYjhQDAeK4UAxHCiGA8VwoBgOFMOBYjhQDAeK4UAxHCiGA8VwoBgOFMOBYjhQDAeK4UAxHCiGA8VwoBgOFMOBYjhQDAeK4UAxHCiGA8VwoBgOFMOB0mIl8hcbrXIfJoQs30YpFWlREvoBdxoUFVO+jbXJB22NWfIDbz/FQsWzFhl5v5p0roMgCNM9zi74gfmVNpfLAspHS7e2Zmt6MNTtZ5eafp9z0eaWt4WKw822/ClWotWL7G3ncsqPzy3H3OsKxEVz8XaE8ZPBhvuQhYtnzs+mb0332c26O68281+mY+LOjJtfyd13KDXpP3ae4/q0GvNLpos28nKz+0d0ZNzkufe61bVEKmOn/GzLrvM/qI1/GRKrF9PRAT92+3otfQVyo17Kwx0Lxd9juO2q6ybR2kY8c+Fu/rv7ToE9ObFeT9w52iL1/PjlAS1Xz+rsGEs6XGuR3XfLv8s8j59evL93tOfxvVm8xEyma+qo0HHJzjHP7vp7OPDc5VzAm7JnBtL/YdPnNKX0wul4sxHNXon+9L1/PjDb7X/GmLqSviGhQ6V03w9jtlf7k6R5UKy8X8WBPRteZdGpAAAAAElFTkSuQmCC",ft=lt({name:rt().min(1,"Version name is required").max(100,"Maximum 100 characters allowed"),sku:ot().nullable().optional()}),xt=()=>nt({mutationFn:async i=>(console.log(i),(await w.post("http://localhost:8000/api/versions/",i)).data)}),bt=({sku:i,onSuccess:p,onCancel:D})=>{const T=parseInt(i,10),{mutate:A,isLoading:g}=xt(),f=it({resolver:We(ft),defaultValues:{name:"",sku:T}}),x=k=>{const c={name:k.name,sku:k.sku};A(c,{onSuccess:()=>{m.success("Version created successfully",{position:"top-center",duration:4e3}),f.reset(),p==null||p()},onError:z=>{var E,F;console.error("Failed to create version:",z),m.error(`${z instanceof Error?(F=(E=z==null?void 0:z.response)==null?void 0:E.data)==null?void 0:F.message:"Unknown error"}`,{position:"top-center",duration:4e3})}})};return e.jsxs(Xe,{...f,children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"text-2xl font-secondary font-bold text-[#062393]",children:"Create a New Version"}),e.jsx("div",{className:"text-sm font-secondary font-normal",children:"Fill all the fields"})]}),e.jsxs("form",{onSubmit:f.handleSubmit(x),className:"space-y-6",children:[e.jsx(He,{control:f.control,name:"name",render:({field:k})=>e.jsxs(Ze,{children:[e.jsx(qe,{children:e.jsx($e,{...k,placeholder:"Version Name*",className:"rounded-full w-full"})}),e.jsx(et,{})]})}),e.jsx("div",{className:"flex gap-2",children:e.jsx(tt,{type:"submit",disabled:g,className:"w-full rounded-full",children:g?e.jsxs(e.Fragment,{children:[e.jsx(st,{className:"mr-2 h-4 w-4 animate-spin"}),"Please wait"]}):"Create New Version"})})]})]})},Ie=({done:i})=>{const p=s.useRef(null);return s.useEffect(()=>{p.current&&(p.current.style.width=`${i}%`,p.current.style.opacity="1")},[i]),e.jsx("div",{className:"w-[80%] h-[30px] bg-gray-300 rounded-full relative my-2",children:e.jsx("div",{ref:p,className:"h-full rounded-full bg-gradient-to-l from-[#163323] to-[#43996A] text-white flex items-center justify-center text-sm font-medium transition-all duration-1000 ease-in-out opacity-0 min-w-[50px]","data-done":i,children:i>0?`${i}%`:"0%"})})},jt="/assets/png/affine_scale-Q0zfNdrG.png",yt=Object.freeze(Object.defineProperty({__proto__:null,default:jt},Symbol.toStringTag,{value:"Module"})),_t="/assets/png/affine_shear-CukyTlUQ.png",vt=Object.freeze(Object.defineProperty({__proto__:null,default:_t},Symbol.toStringTag,{value:"Module"})),Nt="/assets/png/blur-tAlMjw4e.png",wt=Object.freeze(Object.defineProperty({__proto__:null,default:Nt},Symbol.toStringTag,{value:"Module"})),At="/assets/png/brightness-qD7a0QbE.png",St=Object.freeze(Object.defineProperty({__proto__:null,default:At},Symbol.toStringTag,{value:"Module"})),Ct="/assets/png/contrast-BnzCjgSD.png",kt=Object.freeze(Object.defineProperty({__proto__:null,default:Ct},Symbol.toStringTag,{value:"Module"})),It="/assets/png/grayscale-C3tGsa5R.png",Dt=Object.freeze(Object.defineProperty({__proto__:null,default:It},Symbol.toStringTag,{value:"Module"})),Mt="/assets/png/horizontal_flip-BsrKdxf9.png",Ot=Object.freeze(Object.defineProperty({__proto__:null,default:Mt},Symbol.toStringTag,{value:"Module"})),Vt="/assets/png/hue-E_rrpow2.png",Tt=Object.freeze(Object.defineProperty({__proto__:null,default:Vt},Symbol.toStringTag,{value:"Module"})),Ft="/assets/png/hue_saturation_value-OC5rUTrz.png",Bt=Object.freeze(Object.defineProperty({__proto__:null,default:Ft},Symbol.toStringTag,{value:"Module"})),Et="/assets/png/invert-DOpIopMb.png",Rt=Object.freeze(Object.defineProperty({__proto__:null,default:Et},Symbol.toStringTag,{value:"Module"})),zt="/assets/png/noise-ChclfCfh.png",Pt=Object.freeze(Object.defineProperty({__proto__:null,default:zt},Symbol.toStringTag,{value:"Module"})),Ut="/assets/png/resize_distort-BcM9BXdV.png",Lt=Object.freeze(Object.defineProperty({__proto__:null,default:Ut},Symbol.toStringTag,{value:"Module"})),Yt="/assets/png/resize_maintain_aspect-BMPCC9ty.png",Qt=Object.freeze(Object.defineProperty({__proto__:null,default:Yt},Symbol.toStringTag,{value:"Module"})),Jt="/assets/png/rotation-Kfpc05xF.png",Gt=Object.freeze(Object.defineProperty({__proto__:null,default:Jt},Symbol.toStringTag,{value:"Module"})),Kt="/assets/png/saturation-BmxN43Zh.png",Wt=Object.freeze(Object.defineProperty({__proto__:null,default:Kt},Symbol.toStringTag,{value:"Module"})),Xt="/assets/png/sharpen-BCxE7C1u.png",Ht=Object.freeze(Object.defineProperty({__proto__:null,default:Xt},Symbol.toStringTag,{value:"Module"})),Zt="/assets/png/shear-Bi17ZSRU.png",qt=Object.freeze(Object.defineProperty({__proto__:null,default:Zt},Symbol.toStringTag,{value:"Module"})),$t="/assets/png/vertical_flip-BcapdE7h.png",es=Object.freeze(Object.defineProperty({__proto__:null,default:$t},Symbol.toStringTag,{value:"Module"})),ts=Object.assign({"/src/assets/media/affine_scale.png":yt,"/src/assets/media/affine_shear.png":vt,"/src/assets/media/blur.png":wt,"/src/assets/media/brightness.png":St,"/src/assets/media/contrast.png":kt,"/src/assets/media/grayscale.png":Dt,"/src/assets/media/horizontal_flip.png":Ot,"/src/assets/media/hue.png":Tt,"/src/assets/media/hue_saturation_value.png":Bt,"/src/assets/media/invert.png":Rt,"/src/assets/media/noise.png":Pt,"/src/assets/media/resize_distort.png":Lt,"/src/assets/media/resize_maintain_aspect.png":Qt,"/src/assets/media/rotation.png":Gt,"/src/assets/media/saturation.png":Wt,"/src/assets/media/sharpen.png":Ht,"/src/assets/media/shear.png":qt,"/src/assets/media/vertical_flip.png":es}),ss=i=>{var D;const p=`/src/assets/media/${i}.png`;return(D=ts[p])==null?void 0:D.default},as=({skuId:i,version:p,skuVersions:D,selectedVersion:T})=>{const[A,g]=s.useState(!1),[f,x]=s.useState(null),[k,c]=s.useState(0),[z,E]=s.useState(new Set),[F,q]=s.useState([]),[se,ue]=s.useState([]),[W,ae]=s.useState(null),[ne,de]=s.useState([]),[me,b]=s.useState([]),Q=t=>{ne.includes(t.name)?(de(n=>n.filter(r=>r!==t.name)),b(n=>n.filter(r=>r!==t.version_id))):(de(n=>[...n,t.name]),b(n=>[...n,t.version_id]))},[B,G]=s.useState([]),[P,te]=s.useState([]),[U,O]=s.useState(null),[Z,$]=s.useState([]);s.useEffect(()=>{(async()=>{try{if(!i)return;const u=await w.get(`http://localhost:8000/api/final-data-set/?sku_id=${i}`,{headers:{accept:"application/json"}}),n=Object.entries(u.data).map(([r,v])=>{const S={train:0,test:0,val:0},H={Good:0,Bad:0};return v.images.forEach(h=>{h.split_label&&S[h.split_label]!==void 0&&S[h.split_label]++,h.label_name==="Good"?H.Good++:h.label_name==="Bad"&&H.Bad++}),{name:r,version_id:v.version_id,total_image_count:v.images.length,images:v.images.map(h=>({id:h.image_url,name:h.image_url.split("/").pop(),url:h.image_url,label_id:h.label_id,label_name:h.label_name,split_label:h.split_label})),labeled_image_count:v.images.filter(h=>h.label_id).length,unlabeled_image_count:v.images.filter(h=>!h.label_id).length,rejected:v.images.filter(h=>h.label_name==="Bad").length,split_counts:S,label_counts:H}});ue(n),n.length>0&&(setSelectedDatasetName(n[0].name),q(n[0].images))}catch(u){console.error("Failed to fetch datasets",u)}})()},[i]);const M=t=>{P.includes(t.name)?(te(n=>n.filter(r=>r!==t.name)),$(n=>n.filter(r=>r!==t.version_id))):(te(n=>[...n,t.name]),$(n=>[...n,t.version_id]))},[J,o]=Me.useState(null),[y,X]=Me.useState(null);s.useEffect(()=>{if(!J)return;const t=new EventSource("http://localhost:8000/api/stream-training-progress/");return t.onmessage=async u=>{const n=JSON.parse(u.data);if(n.type==="progress"){const{job_id:r,progress:v,status:S}=n.data;if(m.info(`Train ${r}: ${v}% - ${S}`,{position:"top-center"}),S==="Done")try{await w.delete(`http://localhost:8000/api/train-runner/${J}/`),m.success("Training completed and stopped",{position:"top-center",duration:4e3}),o(null),g(!1)}catch(H){console.error("Auto-stop failed:",H),m.error("Failed to stop training after completion",{position:"top-center"})}}},t.onerror=()=>{m.error("Progress stream connection lost",{position:"top-center"}),t.close()},()=>t.close()},[J]),s.useEffect(()=>{if(!y)return;const t=new EventSource("http://localhost:8000/api/stream-testing-progress/");return t.onmessage=async u=>{const n=JSON.parse(u.data);if(n.type==="progress"){const{job_id:r,progress:v,status:S}=n.data;if(m.info(`Train ${r}: ${v}% - ${S}`,{position:"top-center"}),S==="Done")try{await w.delete(`http://localhost:8000/api/test-runner/${J}/`),m.success("Testing completed and stopped",{position:"top-center",duration:4e3}),X(null),g(!1)}catch(H){console.error("Auto-stop failed:",H),m.error("Failed to stop training after completion",{position:"top-center"})}}},t.onerror=()=>{m.error("Progress stream connection lost",{position:"top-center"}),t.close()},()=>t.close()},[y]);const _=async()=>{var t;try{const n=(t=(await w.get(`http://localhost:8000/api/sku-images-list/?sku_id=${i}&version_id=${p}`)).data.results)==null?void 0:t.map(r=>({id:r.id,name:r.original_filename,url:`http://localhost:8000${r.image}`,label_id:r.label_id||null,label_name:r.label_name||null,label_color_code:r.label_color_code||null}));q(n||[])}catch(u){console.error("Failed to fetch images",u)}};s.useEffect(()=>{_()},[i,p]);const V=({title:t,imageUrl:u,onClick:n})=>e.jsxs("div",{onClick:n,className:"border rounded-lg shadow-sm p-4 hover:bg-blue-50 cursor-pointer flex flex-col items-center",children:[e.jsx("img",{src:u,alt:t,className:"w-24 h-24 object-cover rounded mb-2"}),e.jsx("h4",{className:"font-semibold text-lg text-gray-800 text-center",children:t})]}),le=({label:t,min:u,max:n,step:r=1,value:v,onChange:S})=>e.jsxs("div",{className:"my-4",children:[e.jsxs("label",{className:"block mb-1 text-sm font-medium text-gray-700",children:[t,": ",e.jsx("span",{className:"font-bold text-blue-600",children:v})]}),e.jsx("input",{type:"range",min:u,max:n,step:r,value:v,onChange:H=>S(Number(H.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),je=({isOpen:t,onClose:u,title:n,file:r,parameters:v,onUpdate:S,dualMode:H})=>{const[h,ie]=s.useState({}),[oe,ye]=s.useState(null),be={horizontal_flip:{params:["p"],dual_mode:!1},vertical_flip:{params:["p"],dual_mode:!1},grayscale:{params:["p"],dual_mode:!1},rotation:{params:["degrees"],dual_mode:!0,configBuilder:l=>({degrees:l.degrees,dual_mode:l.dual_mode})},blur:{params:["kernel_size","sigma"],dual_mode:!1,configBuilder:l=>({kernel_size:l.kernel_size,sigma:l.sigma})},brightness:{params:["brightness"],dual_mode:!0,configBuilder:l=>({brightness:l.brightness,dual_mode:l.dual_mode})},contrast:{params:["contrast"],dual_mode:!0,configBuilder:l=>({contrast:l.contrast,dual_mode:l.dual_mode})},hue:{params:["hue"],dual_mode:!0,configBuilder:l=>({hue:l.hue,dual_mode:l.dual_mode})},saturation:{params:["saturation"],dual_mode:!0,configBuilder:l=>({saturation:l.saturation,dual_mode:l.dual_mode})},affine_scale:{params:["scale"],dual_mode:!1,configBuilder:l=>({scale:l.scale})},affine_shear:{params:["shear_x","shear_y"],dual_mode:!0,configBuilder:l=>({shear_x:l.shear_x,shear_y:l.shear_y,dual_mode:l.dual_mode})},resize_maintain_aspect:{params:["size"],dual_mode:!1,configBuilder:l=>({size:l.size})},resize_distort:{params:["width","height"],dual_mode:!1,configBuilder:l=>({width:l.width,height:l.height})},invert:{params:["p"],dual_mode:!1},sharpen:{params:["sharpness_factor","p"],dual_mode:!1,configBuilder:l=>({sharpness_factor:l.sharpness_factor,p:l.p})}};return s.useEffect(()=>{n.toLowerCase().replace(/ /g,"_");const l=v.reduce((I,ee)=>({...I,[ee.name]:ee.default}),{});ie(l)},[v,n]),s.useEffect(()=>{if(!r||!t)return;(async()=>{var K,ce;const I=new FormData;I.append("image",r);const ee=n.toLowerCase().replace(/ /g,"_");I.append("modifier_type",ee);const C=be[ee]||{params:Object.keys(h)},Y=C.configBuilder?C.configBuilder({...h,dual_mode:C.dual_mode}):C.params.reduce((R,_e)=>({...R,[_e]:h[_e]}),{});I.append("parameters",JSON.stringify(Y));try{const R=await w.post("http://localhost:8000/api/image_modifier/single_modifier/",I);ye({original_image:R.data.original_image,augmented_image:R.data.transformed_pos_image||R.data.transformed_neg_image,dual_images:C.dual_mode?{positive:R.data.transformed_pos_image,negative:R.data.transformed_neg_image}:null})}catch(R){console.error("Error fetching preview",R),m.error(((ce=(K=R.response)==null?void 0:K.data)==null?void 0:ce.error)||"Failed to fetch preview",{position:"top-center",duration:4e3})}})()},[r,h,t,n]),s.useEffect(()=>{if(t){const l=n.toLowerCase().replace(/ /g,"_"),I=be[l]||{params:Object.keys(h)},ee=I.configBuilder?I.configBuilder({...h,dual_mode:I.dual_mode}):I.params.reduce((Y,K)=>({...Y,[K]:h[K]}),{});S({modifier_type:l,parameters:ee})}},[h,t,n,S]),t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg w-[90%] max-w-xl relative",children:[e.jsx("button",{className:"absolute top-2 right-2 text-gray-600",onClick:u,children:"✕"}),e.jsx("h2",{className:"text-xl font-semibold mb-4",children:n}),e.jsx("div",{className:"mb-4",children:v.map(l=>e.jsx(le,{label:l.name.replace(/_/g," ").replace(/\b\w/g,I=>I.toUpperCase()),min:l.min,max:l.max,step:l.step,value:h[l.name]??l.default,onChange:I=>ie(ee=>({...ee,[l.name]:I}))},l.name))}),oe&&e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Original"}),e.jsx("img",{src:`data:image/jpeg;base64,${oe.original_image}`,className:"w-40 h-28 object-cover rounded",alt:"Original"})]}),oe.dual_images?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Positive Transform"}),e.jsx("img",{src:`data:image/jpeg;base64,${oe.dual_images.positive}`,className:"w-40 h-28 object-cover rounded",alt:"Positive Transform"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Negative Transform"}),e.jsx("img",{src:`data:image/jpeg;base64,${oe.dual_images.negative}`,className:"w-40 h-28 object-cover rounded",alt:"Negative Transform"})]})]}):e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Transformed"}),e.jsx("img",{src:`data:image/jpeg;base64,${oe.augmented_image}`,className:"w-40 h-28 object-cover rounded",alt:"Transformed"})]})]})]})}):null},ge=({isPreprocessing:t=!1})=>{var ee;const[u,n]=s.useState(null),[r,v]=s.useState(null),[S,H]=s.useState({}),[h,ie]=s.useState([]),[oe,ye]=s.useState(null),be=(ee=F[0])==null?void 0:ee.url;s.useEffect(()=>{(async()=>{if(be)try{const K=await(await fetch(be)).blob(),ce=new File([K],"first-image.jpg",{type:K.type});n(ce)}catch(Y){console.error("Failed to fetch image as file",Y)}})()},[be]),s.useEffect(()=>{(async()=>{try{const Y=t?"http://localhost:8000/api/image_modifier/list_preprocessor/":"http://localhost:8000/api/image_modifier/list_transform/",K=await w.get(Y),ce=t?K.data.preprocessors:K.data.augmentations,R=Object.entries(ce).map(([_e,Ae])=>({key:_e,title:_e.replace(/_/g," ").replace(/\b\w/g,Se=>Se.toUpperCase()),description:Ae.description,parameters:Object.entries(Ae.parameters).map(([Se,Ne])=>({name:Se,min:Ne.min,max:Ne.max,default:Ne.default,step:Ne.step})),dual_mode:Ae.dual_mode}));ie(R)}catch(Y){console.error("Failed to fetch list",Y),m.error(`Failed to fetch ${t?"preprocessors":"augmentations"}`,{position:"top-center",duration:4e3})}})()},[t]);const l=(C,Y)=>{H(R=>({...R,[C]:Y}));const K=t?"preProcessingConfigs":"augmentationConfigs",ce=JSON.parse(localStorage.getItem(K)||"{}");localStorage.setItem(K,JSON.stringify({...ce,[C]:Y}))},I=async()=>{var K,ce;if(!u){m.error("Please select an image",{position:"top-center",duration:4e3});return}const C=new FormData;C.append("image",u);const Y=Object.values(S).filter(Boolean).map(R=>({modifier_type:R.modifier_type,parameters:R.parameters}));C.append("modifier_config",JSON.stringify(Y)),C.append("parameters",JSON.stringify({}));try{const R=await w.post("http://localhost:8000/api/image_modifier/multiple_modifier/",C);ye(R.data),m.success(`${t?"Preprocessing":"Augmentations"} applied successfully`,{position:"top-center",duration:4e3})}catch(R){console.error("Error applying transformations",R),m.error(((ce=(K=R.response)==null?void 0:K.data)==null?void 0:ce.error)||`Failed to apply ${t?"preprocessing":"augmentations"}`,{position:"top-center",duration:4e3})}};return e.jsxs("div",{className:"p-4 max-w-4xl mx-auto",children:[e.jsx("div",{className:"grid grid-cols-2 gap-4",children:h.map(({key:C,title:Y})=>{const K=ss(C);return e.jsx(V,{title:Y,imageUrl:K,onClick:()=>v(C)},C)})}),h.map(C=>e.jsx(je,{isOpen:r===C.key,onClose:()=>v(null),title:C.title,file:u,parameters:C.parameters,dualMode:C.dual_mode,onUpdate:Y=>l(C.key,Y)},C.key)),oe&&e.jsxs("div",{className:"flex gap-4 mt-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Original"}),e.jsx("img",{src:`data:image/jpeg;base64,${oe.original_image}`,className:"w-40 h-28 object-cover rounded",alt:"Original"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Transformed"}),e.jsx("img",{src:`data:image/jpeg;base64,${oe.augmented_image}`,className:"w-40 h-28 object-cover rounded",alt:"Transformed"})]})]}),e.jsx("div",{className:"flex items-center justify-center cursor-pointer my-2",children:e.jsxs("button",{onClick:I,className:"bg-blue-500 text-white py-2 px-4 rounded mb-4",disabled:!u||Object.keys(S).length===0,children:["Apply All ",t?"Preprocessing":"Augmentations"]})})]})},he=[{label:"Select dataset",component:()=>e.jsx("div",{className:"p-4 bg-gray-100 rounded-lg w-full text-green-600",children:e.jsx("div",{className:"flex flex-col rounded-lg p-4 shadow-md gap-3 mb-2 bg-white max-h-96 overflow-y-scroll",children:!T&&se.map(t=>e.jsxs("div",{className:"bg-white flex justify-center flex-col p-4 m-2 shadow-md rounded-lg text-center cursor-pointer",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex gap-4 items-center justify-center",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-500",checked:ne.includes(t.name),onChange:()=>Q(t)}),e.jsx("img",{src:ve,alt:"",className:"w-4 h-4"}),e.jsx("h4",{className:"text-base font-medium",children:t.name})]}),e.jsxs("div",{className:"text-blue-500 font-semibold",children:[t.total_image_count," images"," ",e.jsx(we,{className:"w-5 h-5",fontSize:"small"})]})]}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(Ie,{done:t.total_image_count>0?Math.round(t.labeled_image_count/t.total_image_count*100):0})}),(t==null?void 0:t.label_counts)&&e.jsxs("div",{className:"flex justify-around text-sm text-gray-700",children:[e.jsxs("span",{children:["Good: ",e.jsx("b",{children:t.label_counts.Good})]}),e.jsxs("span",{children:["Bad: ",e.jsx("b",{children:t.label_counts.Bad})]})]}),(t==null?void 0:t.split_counts)&&e.jsxs("div",{className:"flex justify-around text-sm text-gray-700",children:[e.jsxs("span",{children:["Train: ",e.jsx("b",{children:t.split_counts.train})]}),e.jsxs("span",{children:["Test: ",e.jsx("b",{children:t.split_counts.test})]}),e.jsxs("span",{children:["Val: ",e.jsx("b",{children:t.split_counts.val})]})]})]},t.version_id))})})},{label:"Select pre-processing methods",component:()=>e.jsx("div",{className:"p-4 bg-gray-100 rounded-lg w-full text-green-600",children:e.jsxs("div",{className:"flex flex-col rounded-lg p-4 shadow-md gap-3 mb-2 bg-white max-h-96 overflow-y-scroll",children:[e.jsx("p",{className:"text-green-600 font-semibold text-xl",children:"Pre-processing Methods"}),e.jsx(ge,{isPreprocessing:!0})]})})},{label:"Select Augmentations",component:()=>e.jsx("div",{className:"p-4 bg-gray-100 rounded-lg w-full text-green-600",children:e.jsxs("div",{className:"flex flex-col rounded-lg p-4 shadow-md gap-3 mb-2 bg-white max-h-96 overflow-y-scroll",children:[e.jsx("p",{className:"text-green-600 font-semibold text-xl",children:"Select Augmentations"}),e.jsx(ge,{isPreprocessing:!1})]})})},{label:"Select AI model",component:()=>{const t=[{id:"IVAI1",name:"PADIM",description:"PaDiM: Patch Distribution Modeling for anomaly detection"},{id:"IVAI2",name:"PatchCore",description:"PatchCore: Anomaly detection using patch-based representations"},{id:"IVAI3",name:"ReverseDistillation",description:"Reverse Distillation: Anomaly detection via knowledge distillation"}],u=n=>{ae(n),localStorage.setItem("selectedModel",n)};return e.jsx("div",{className:"p-4 bg-gray-100 rounded-lg w-full text-green-600",children:t.map((n,r)=>e.jsx("div",{className:`bg-white flex justify-center flex-col p-4 shadow-md border-[2px] rounded-lg text-center cursor-pointer w-full my-2 ${W===n.name?"border-green-600":""}`,onClick:()=>u(n.name),children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"flex gap-4 items-center",children:e.jsx("h4",{className:"font-medium",children:n.id})}),e.jsx("div",{className:"bg-blue-600 text-white rounded-full px-4 py-2",children:n.name==="PADIM"?"recommended":"beta"})]})},r))})}},{label:"Start training",component:()=>{const t=async()=>{var H;if(!W){m.error("Please select a model and versions",{position:"top-center",duration:4e3});return}const n=JSON.parse(localStorage.getItem("preProcessingConfigs")||"{}"),r=JSON.parse(localStorage.getItem("augmentationConfigs")||"{}"),v=[...Object.values(n),...Object.values(r)];console.log(me);const S={sku_id:i,version_id:me.join(","),augmentations:JSON.stringify(v),max_epochs:1,fetch_dataset_url:`http://localhost:8000/api/data-set/?sku_id=${i}&version_id=${me}&absolute_path=true`,seed:42,train_batch_size:16,eval_batch_size:16,devices:1,num_workers:2};console.log(S);try{const h=await w.post("http://localhost:8000/api/train-runner/",S,{headers:{accept:"application/json","Content-Type":"application/json"}}),ie=(H=h==null?void 0:h.data)==null?void 0:H["process.pid"];ie?(o(ie),m.success("Training started",{position:"top-center",duration:4e3}),localStorage.removeItem("preProcessingConfigs"),localStorage.removeItem("augmentationConfigs")):m.error("Training started, but no PID returned",{position:"top-center"})}catch(h){console.error("Failed to start training",h),m.error("Failed to start training",{position:"top-center",duration:4e3})}},u=async()=>{if(J)try{await w.delete(`http://localhost:8000/api/train-runner/${J}/`,{headers:{accept:"application/json"}}),m.success("Training stopped",{position:"top-center",duration:4e3}),o(null)}catch(n){console.error("Failed to stop training",n),m.error("Failed to stop training",{position:"top-center",duration:4e3})}};return e.jsxs("div",{className:"flex flex-col gap-4 items-center justify-center",children:[e.jsx("div",{className:"text-blue-600 flex text-5xl font-bold",children:"Train"}),e.jsx("div",{className:"flex items-center text-center text-green-600 text-lg font-semibold",children:"ML model training"}),J?e.jsx("button",{onClick:u,className:"bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded-full",children:"Stop Training"}):e.jsx("button",{onClick:t,className:"bg-primary hover:bg-green-600 text-white py-2 px-4 rounded-full",children:"Start Training"})]})}}],[fe,xe]=s.useState([]),[re,j]=s.useState(null);console.log(re),s.useEffect(()=>{(async()=>{var u;if(f==="testing")try{const v=(((u=(await w.get(`http://localhost:8000/api/model-explorer/?sku_id=${i}`,{headers:{accept:"application/json"}})).data)==null?void 0:u.model_files)||[]).map(S=>({name:S.name,path:S.absolute_path}));xe(v),v.length>0&&!re&&j(v[0].path),v.length===0&&m.error("No .ckpt files found",{position:"top-center"})}catch(n){console.error("Failed to fetch ckpt files:",n),m.error("Failed to fetch ckpt files",{position:"top-center"})}})()},[i,f]);const a=[{label:"Select dataset",component:()=>e.jsx("div",{className:"p-4 bg-gray-100 rounded-lg w-full text-green-600",children:e.jsx("div",{className:"flex flex-col rounded-lg p-4 shadow-md gap-3 mb-2 bg-white max-h-96 overflow-y-scroll",children:!T&&se.map(t=>e.jsxs("div",{className:"bg-white flex justify-center flex-col p-4 m-2 shadow-md rounded-lg text-center cursor-pointer",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex gap-4 items-center justify-center",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4 accent-blue-500",checked:P.includes(t.name),onChange:()=>M(t)}),e.jsx("img",{src:ve,alt:"",className:"w-4 h-4"}),e.jsx("h4",{className:"text-base font-medium",children:t.name})]}),e.jsxs("div",{className:"text-blue-500 font-semibold",children:[t.total_image_count," images"," ",e.jsx(we,{className:"w-5 h-5",fontSize:"small"})]})]}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(Ie,{done:t.total_image_count>0?Math.round(t.labeled_image_count/t.total_image_count*100):0})}),(t==null?void 0:t.label_counts)&&e.jsxs("div",{className:"flex justify-around text-sm text-gray-700",children:[e.jsxs("span",{children:["Good: ",e.jsx("b",{children:t.label_counts.Good})]}),e.jsxs("span",{children:["Bad: ",e.jsx("b",{children:t.label_counts.Bad})]})]}),(t==null?void 0:t.split_counts)&&e.jsxs("div",{className:"flex justify-around text-sm text-gray-700",children:[e.jsxs("span",{children:["Train: ",e.jsx("b",{children:t.split_counts.train})]}),e.jsxs("span",{children:["Test: ",e.jsx("b",{children:t.split_counts.test})]}),e.jsxs("span",{children:["Val: ",e.jsx("b",{children:t.split_counts.val})]})]})]},t.version_id))})})},{label:"Select AI model",component:()=>{const t=[{id:"IVAI1",name:"PADIM",description:"PaDiM: Patch Distribution Modeling for anomaly detection"},{id:"IVAI2",name:"PatchCore",description:"PatchCore: Anomaly detection using patch-based representations"},{id:"IVAI3",name:"ReverseDistillation",description:"Reverse Distillation: Anomaly detection via knowledge distillation"}],u=n=>{O(n),localStorage.setItem("selectedModelTest",n)};return e.jsx("div",{className:"p-4 bg-gray-100 rounded-lg w-full text-green-600",children:t.map((n,r)=>e.jsx("div",{className:`bg-white flex justify-center flex-col p-4 shadow-md border-[2px] rounded-lg text-center cursor-pointer w-full my-2 ${U===n.name?"border-green-600":""}`,onClick:()=>u(n.name),children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("div",{className:"flex gap-4 items-center",children:e.jsx("h4",{className:"font-medium",children:n.id})}),e.jsx("div",{className:"bg-blue-600 text-white rounded-full px-4 py-2",children:n.name==="PADIM"?"recommended":"beta"})]})},r))})}},{label:"Select Checkpoint",component:()=>e.jsxs("div",{className:"p-4 bg-gray-100 rounded-lg w-full",children:[e.jsx("div",{className:"text-blue-600 text-lg font-semibold mb-4",children:"Select Checkpoint"}),fe.length>0?e.jsx("div",{className:"flex flex-col gap-3",children:fe.map((t,u)=>e.jsxs("label",{className:`p-4 rounded-lg cursor-pointer border ${re===t.path?"border-green-600 bg-green-50":"border-gray-300"}`,children:[e.jsx("input",{type:"radio",name:"ckpt",className:"mr-2 accent-blue-600",checked:re===t.path,onChange:()=>j(t.path)}),t.name]},u))}):e.jsx("div",{className:"text-red-500 font-medium",children:"No checkpoint files available."})]})},{label:"Start testing",component:()=>{const t=async()=>{var n;if(!U||!re||!P){m.error("Please select dataset, model, and checkpoint",{position:"top-center"});return}try{const r={sku_id:i,version_id:Z.join(","),model_name:U,ckpt_path:re};console.log(r);const v=await w.post("http://localhost:8000/api/test-runner/",r,{headers:{accept:"application/json","Content-Type":"application/json"}}),S=(n=v==null?void 0:v.data)==null?void 0:n["process.pid"];S?(X(S),m.success("Testing started",{position:"top-center"})):m.error("Testing started, but no PID returned",{position:"top-center"})}catch(r){console.error("Failed to start testing",r),m.error("Failed to start testing",{position:"top-center"})}},u=async()=>{if(y)try{await w.delete(`http://localhost:8000/api/test-runner/${y}/`,{headers:{accept:"application/json"}}),m.success("Testing stopped",{position:"top-center"}),X(null)}catch(n){console.error("Failed to stop testing",n),m.error("Failed to stop testing",{position:"top-center"})}};return e.jsxs("div",{className:"flex flex-col gap-4 items-center justify-center",children:[e.jsx("div",{className:"text-blue-600 text-5xl font-bold",children:"Test"}),e.jsx("div",{className:"text-green-600 text-lg font-semibold",children:"ML model testing"}),y?e.jsx("button",{onClick:u,className:"bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded-full",children:"Stop Testing"}):e.jsx("button",{onClick:t,className:"bg-primary hover:bg-green-600 text-white py-2 px-4 rounded-full",children:"Start Testing"})]})}}],N=f==="training"?he:f==="testing"?a:[],L=()=>{g(!0),x(null),c(0),E(new Set)},pe=()=>{g(!1),x(null),c(0),E(new Set),setTimeout(()=>{window.location.reload()},1e3)},ze=()=>{k<N.length-1&&c(t=>t+1)};function Pe({skuId:t}){const[u,n]=s.useState([]),[r,v]=s.useState(null),[S,H]=s.useState([]),[h,ie]=s.useState(null),oe="http://localhost:8000",ye="test_runs";s.useEffect(()=>{w.get(`${oe}/api/file-explorer/`,{params:{sku_id:t,path:ye},headers:{accept:"application/json"}}).then(l=>{n(l.data.directories||[])}).catch(l=>console.error("Error fetching folders:",l))},[t]),s.useEffect(()=>{if(!r){H([]);return}const l=`${ye}/${r.name}`;w.get(`${oe}/api/file-explorer/`,{params:{sku_id:t,path:l},headers:{accept:"application/json"}}).then(I=>{const C=(I.data.files||[]).filter(Y=>/\.(jpg|jpeg|png|webp|bmp|gif)$/i.test(Y.url));H(C)}).catch(I=>console.error("Error fetching files:",I))},[r,t]);const be=l=>{v(I=>(I==null?void 0:I.name)===l.name?null:l)};return e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"flex flex-col rounded-lg p-4 shadow-md gap-3 my-4 bg-white min-h-[540px]",children:[e.jsx("div",{className:"flex justify-between items-center px-4",children:e.jsx("h1",{className:"text-blue-500 font-semibold text-md",children:"Recent Executions"})}),u.length===0?e.jsx("p",{className:"text-center text-gray-500 mt-8",children:"No folders found"}):u.map(l=>e.jsxs("div",{onClick:()=>be(l),className:"bg-white flex flex-col gap-2 p-4 shadow-md border rounded-lg cursor-pointer hover:bg-blue-50 transition",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:"font-medium",children:l.name}),e.jsxs("div",{className:"text-blue-600 font-semibold flex items-center gap-1",children:[(r==null?void 0:r.name)===l.name?"Close report":"View full report",e.jsx(we,{className:"text-green-600",size:16})]})]}),(r==null?void 0:r.name)===l.name&&e.jsx("div",{className:"mt-3",children:S.length===0?e.jsx("p",{className:"text-gray-500",children:"No image files found"}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4 mt-2",children:S.map((I,ee)=>e.jsx("div",{onClick:()=>ie(I.url),className:"border rounded shadow p-1 cursor-pointer hover:scale-[1.02] transition",children:e.jsx("img",{src:I.url,alt:`Preview ${ee}`,className:"w-full h-32 object-fill rounded"})},ee))})})]},l.name)),h&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50",onClick:()=>ie(null),children:e.jsxs("div",{className:"bg-white p-4 rounded shadow-lg max-w-4xl w-[90%] relative",onClick:l=>l.stopPropagation(),children:[e.jsx("button",{onClick:()=>ie(null),className:"absolute right-0 top-0 p-1 m-1 text-red-500 outline-none border rounded-full",children:e.jsx(at,{size:16,strokeWidth:2.4})}),e.jsx("img",{src:h,alt:"Preview",className:"w-full max-h-[80vh] object-contain rounded my-4"})]})})]})})}return e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:L,className:"bg-primary hover:bg-green-600 text-white py-2 px-4 rounded-full flex items-center gap-2",children:"New Performance Evaluation"})}),e.jsx(Pe,{skuId:i}),A&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:pe}),e.jsxs("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[600px] bg-white shadow-lg rounded-lg p-6 z-50",children:[e.jsx("button",{onClick:pe,className:"absolute top-4 right-4 text-green-600 hover:text-green-800",children:"✕"}),f?e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"relative mb-8",children:[e.jsx("div",{className:"absolute top-5 left-[6.5%] right-[6.5%] h-1 bg-gray-300 z-0 w-[84%]"}),e.jsx("div",{className:"absolute top-5 left-[6.5%] h-1 bg-green-600 z-10 transition-all duration-300",style:{width:`${Math.min(k/(N.length-1)*90,90)}%`}}),e.jsx("div",{className:"flex justify-between items-start relative z-10",children:N.map((t,u)=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center border-2 text-sm font-medium 
                            ${u<=k?"bg-green-600 border-green-600 text-white":"bg-white border-gray-300 text-gray-500"}`,children:u+1}),e.jsx("span",{className:"text-xs mt-2 text-center max-w-[140px]",children:t.label})]},u))})]}),k<N.length&&e.jsx("div",{className:"mt-4 w-full",children:N[k].component()}),e.jsx("div",{className:"flex flex-col pt-4",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col gap-2 items-center justify-center",children:[k<N.length-1&&e.jsx("button",{onClick:ze,className:"w-48 m-2 py-2 px-4 rounded-full gap-2 text-white bg-primary hover:bg-green-600",children:k===N.length-1?"Start":"Next"}),k===N.length-1?e.jsx(e.Fragment,{}):e.jsxs("div",{className:"text-sm text-center",children:[e.jsx("span",{className:"font-semibold",children:"Disclaimer: "}),e.jsx("span",{children:"Proceeding to the next step may finalize your current choices. Please review your inputs carefully. Changes might not be possible later."})]})]})})})]}):e.jsxs("div",{className:"flex flex-col gap-4 items-center p-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 items-center justify-center",children:[e.jsx("div",{className:"text-blue-600 flex text-5xl font-bold",children:"Train"}),e.jsx("div",{className:"flex items-center text-center",children:"Got fresh data? Let’s teach your model how to make smart decisions. Select your annotations and start training!"}),e.jsx("button",{onClick:()=>x("training"),className:"bg-primary hover:bg-green-600 text-white py-2 px-4 rounded-full flex items-center gap-2",children:"Start Training"})]}),e.jsx("div",{className:"bg-black h-[1px] my-4 w-full"}),e.jsxs("div",{className:"flex flex-col gap-4 items-center justify-center",children:[e.jsx("div",{className:"text-blue-600 flex text-5xl font-bold",children:"Test"}),e.jsx("div",{className:"flex items-center text-center",children:"Already have a model? Let’s see how well it performs. Run it on test data and check the results."}),e.jsx("button",{onClick:()=>x("testing"),className:"bg-primary hover:bg-green-600 text-white py-2 px-4 rounded-full flex items-center gap-2",children:"Start Testing"})]})]})]})]})]})},Fe="http://localhost:8000/api/ai-camera/",ns=({skuId:i,version:p,tags:D,configPath:T})=>{const[A,g]=s.useState(!1),[f,x]=s.useState(null),k=async()=>{var z;try{const E={sku_id:i.toString(),version_id:p.toString(),tag_name:D,end_point_url:"http://localhost:8000/api/capture-images/",camera_config_file:T||"C:\\Users\\reach\\Downloads\\default_camera.Config"};console.log(E);const F=await w.post(Fe,E,{headers:{"Content-Type":"application/json"}}),q=F.data["process.pid"]||((z=F.data.process)==null?void 0:z.pid);q?(x(q),g(!0),console.log("Terminal opened with PID:",q)):console.error("PID not found in response:",F.data)}catch(E){console.error("Error opening terminal:",E)}},c=async()=>{var z,E;if(f)try{const F=await w.delete(`${Fe}${f}/`);(E=(z=F.data)==null?void 0:z.message)!=null&&E.includes("terminated")?(console.log(F.data.message),g(!1),x(null)):console.error("Unexpected response:",F.data)}catch(F){console.error("Error closing terminal:",F)}};return e.jsx("div",{className:"mt-4",children:A?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:c,disabled:!A,className:"bg-red-500 text-white px-4 py-2 rounded ml-2",children:"Stop Camera"}),f&&e.jsxs("p",{className:"text-sm mt-2 text-gray-700",children:["Active PID: ",f]})]}):e.jsx(e.Fragment,{children:e.jsx("button",{onClick:k,disabled:A,className:"bg-green-200 px-4 py-2 rounded",children:"Load from Indus Vision camera"})})})},ls=({isOpen:i,onClose:p,skuId:D,versionId:T,onSuccess:A})=>{const[g,f]=s.useState([70,90]),[x,k]=s.useState(!1),c=s.useRef(null),z=(W,ae)=>{if(!c.current)return;const ne=c.current.getBoundingClientRect(),de=ae-ne.left,me=Math.min(100,Math.max(0,de/ne.width*100)),b=[...g];W===0?b[0]=Math.min(me,g[1]-5):b[1]=Math.max(me,g[0]+5),f(b)},E=W=>ae=>{const ne=me=>z(W,me.clientX),de=()=>{document.removeEventListener("mousemove",ne),document.removeEventListener("mouseup",de)};document.addEventListener("mousemove",ne),document.addEventListener("mouseup",de)},F=Math.round(g[0]),q=Math.round(g[1]-g[0]),se=100-F-q,ue=async()=>{try{k(!0);const W=await w.post("http://localhost:8000/api/split-data-set/",{sku_id:D,version_id:T,train_split:F,val_split:q,test_split:se});m.success(W.data.message||"Split successful"),p(),A&&A()}catch(W){console.log(W)}finally{k(!1)}};return i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:p}),e.jsxs("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[700px] bg-white shadow-xl rounded-lg p-6 z-50",children:[e.jsx("button",{onClick:p,className:"absolute top-4 right-4 text-green-600 hover:text-green-800 text-xl font-bold",children:"✕"}),e.jsx("h2",{className:"text-2xl font-semibold text-center mb-6 text-green-700",children:"Dataset Split for Version"}),e.jsxs("div",{className:"flex justify-between mb-4 px-2 text-sm font-medium text-gray-700",children:[e.jsxs("span",{children:["Train: ",F,"%"]}),e.jsxs("span",{children:["Val: ",q,"%"]}),e.jsxs("span",{children:["Test: ",se,"%"]})]}),e.jsxs("div",{ref:c,className:"relative h-4 bg-gray-200 rounded-full mb-6 select-none",children:[e.jsx("div",{className:"absolute h-full bg-green-500 rounded-l-full",style:{width:`${g[0]}%`}}),e.jsx("div",{className:"absolute h-full bg-blue-500",style:{left:`${g[0]}%`,width:`${g[1]-g[0]}%`}}),e.jsx("div",{className:"absolute h-full bg-red-500 rounded-r-full",style:{left:`${g[1]}%`,width:`${100-g[1]}%`}}),g.map((W,ae)=>e.jsx("div",{className:"absolute top-1/2 transform -translate-y-1/2 -translate-x-1/2 w-5 h-5 bg-white border-2 border-green-600 rounded-full cursor-pointer z-10",style:{left:`${W}%`},onMouseDown:E(ae)},ae))]}),e.jsx("button",{onClick:ue,className:"bg-green-600 hover:bg-green-700 text-white py-2 px-6 rounded-full",disabled:x,children:x?"Splitting...":"Submit Split"})]})]}):null},Be=({title:i,message:p,onConfirm:D,onCancel:T,confirmDisabled:A,children:g})=>e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg w-[90%] max-w-md relative",children:[e.jsx("button",{className:"absolute top-2 right-2 text-gray-600",onClick:T,children:"✕"}),e.jsx("h2",{className:"text-xl font-semibold mb-4",children:i}),e.jsx("p",{className:"mb-4",children:p}),g,e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx("button",{onClick:D,className:`px-3 py-1 text-white rounded-full bg-blue-600 hover:bg-blue-700
            }`,children:"Confirm"}),e.jsx("button",{onClick:T,className:"px-3 py-1 bg-gray-600 text-white rounded-full hover:bg-gray-700",children:"Cancel"})]})]})}),xs=()=>{const{workspaceId:i,skuId:p}=Le(),[D,T]=Ce(),A=D.get("version"),g=D.get("tab")||"Versions",f=Ee(),[x,k]=s.useState([]),[c,z]=s.useState([]),[E,F]=s.useState(A),q=async()=>{try{const b=await w.get(`http://localhost:8000/api/sku/${p}/`);z(b.data.results||[])}catch(b){console.error("Error fetching versions:",b)}},se=async()=>{try{const b=await w.get(`http://localhost:8000/api/versions/?sku=${p}`);k(b.data.results||[])}catch(b){console.error("Error fetching versions:",b)}};s.useEffect(()=>{q(),se()},[]),s.useEffect(()=>{q(),se()},[p,A]),s.useEffect(()=>{F(A)},[A]);const ue=s.memo(({sku:b})=>{const[Q,B]=s.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>B(!0),className:"text-white px-4 py-2 bg-blue-600 hover:bg-blue-500 text-sm rounded-full transition",children:"Create Version"}),e.jsx(Ve,{title:"",description:e.jsx(bt,{sku:b,onSuccess:()=>{se(),B(!1)},onCancel:()=>B(!1)}),hideFooter:!0,open:Q,onOpenChange:B})]})}),W=({skuId:b})=>{const[Q,B]=s.useState(null),[G,P]=Ce(),[te,U]=s.useState(!1),[O,Z]=s.useState([]),[$,M]=s.useState(!1),[J,o]=s.useState(!1),[y,X]=s.useState(""),[_,V]=s.useState({source_version_ids:[],target_version_id:null,overwrite:!1,skip_duplicates:!0,delete_source:!1}),le=a=>{Z(d=>d.includes(a)?d.filter(N=>N!==a):[...d,a])},je=()=>{if(O.length!==1){alert("Please select exactly one version to rename.");return}const a=x.find(d=>d.id===O[0]);X(a.name),o(!0)},ge=async()=>{if(!y){alert("Please enter a version name.");return}try{await w.put(`http://localhost:8000/api/versions/${O[0]}/`,{name:y,sku:parseInt(b)},{headers:{accept:"application/json","Content-Type":"application/json"}}),console.log("Rename successful"),o(!1),Z([]),U(!1),m.success("Version renamed",{position:"top-center",duration:4e3}),window.location.reload()}catch(a){console.error("Rename failed:",a),alert("Failed to rename version.")}},he=()=>{if(O.length<2){alert("Please select at least two versions to merge.");return}M(!0)},fe=async()=>{if(O.length===0){alert("Please select at least one version to delete.");return}try{for(const a of O)await w.delete(`http://localhost:8000/api/versions/${a}/`,{headers:{accept:"application/json"}});console.log("Deleted versions:",O),Z([]),se(),m.success("deleted version",{position:"top-center",duration:4e3}),U(!1)}catch(a){console.error("Delete failed:",a),alert("Failed to delete one or more versions.")}},xe=()=>{U(!1),Z([])},re=async()=>{if(!_.source_version_ids.length||!_.target_version_id){alert("Please select source and target versions.");return}try{const a=await w.post("http://localhost:8000/api/sku-images/merge-versions/",{source_version_id:_.source_version_ids.join(","),target_version_id:parseInt(_.target_version_id),sku_id:parseInt(b),overwrite:_.overwrite,skip_duplicates:_.skip_duplicates,delete_source:_.delete_source},{headers:{accept:"application/json","Content-Type":"application/json"}});console.log("Merge successful:",a.data),M(!1),Z([]),U(!1),m.success("Versions merged",{position:"top-center",duration:4e3}),window.location.reload()}catch(a){console.error("Merge failed:",a),alert("Failed to merge versions.")}},j=()=>{M(!1)};return e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"flex gap-16 justify-end items-end mb-2",children:e.jsx(ue,{sku:b})}),e.jsxs("div",{className:"flex items-center p-2 justify-between bg-gray-200 rounded-full mb-2",children:[$&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg w-[90%] max-w-md relative",children:[e.jsx("button",{className:"absolute top-2 right-2 text-gray-600",onClick:j,children:"✕"}),e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Merge Versions"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Source Version"}),e.jsxs("select",{className:"w-full p-2 border rounded",multiple:!0,value:_.source_version_ids||[],onChange:a=>V({..._,source_version_ids:Array.from(a.target.selectedOptions,d=>d.value)}),children:[e.jsx("option",{value:"",disabled:!0,children:"Select Source Version"}),O.map(a=>{const d=x.find(N=>N.id===a);return e.jsx("option",{value:a,children:d.name},a)})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Target Version"}),e.jsxs("select",{className:"w-full p-2 border rounded",value:_.target_version_id||"",onChange:a=>V({..._,target_version_id:a.target.value}),children:[e.jsx("option",{value:"",disabled:!0,children:"Select Target Version"}),O.map(a=>{const d=x.find(N=>N.id===a);return e.jsx("option",{value:a,children:d.name},a)})]})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:_.overwrite,onChange:a=>V({..._,overwrite:a.target.checked})}),"Overwrite Images"]})}),e.jsx("div",{className:"mb-4",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:_.skip_duplicates,onChange:a=>V({..._,skip_duplicates:a.target.checked})}),"Skip Duplicate Images"]})}),e.jsx("div",{className:"mb-4",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:_.delete_source,onChange:a=>V({..._,delete_source:a.target.checked})}),"Delete Source Images"]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white hover:bg-blue-700 rounded-full",onClick:re,children:"Confirm Merge"}),e.jsx("button",{className:"px-3 py-1 bg-gray-600 text-white hover:bg-gray-700 rounded-full",onClick:j,children:"Cancel"})]})]})}),e.jsxs("div",{className:"px-4 font-semibold",children:["Total Versions : ",x.length," "]}),te?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white hover:bg-blue-700 rounded-full",onClick:he,children:"Merge Version"}),e.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white hover:bg-blue-700 rounded-full",onClick:je,disabled:O.length!==1,children:"Rename Version"}),e.jsx("button",{className:"px-3 py-1 bg-red-600 text-white hover:bg-red-700 rounded-full",onClick:fe,children:"Delete Version"}),e.jsx("button",{className:"px-3 py-1 bg-gray-600 text-white hover:bg-gray-700 rounded-full",onClick:xe,children:"Back"})]}):e.jsxs("button",{className:"px-3 py-1 bg-red-600 text-white flex justify-center items-center gap-4 hover:bg-red-700 rounded-full",onClick:()=>U(!0),children:["Bulk Version Edit ",e.jsx("img",{src:Re,alt:"Delete",className:"w-4 h-4"})]}),J&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg w-[90%] max-w-md relative",children:[e.jsx("button",{className:"absolute top-2 right-2 text-gray-600",onClick:()=>o(!1),children:"✕"}),e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Rename Version"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Version Name"}),e.jsx("input",{type:"text",className:"w-full p-2 border rounded",value:y,onChange:a=>X(a.target.value),placeholder:"Enter new version name"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white hover:bg-blue-700 rounded-full",onClick:ge,children:"Confirm Rename"}),e.jsx("button",{className:"px-3 py-1 bg-gray-600 text-white hover:bg-gray-700 rounded-full",onClick:()=>o(!1),children:"Cancel"})]})]})})]}),x.length>0?e.jsx(e.Fragment,{children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:x.map(a=>e.jsxs("div",{onClick:()=>!te&&(B(a.id),P({tab:"SKU data",version:a.id})),className:`flex items-center justify-center flex-col gap-2 p-3 text-center rounded-lg shadow hover:bg-gray-100 cursor-pointer relative ${O.includes(a.id)?"bg-blue-100 border-2 border-blue-600":""} ${te?"cursor-default":""}`,children:[te&&e.jsx("input",{type:"checkbox",checked:O.includes(a.id),onChange:()=>le(a.id),className:"absolute top-2 left-2",onClick:d=>d.stopPropagation()}),e.jsx("img",{src:ve,alt:"",className:"w-8 h-8"}),e.jsx("h4",{className:"text-base font-medium",children:a==null?void 0:a.name}),e.jsxs("h4",{className:"text-base font-medium",children:["Total images :",a==null?void 0:a.total_image_count]})]},a.id))})}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-3 text-2xl font-semibold text-[#BEBEBE] items-center justify-center min-h-[560px]",children:[e.jsx("div",{className:"flex",children:"No Versions to show"}),e.jsx("div",{className:"flex",children:"Click on Create Version button to create one"})]})}),Q&&g==="SKU data"&&e.jsx("div",{className:"p-4 border rounded-lg shadow bg-gray-100",children:e.jsx(ne,{skuId:b,version:Q})})]})},ae=({skuId:b})=>{const Q=async()=>{try{const o=await w.get(`http://localhost:8000/api/final-data-set/?sku_id=${b}`),y={};Object.entries(o.data||{}).forEach(([X,_])=>{const V={train:0,test:0,val:0};_.images.forEach(le=>{le.split_label&&V[le.split_label]!==void 0&&V[le.split_label]++}),y[X]={..._,counts:V,count:_.images.length}}),M(y)}catch(o){console.error("Failed to fetch datasets",o)}},[B,G]=s.useState(""),[P,te]=s.useState(!1),[U,O]=s.useState(null),Z=o=>{O(o),te(!0)},[$,M]=s.useState({});s.useEffect(()=>{Q()},[b]);const J=async o=>{var y;try{const _=(y=(await w.get(`http://localhost:8000/api/sku-images-list/?sku_id=${b}&version_id=${o}`)).data.results)==null?void 0:y.map(V=>({id:V.id,name:V.original_filename,url:`http://localhost:8000${V.image}`}));if(_&&_.length>0){G(o);const V=_[0].id;f(`/client/workspaces/${i}/sku/${b}/image/${V}?tab=Annotate&version=${o}`)}else G(""),m.error("No images to display for this version",{position:"top-center",duration:4e3})}catch(X){console.error("Failed to fetch images",X),m.error("Failed to fetch images",{position:"top-center",duration:4e3})}};return e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"flex flex-col rounded-lg p-4 shadow-md gap-3 mb-2 bg-white",children:[e.jsx("h1",{className:"text-[#43996A] font-bold text-center text-xl",children:"Versions"}),!B&&x.map(o=>e.jsxs("div",{onClick:()=>J(o.id),className:"bg-white flex justify-center flex-col p-4 m-2 shadow-md hover:bg-slate-100 rounded-lg text-center cursor-pointer",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex gap-4 items-center justify-center",children:[e.jsx("img",{src:ve,alt:"",className:"w-4 h-4"}),e.jsx("h4",{className:"text-base font-medium",children:o.name})]}),e.jsxs("button",{className:" text-blue-600 hover:text-blue-800 font-bold flex items-center gap-1",onClick:y=>{if(y.stopPropagation(),(o==null?void 0:o.labeled_image_count)<4){m.error("At least 4 annotated images are required!",{position:"top-center",duration:4e3});return}Z(o.id)},children:[e.jsxs("span",{children:[o==null?void 0:o.total_image_count," images"]}),e.jsx(we,{className:"w-5 h-5"})]})]}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(Ie,{done:o.total_image_count>0?Math.round(o.labeled_image_count/o.total_image_count*100):0})}),e.jsxs("div",{className:"flex flex-col gap-1 items-start justify-start px-12",children:[e.jsxs("div",{className:"text-blue-500 font-semibold",children:["Annotated : ",o==null?void 0:o.labeled_image_count]}),e.jsxs("div",{className:"text-yellow-500 font-semibold",children:["Unannotated : ",o==null?void 0:o.unlabeled_image_count]}),e.jsxs("div",{className:"text-red-500 font-semibold",children:["Rejected : ",(o==null?void 0:o.rejected)||0]})]})]},o.id))]}),e.jsxs("div",{className:"flex flex-col rounded-lg p-4 shadow-md gap-3 mb-2 bg-white",children:[e.jsx("h1",{className:"text-[#43996A] font-bold text-center justify-center items-center text-xl",children:"Datasets"}),!B&&Object.entries($).map(([o,y])=>e.jsxs("div",{onClick:()=>T({tab:"Dataset",version:y==null?void 0:y.version_id}),className:"bg-white flex flex-col gap-2 p-4 m-2 shadow-md hover:bg-slate-100 rounded-lg text-center cursor-pointer",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsx("img",{src:ve,alt:"",className:"w-4 h-4"}),e.jsx("h4",{className:"text-base font-medium",children:o})]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["Total Images: ",e.jsx("span",{className:"font-semibold",children:y==null?void 0:y.count})]})]}),e.jsxs("div",{className:"flex justify-around text-sm text-gray-700",children:[e.jsxs("span",{children:["Train: ",e.jsx("b",{children:y.counts.train})]}),e.jsxs("span",{children:["Test: ",e.jsx("b",{children:y.counts.test})]}),e.jsxs("span",{children:["Val: ",e.jsx("b",{children:y.counts.val})]})]})]},o))]}),P&&U!==null&&e.jsx(ls,{isOpen:P,onClose:()=>te(!1),skuId:b,versionId:U,onSuccess:Q})]})})},ne=({skuId:b,version:Q,mode:B="images"})=>{const[G]=Ce();G.get("version");const P=G.get("tab"),[te,U]=s.useState(!1),[O,Z]=s.useState(()=>{}),[$,M]=s.useState(""),[J,o]=s.useState([]),[y,X]=s.useState([]),[_,V]=s.useState(null),le=async()=>{try{const j=B==="dataset"?`http://localhost:8000/api/data-set/?sku_id=${b}&version_id=${Q}&absolute_path=false`:`http://localhost:8000/api/sku-images-list/?sku_id=${b}&version_id=${Q}`,a=await w.get(j),d=B==="dataset"?a.data:a.data.results,N=d==null?void 0:d.map((L,pe)=>({id:L.id??pe,name:L.original_filename??`Image ${pe+1}`,url:L.image.startsWith("http")?L.image:`http://localhost:8000${L.image}`,split:L.split_label||null,label_id:L.label_id,label_name:L.label_name||"",label_color_code:L.label_color_code,rejected:L.rejected}));o(N||[])}catch(j){console.error("Failed to fetch images",j)}};s.useEffect(()=>{le()},[b,Q,B]);const je=j=>{X(a=>a.includes(j)?a.filter(d=>d!==j):[...a,j])},ge=j=>{M("Are you sure you want to delete this image?"),Z(()=>async()=>{try{await w.delete("http://localhost:8000/api/sku-images/",{data:{image_ids:[j]}}),m.success("Image deleted successfully",{position:"top-center",duration:4e3}),le()}catch{m.error("Failed to delete image",{position:"top-center",duration:4e3})}finally{U(!1)}}),U(!0)},he=()=>{if(y.length===0){m.error("Please select images to delete.",{position:"top-center",duration:4e3});return}M(`Are you sure you want to delete ${y.length} image(s)?`),Z(()=>async()=>{try{await w.delete("http://localhost:8000/api/sku-images/",{data:{image_ids:y}}),m.success("Images deleted successfully",{position:"top-center",duration:4e3}),le(),X([])}catch{m.error("Failed to delete images",{position:"top-center",duration:4e3})}finally{U(!1)}}),U(!0)},fe=j=>V(j),xe=s.memo(({src:j,alt:a})=>e.jsx(Ve,{title:"",description:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("img",{src:j,alt:a,className:"w-full h-auto max-h-[80vh] object-contain rounded"}),e.jsx("h1",{className:"mt-2",children:a})]}),children:e.jsx("button",{className:"bg-green-500 text-white text-xs px-3 py-1 rounded shadow",children:"Preview"})})),re={train:"bg-blue-600",val:"bg-yellow-500",test:"bg-red-500"};return e.jsxs(e.Fragment,{children:[te&&e.jsx(Be,{title:"Confirm Delete",message:$,onCancel:()=>U(!1),onConfirm:O}),e.jsx("div",{className:"flex justify-end items-end mb-2 gap-4",children:B==="images"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:he,className:"px-3 py-1 bg-red-600 text-white rounded-full",children:"Bulk Delete"}),e.jsx("button",{onClick:()=>T({tab:"upload",version:Q}),className:"text-white text-md font-semibold bg-blue-600 rounded-full py-1 px-3",children:"Upload Files"})]})}),J.length>0?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4 p-4",children:J.map((j,a)=>e.jsxs("div",{className:"border rounded group p-2 relative",children:[e.jsx("span",{className:`absolute top-2 left-2 z-10 text-white text-xs font-bold px-2 py-1 rounded-full 
                    ${P==="SKU data"?`bg-${j.label_color_code}-600`:re[j.split]||"bg-gray-600"}`,children:P==="SKU data"?j.label_name||"":j.split||""}),e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:j.url,alt:j.name,onClick:()=>fe(a),className:"w-full h-28 object-cover rounded mb-2 cursor-pointer"}),B==="images"&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-40 opacity-0 group-hover:opacity-100 transition",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(xe,{src:j.url,alt:j.name}),e.jsx("button",{onClick:()=>ge(j.id),className:"bg-red-500 text-white text-xs px-3 py-1 rounded shadow",children:"Delete"})]})})]}),B==="images"&&e.jsxs("div",{className:"flex gap-2 px-2 py-1 text-xs bg-white items-center",children:[e.jsx("input",{type:"checkbox",checked:y.includes(j.id),onChange:()=>je(j.id),className:"cursor-pointer"}),e.jsx("span",{className:"text-black truncate w-28",title:j.name,children:j.name})]})]},j.id))}):e.jsx("div",{className:"text-center text-gray-400 font-medium py-24",children:"No images to show."})]})},de=({skuId:b,version:Q,tags:B})=>{const[G,P]=s.useState(!1),[te,U]=s.useState(()=>{}),[O,Z]=s.useState(""),[$,M]=s.useState([]),[J,o]=s.useState(ke),[y,X]=s.useState(!1),[_,V]=s.useState({allowDuplicates:!1,overwrite:!1}),le=a=>{a.preventDefault(),a.stopPropagation(),X(!0)},je=a=>{a.preventDefault(),a.stopPropagation(),X(!1)},ge=a=>{a.preventDefault(),a.stopPropagation(),X(!1);const d=a.dataTransfer.files;he(d)},he=a=>{if(!a)return;const d=Array.from(a).filter(N=>["image/jpeg","image/jpg","image/png","image/bmp"].includes(N.type)).map(N=>({file:N,name:N.name,preview:URL.createObjectURL(N)}));M(N=>[...N,...d])},fe=a=>{M(d=>{const N=d.filter((L,pe)=>pe!==a);return d[a].preview===J&&o(ke),N})},xe=async(a=_)=>{var N;const d=new FormData;$.forEach(({file:L})=>d.append("images",L)),d.append("sku_id",b),d.append("tags",B),d.append("version_name",Q),d.append("version_id",Q),d.append("allow_duplicates",a.allowDuplicates.toString()),d.append("overwrite",a.overwrite.toString()),console.log("Submitting with options:",a);try{const L=await w.post("http://localhost:8000/api/sku-images/",d);((N=L.data.skipped)==null?void 0:N.length)>0&&L.data.skipped.some(pe=>pe.reason.includes("Duplicate"))?(Z(`${L.data.skipped.length} image(s) were skipped due to duplication. Select options to re-upload.`),P(!0)):(m.success("Upload successful!",{position:"top-center",duration:4e3}),T({tab:"SKU data",version:Q}),M([]),o(ke),V({allowDuplicates:!1,overwrite:!1}))}catch(L){console.error("Upload error:",L),m.error("Upload failed.",{position:"top-center",duration:4e3})}},re=async()=>{console.log("handleReupload called with modalOptions:",_),P(!1),await xe(_)},j=()=>{if($.length===0){m.error("No images to upload",{position:"top-center",duration:4e3});return}xe()};return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Upload SKU Data"}),e.jsx("button",{onClick:j,className:"bg-blue-600 rounded-full text-white px-6 py-2",children:"Save"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"border-2 rounded-md border-dashed border-green-400 p-6 flex flex-col items-center justify-center",children:[e.jsx("img",{src:ct,alt:"Camera Icon",className:"w-16 h-16 mb-2"}),e.jsx(ns,{skuId:b,version:Q,tags:B,configPath:"C:\\\\Users\\\\reach\\\\Downloads\\\\Muesli Nuts Delight 1kg.Config"})]}),e.jsxs("div",{className:`border-2 border-dashed rounded-md p-6 text-center flex items-center justify-center transition-colors duration-200 ${y?"border-green-500 bg-green-50":"border-blue-400"}`,onDragOver:le,onDragLeave:je,onDrop:ge,children:[e.jsx("input",{type:"file",accept:".jpg,.jpeg,.png,.bmp",multiple:!0,className:"hidden",id:"fileInput",onChange:a=>he(a.target.files)}),e.jsxs("label",{htmlFor:"fileInput",className:"cursor-pointer flex flex-col justify-center items-center",children:[e.jsx("img",{src:dt,alt:"Upload Icon",className:"mb-4 w-24 h-24"}),e.jsx("div",{className:"text-white text-lg font-semibold bg-blue-600 rounded-full p-2",children:"Click to upload files from device"}),e.jsx("div",{className:"text-md text-gray-500 mt-1",children:"or drag and drop files here"}),e.jsxs("div",{className:"text-md mt-1",children:[e.jsx("span",{className:"text-red-400",children:"*"})," Files supported: .jpeg .jpg .png .bmp"]})]})]})]}),$.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"List of files uploading"}),$.length===0?e.jsx("div",{className:"text-gray-500 flex justify-center items-center text-lg border p-4 rounded h-64",children:"No files have been uploaded."}):e.jsx("div",{className:"grid gap-4 max-h-96 overflow-y-auto",children:$.map((a,d)=>e.jsxs("div",{className:"px-4 py-2 border rounded shadow-sm flex justify-between items-center bg-gray-100",children:[e.jsx("img",{src:a.preview,alt:`preview-${d}`,className:"w-16 h-16 object-fill rounded cursor-pointer",onClick:()=>o(a.preview)}),e.jsx("div",{children:a.name}),e.jsx("button",{onClick:()=>fe(d),title:"Delete",className:"ml-2",children:e.jsx("img",{src:mt,alt:"Delete"})})]},d))})]}),e.jsx("div",{className:"mt-6 flex",children:e.jsx("img",{src:J,alt:"Selected Preview",className:"w-full h-96 object-fill rounded"})})]}),G&&e.jsxs(Be,{title:"Re-upload Confirmation",message:O,onConfirm:re,onCancel:()=>{P(!1),V({allowDuplicates:!1,overwrite:!1})},children:[e.jsx("div",{className:"mb-4",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:_.allowDuplicates,onChange:a=>{const d=a.target.checked;console.log("allowDuplicates checkbox changed:",d),V(N=>({...N,allowDuplicates:d}))},className:"cursor-pointer"}),"Allow Duplicates"]})}),e.jsx("div",{className:"mb-4",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:_.overwrite,onChange:a=>{const d=a.target.checked;console.log("overwrite checkbox changed:",d),V(N=>({...N,overwrite:d}))},className:"cursor-pointer"}),"Overwrite Images"]})})]})]}):e.jsx(e.Fragment,{})]})},me=({skuId:b,version:Q,tags:B})=>{const[G,P]=s.useState({labelName:"",shortcutKey:"",colorCode:"#EEE"}),[te,U]=s.useState(0),[O,Z]=s.useState(!1);s.useEffect(()=>{O||P({labelName:"",shortcutKey:"",colorCode:"#EEE"})},[O]);const $=async()=>{var M,J;try{await w.post("http://localhost:8000/api/label/",{name:G.labelName,sku_id:b,shortcut_key:G.shortcutKey.toUpperCase(),color_code:G.colorCode,is_active:!0}),m.success("Label added successfully!",{position:"top-center",duration:4e3}),P({labelName:"",shortcutKey:"",colorCode:"#000"}),U(o=>o+1),Z(!1)}catch(o){const y=(J=(M=o==null?void 0:o.response)==null?void 0:M.data)==null?void 0:J.message;m.error(y||"Failed to add label",{position:"top-center",duration:4e3})}};return e.jsxs("div",{className:"flex flex-col gap-2",children:[B=="AnamolyDetection"?e.jsx(e.Fragment,{}):e.jsx(e.Fragment,{children:e.jsx(De,{title:"Add New Labels",description:e.jsx("div",{children:e.jsxs("form",{onSubmit:M=>M.preventDefault(),children:[e.jsx("input",{type:"text",className:"w-full px-2 py-1 border rounded-full my-2",placeholder:"Label name",value:G.labelName,onChange:M=>P({...G,labelName:M.target.value})}),e.jsx("input",{type:"text",className:"w-full px-2 py-1 border rounded-full mb-2",placeholder:"Keyboard Shortcut key (e.g., G)",value:G.shortcutKey,onChange:M=>P({...G,shortcutKey:M.target.value})}),e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium mb-2",children:["Select color:",e.jsx("input",{type:"color",className:"h-8 w-10 rounded-full border",value:G.colorCode,onChange:M=>P({...G,colorCode:M.target.value})})]})]})}),onConfirm:$,open:O,onOpenChange:Z,children:e.jsx("div",{className:"flex items-end justify-end",children:e.jsx("button",{className:"w-32 px-3 py-1 bg-blue-600 text-white flex justify-center items-center gap-4 hover:bg-blue-500 rounded-full",children:"Add Labels"})})})}),e.jsx(ht,{skuId:b,refreshKey:te,tags:B})]})};return e.jsxs("div",{className:"p-4",children:[g==="Versions"&&e.jsx(W,{skuId:c==null?void 0:c.id}),g==="SKU data"&&e.jsx(ne,{skuId:c==null?void 0:c.id,version:A,mode:"images"}),g==="Dataset"&&e.jsx(ne,{skuId:c==null?void 0:c.id,version:A,mode:"dataset"}),g==="upload"&&e.jsx(de,{skuId:c==null?void 0:c.id,version:A,tags:c==null?void 0:c.tag_name}),g==="Label"&&e.jsx(me,{skuId:c==null?void 0:c.id,version:A,tags:c==null?void 0:c.tag_name}),g==="Annotate"&&e.jsx(ae,{skuId:c==null?void 0:c.id}),g==="Indus Vision AI"&&e.jsx(as,{skuId:c==null?void 0:c.id,version:A,skuVersions:x,selectedVersion:E})]})};export{xs as default};
